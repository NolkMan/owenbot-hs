<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language OverloadedStrings, DeriveGeneric #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">BinancePriceFetcher</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="BinancePriceFetcher.html#fetchADADetails"><span class="hs-identifier">fetchADADetails</span></a></span><span>
</span><span id="line-4"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="BinancePriceFetcher.html#fetchTicker"><span class="hs-identifier">fetchTicker</span></a></span><span>
</span><span id="line-5"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="BinancePriceFetcher.html#receivers"><span class="hs-identifier">receivers</span></a></span><span>
</span><span id="line-6"></span><span>                           </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.HTTP.Conduit</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">simpleHttp</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">pack</span></span><span>
</span><span id="line-13"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unpack</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Discord</span></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">DiscordHandler</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Discord.Types</span></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Message</span></span><span>
</span><span id="line-16"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">messageChannel</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">UnliftIO</span></span><span>               </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Command.html"><span class="hs-identifier">Command</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Owoifier.html"><span class="hs-identifier">Owoifier</span></a></span><span>               </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Owoifier.html#owoify"><span class="hs-identifier">owoify</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="annot"><a href="BinancePriceFetcher.html#receivers"><span class="hs-identifier hs-type">receivers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-23"></span><span id="receivers"><span class="annot"><span class="annottext">receivers :: [Message -&gt; DiscordHandler ()]
</span><a href="BinancePriceFetcher.html#receivers"><span class="hs-identifier hs-var hs-var">receivers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Command DiscordHandler -&gt; Message -&gt; DiscordHandler ())
-&gt; [Command DiscordHandler] -&gt; [Message -&gt; DiscordHandler ()]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Command DiscordHandler -&gt; Message -&gt; DiscordHandler ()
forall (m :: * -&gt; *).
MonadDiscord m =&gt;
Command m -&gt; Message -&gt; m ()
</span><a href="Command.Command.html#runCommand"><span class="hs-identifier hs-var">runCommand</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Command DiscordHandler
</span><a href="BinancePriceFetcher.html#handleTicker"><span class="hs-identifier hs-var">handleTicker</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Command DiscordHandler
</span><a href="BinancePriceFetcher.html#handleAda24h"><span class="hs-identifier hs-var">handleAda24h</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span id="local-6989586621679166717"><span id="local-6989586621679166718"></span></span><span class="hs-keyword">data</span><span> </span><span id="Ticker"><span class="annot"><a href="BinancePriceFetcher.html#Ticker"><span class="hs-identifier hs-var">Ticker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Ticker"><span class="annot"><a href="BinancePriceFetcher.html#Ticker"><span class="hs-identifier hs-var">Ticker</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-29"></span><span>    </span><span id="symbol"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#symbol"><span class="hs-identifier hs-var hs-var">symbol</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span id="priceChange"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#priceChange"><span class="hs-identifier hs-var hs-var">priceChange</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span id="priceChangePercent"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#priceChangePercent"><span class="hs-identifier hs-var hs-var">priceChangePercent</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span id="weightedAvgPrice"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#weightedAvgPrice"><span class="hs-identifier hs-var hs-var">weightedAvgPrice</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span id="prevClosePrice"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#prevClosePrice"><span class="hs-identifier hs-var hs-var">prevClosePrice</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span id="lastPrice"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#lastPrice"><span class="hs-identifier hs-var hs-var">lastPrice</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span id="lastQty"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#lastQty"><span class="hs-identifier hs-var hs-var">lastQty</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span id="bidPrice"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#bidPrice"><span class="hs-identifier hs-var hs-var">bidPrice</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span id="bidQty"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#bidQty"><span class="hs-identifier hs-var hs-var">bidQty</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span id="askPrice"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#askPrice"><span class="hs-identifier hs-var hs-var">askPrice</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span id="askQty"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#askQty"><span class="hs-identifier hs-var hs-var">askQty</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span id="openPrice"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#openPrice"><span class="hs-identifier hs-var hs-var">openPrice</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span id="highPrice"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#highPrice"><span class="hs-identifier hs-var hs-var">highPrice</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span id="lowPrice"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#lowPrice"><span class="hs-identifier hs-var hs-var">lowPrice</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span id="volume"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#volume"><span class="hs-identifier hs-var hs-var">volume</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span id="quoteVolume"><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#quoteVolume"><span class="hs-identifier hs-var hs-var">quoteVolume</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span id="openTime"><span class="annot"><span class="annottext">Ticker -&gt; Integer
</span><a href="BinancePriceFetcher.html#openTime"><span class="hs-identifier hs-var hs-var">openTime</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span id="closeTime"><span class="annot"><span class="annottext">Ticker -&gt; Integer
</span><a href="BinancePriceFetcher.html#closeTime"><span class="hs-identifier hs-var hs-var">closeTime</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span id="firstId"><span class="annot"><span class="annottext">Ticker -&gt; Integer
</span><a href="BinancePriceFetcher.html#firstId"><span class="hs-identifier hs-var hs-var">firstId</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span id="lastId"><span class="annot"><span class="annottext">Ticker -&gt; Integer
</span><a href="BinancePriceFetcher.html#lastId"><span class="hs-identifier hs-var hs-var">lastId</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span id="count"><span class="annot"><span class="annottext">Ticker -&gt; Integer
</span><a href="BinancePriceFetcher.html#count"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-50"></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679166689"><span id="local-6989586621679166691"><span id="local-6989586621679166693"><span class="annot"><span class="annottext">Int -&gt; Ticker -&gt; ShowS
[Ticker] -&gt; ShowS
Ticker -&gt; String
(Int -&gt; Ticker -&gt; ShowS)
-&gt; (Ticker -&gt; String) -&gt; ([Ticker] -&gt; ShowS) -&gt; Show Ticker
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Ticker] -&gt; ShowS
$cshowList :: [Ticker] -&gt; ShowS
show :: Ticker -&gt; String
$cshow :: Ticker -&gt; String
showsPrec :: Int -&gt; Ticker -&gt; ShowS
$cshowsPrec :: Int -&gt; Ticker -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. Ticker -&gt; Rep Ticker x)
-&gt; (forall x. Rep Ticker x -&gt; Ticker) -&gt; Generic Ticker
forall x. Rep Ticker x -&gt; Ticker
forall x. Ticker -&gt; Rep Ticker x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Ticker x -&gt; Ticker
$cfrom :: forall x. Ticker -&gt; Rep Ticker x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679166681"><span id="local-6989586621679166683"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="BinancePriceFetcher.html#Ticker"><span class="hs-identifier hs-type">Ticker</span></a></span></span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679166672"><span id="local-6989586621679166674"><span id="local-6989586621679166676"><span id="local-6989586621679166678"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="BinancePriceFetcher.html#Ticker"><span class="hs-identifier hs-type">Ticker</span></a></span></span></span></span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="annot"><a href="BinancePriceFetcher.html#adaEmoji"><span class="hs-identifier hs-type">adaEmoji</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-56"></span><span id="adaEmoji"><span class="annot"><span class="annottext">adaEmoji :: String
</span><a href="BinancePriceFetcher.html#adaEmoji"><span class="hs-identifier hs-var hs-var">adaEmoji</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;:ada:805934431071371305&gt;&quot;</span></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- TODO: allow server to choose emoji through :config</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><a href="BinancePriceFetcher.html#jsonURL"><span class="hs-identifier hs-type">jsonURL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-60"></span><span id="jsonURL"><span class="annot"><span class="annottext">jsonURL :: String -&gt; ShowS
</span><a href="BinancePriceFetcher.html#jsonURL"><span class="hs-identifier hs-var hs-var">jsonURL</span></a></span></span><span> </span><span id="local-6989586621679166668"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166668"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679166667"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166667"><span class="hs-identifier hs-var">quote</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://api.binance.com/api/v3/ticker/24hr?symbol=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166668"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166667"><span class="hs-identifier hs-var">quote</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-type">sign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-63"></span><span id="sign"><span class="annot"><span class="annottext">sign :: ShowS
</span><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BUSD&quot;</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span>
</span><span id="line-64"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TUSD&quot;</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span>
</span><span id="line-65"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;USDT&quot;</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span>
</span><span id="line-66"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AUD&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span>
</span><span id="line-67"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CAD&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$&quot;</span></span><span>
</span><span id="line-68"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EUR&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8364;&quot;</span></span><span>
</span><span id="line-69"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GBP&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#163;&quot;</span></span><span>
</span><span id="line-70"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;JPY&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#165;&quot;</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ADA&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8371;&quot;</span></span><span>
</span><span id="line-73"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BCH&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#579;&quot;</span></span><span>
</span><span id="line-74"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BSV&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#385;&quot;</span></span><span>
</span><span id="line-75"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BTC&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8383;&quot;</span></span><span>
</span><span id="line-76"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DAI&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#9672;&quot;</span></span><span>
</span><span id="line-77"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DOGE&quot;</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#208;&quot;</span></span><span>
</span><span id="line-78"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EOS&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#949;&quot;</span></span><span>
</span><span id="line-79"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ETC&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#958;&quot;</span></span><span>
</span><span id="line-80"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ETH&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#926;&quot;</span></span><span>
</span><span id="line-81"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LTC&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#321;&quot;</span></span><span>
</span><span id="line-82"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MKR&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#924;&quot;</span></span><span>
</span><span id="line-83"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;REP&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#588;&quot;</span></span><span>
</span><span id="line-84"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;STEEM&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#575;&quot;</span></span><span>
</span><span id="line-85"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;XMR&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#625;&quot;</span></span><span>
</span><span id="line-86"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;XRP&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#10005;&quot;</span></span><span>
</span><span id="line-87"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;XTZ&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#42793;&quot;</span></span><span>
</span><span id="line-88"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ZEC&quot;</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#9449;&quot;</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span id="local-6989586621679166665"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166665"><span class="hs-identifier hs-var">x</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166665"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><a href="BinancePriceFetcher.html#getJSON"><span class="hs-identifier hs-type">getJSON</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-93"></span><span id="getJSON"><span class="annot"><span class="annottext">getJSON :: String -&gt; String -&gt; IO ByteString
</span><a href="BinancePriceFetcher.html#getJSON"><span class="hs-identifier hs-var hs-var">getJSON</span></a></span></span><span> </span><span id="local-6989586621679166663"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166663"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679166662"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166662"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; m ByteString
</span><span class="hs-identifier hs-var">simpleHttp</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ByteString) -&gt; String -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><a href="BinancePriceFetcher.html#jsonURL"><span class="hs-identifier hs-var">jsonURL</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166663"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166662"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><a href="BinancePriceFetcher.html#fetchADADetails"><span class="hs-identifier hs-type">fetchADADetails</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span id="fetchADADetails"><span class="annot"><span class="annottext">fetchADADetails :: IO (Either String String)
</span><a href="BinancePriceFetcher.html#fetchADADetails"><span class="hs-identifier hs-var hs-var">fetchADADetails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679166661"><span class="annot"><span class="annottext">Either String String
</span><a href="#local-6989586621679166661"><span class="hs-identifier hs-var">ticker</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO (Either String String)
</span><a href="BinancePriceFetcher.html#fetchTicker"><span class="hs-identifier hs-var">fetchTicker</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ADA&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BUSD&quot;</span></span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">Either String String -&gt; IO (Either String String)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either String String -&gt; IO (Either String String))
-&gt; Either String String -&gt; IO (Either String String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String String
</span><a href="#local-6989586621679166661"><span class="hs-identifier hs-var">ticker</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679166660"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166660"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String String
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166660"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679166659"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166659"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String String
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String String) -&gt; String -&gt; Either String String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="BinancePriceFetcher.html#adaEmoji"><span class="hs-identifier hs-var">adaEmoji</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (philcoin) is &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166659"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="BinancePriceFetcher.html#fetchTicker"><span class="hs-identifier hs-type">fetchTicker</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span id="fetchTicker"><span class="annot"><span class="annottext">fetchTicker :: String -&gt; String -&gt; IO (Either String String)
</span><a href="BinancePriceFetcher.html#fetchTicker"><span class="hs-identifier hs-var hs-var">fetchTicker</span></a></span></span><span> </span><span id="local-6989586621679166658"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166658"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679166657"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166657"><span class="hs-identifier hs-var">quote</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679166656"><span class="annot"><span class="annottext">Either String Ticker
</span><a href="#local-6989586621679166656"><span class="hs-identifier hs-var">detailsM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either String Ticker
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">eitherDecode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String Ticker)
-&gt; IO ByteString -&gt; IO (Either String Ticker)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ByteString
</span><a href="BinancePriceFetcher.html#getJSON"><span class="hs-identifier hs-var">getJSON</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166658"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166657"><span class="hs-identifier hs-var">quote</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="BinancePriceFetcher.html#Ticker"><span class="hs-identifier hs-type">Ticker</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">Either String String -&gt; IO (Either String String)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either String String -&gt; IO (Either String String))
-&gt; Either String String -&gt; IO (Either String String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String Ticker
</span><a href="#local-6989586621679166656"><span class="hs-identifier hs-var">detailsM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679166653"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166653"><span class="hs-identifier hs-var">err</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String String
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166653"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679166652"><span class="annot"><span class="annottext">Ticker
</span><a href="#local-6989586621679166652"><span class="hs-identifier hs-var">details</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-108"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166651"><span class="annot"><span class="annottext">percentChangeD :: Double
</span><a href="#local-6989586621679166651"><span class="hs-identifier hs-var hs-var">percentChangeD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#priceChangePercent"><span class="hs-identifier hs-var hs-var">priceChangePercent</span></a></span><span> </span><span class="annot"><span class="annottext">Ticker
</span><a href="#local-6989586621679166652"><span class="hs-identifier hs-var">details</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-109"></span><span>                </span><span id="local-6989586621679166649"><span class="annot"><span class="annottext">curPriceD :: Double
</span><a href="#local-6989586621679166649"><span class="hs-identifier hs-var hs-var">curPriceD</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#lastPrice"><span class="hs-identifier hs-var hs-var">lastPrice</span></a></span><span>          </span><span class="annot"><span class="annottext">Ticker
</span><a href="#local-6989586621679166652"><span class="hs-identifier hs-var">details</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-110"></span><span>                </span><span id="local-6989586621679166648"><span class="annot"><span class="annottext">lowPriceD :: Double
</span><a href="#local-6989586621679166648"><span class="hs-identifier hs-var hs-var">lowPriceD</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#lowPrice"><span class="hs-identifier hs-var hs-var">lowPrice</span></a></span><span>           </span><span class="annot"><span class="annottext">Ticker
</span><a href="#local-6989586621679166652"><span class="hs-identifier hs-var">details</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-111"></span><span>                </span><span id="local-6989586621679166647"><span class="annot"><span class="annottext">highPriceD :: Double
</span><a href="#local-6989586621679166647"><span class="hs-identifier hs-var hs-var">highPriceD</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ticker -&gt; String
</span><a href="BinancePriceFetcher.html#highPrice"><span class="hs-identifier hs-var hs-var">highPrice</span></a></span><span>          </span><span class="annot"><span class="annottext">Ticker
</span><a href="#local-6989586621679166652"><span class="hs-identifier hs-var">details</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-112"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; Either String String
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String String) -&gt; String -&gt; Either String String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; String
</span><a href="BinancePriceFetcher.html#tickerAnnounce"><span class="hs-identifier hs-var">tickerAnnounce</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166658"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166657"><span class="hs-identifier hs-var">quote</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166651"><span class="hs-identifier hs-var">percentChangeD</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166649"><span class="hs-identifier hs-var">curPriceD</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166648"><span class="hs-identifier hs-var">lowPriceD</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166647"><span class="hs-identifier hs-var">highPriceD</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><a href="BinancePriceFetcher.html#tickerAnnounce"><span class="hs-identifier hs-type">tickerAnnounce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-115"></span><span id="tickerAnnounce"><span class="annot"><span class="annottext">tickerAnnounce :: String -&gt; String -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; String
</span><a href="BinancePriceFetcher.html#tickerAnnounce"><span class="hs-identifier hs-var hs-var">tickerAnnounce</span></a></span></span><span> </span><span id="local-6989586621679166645"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166645"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679166644"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166644"><span class="hs-identifier hs-var">quote</span></a></span></span><span> </span><span id="local-6989586621679166643"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166643"><span class="hs-identifier hs-var">percentChange</span></a></span></span><span> </span><span id="local-6989586621679166642"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166642"><span class="hs-identifier hs-var">curPrice</span></a></span></span><span> </span><span id="local-6989586621679166641"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166641"><span class="hs-identifier hs-var">lowPrice</span></a></span></span><span> </span><span id="local-6989586621679166640"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166640"><span class="hs-identifier hs-var">highPrice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-116"></span><span>      </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;**&quot;</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166643"><span class="hs-identifier hs-var">percentChange</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;down &#128162;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;up &#128640;&#128640;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;** &quot;</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;**&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166643"><span class="hs-identifier hs-var">percentChange</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%** in the past 24 hours, &quot;</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;currently sitting at **&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166645"><span class="hs-identifier hs-var">base</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;1** = **&quot;</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166644"><span class="hs-identifier hs-var">quote</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166642"><span class="hs-identifier hs-var">curPrice</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;** per unit.\n&quot;</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Lowest price in the past 24h: **&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166644"><span class="hs-identifier hs-var">quote</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166641"><span class="hs-identifier hs-var">lowPrice</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;**.\n&quot;</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Highest price in the past 24h: **&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="BinancePriceFetcher.html#sign"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166644"><span class="hs-identifier hs-var">quote</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679166640"><span class="hs-identifier hs-var">highPrice</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;**.&quot;</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="BinancePriceFetcher.html#handleTicker"><span class="hs-identifier hs-type">handleTicker</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Command.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span>
</span><span id="line-128"></span><span id="handleTicker"><span class="annot"><span class="annottext">handleTicker :: Command DiscordHandler
</span><a href="BinancePriceFetcher.html#handleTicker"><span class="hs-identifier hs-var hs-var">handleTicker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; (Message -&gt; String -&gt; String -&gt; DiscordHandler ())
-&gt; Command DiscordHandler
forall (m :: * -&gt; *) h.
(CommandHandlerType m h, MonadDiscord m) =&gt;
Text -&gt; h -&gt; Command m
</span><a href="Command.Command.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;binance&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Message -&gt; String -&gt; String -&gt; DiscordHandler ())
 -&gt; Command DiscordHandler)
-&gt; (Message -&gt; String -&gt; String -&gt; DiscordHandler ())
-&gt; Command DiscordHandler
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679166634"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166634"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679166633"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166633"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679166632"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166632"><span class="hs-identifier hs-var">quote</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679166631"><span class="annot"><span class="annottext">Either String String
</span><a href="#local-6989586621679166631"><span class="hs-identifier hs-var">announcementM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either String String)
-&gt; ReaderT DiscordHandle IO (Either String String)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either String String)
 -&gt; ReaderT DiscordHandle IO (Either String String))
-&gt; IO (Either String String)
-&gt; ReaderT DiscordHandle IO (Either String String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO (Either String String)
</span><a href="BinancePriceFetcher.html#fetchTicker"><span class="hs-identifier hs-var">fetchTicker</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166633"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166632"><span class="hs-identifier hs-var">quote</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String String
</span><a href="#local-6989586621679166631"><span class="hs-identifier hs-var">announcementM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679166630"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166630"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; DiscordHandler ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; DiscordHandler ()) -&gt; IO () -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[DEBUG] Cannot get ticker from Binance: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166630"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-133"></span><span>            </span><span class="annot"><span class="annottext">Message -&gt; Text -&gt; DiscordHandler ()
forall (m :: * -&gt; *). MonadDiscord m =&gt; Message -&gt; Text -&gt; m ()
</span><a href="Discord.Internal.Monad.html#respond"><span class="hs-identifier hs-var">respond</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166634"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler ()) -&gt; Text -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Owoifier.html#owoify"><span class="hs-identifier hs-var">owoify</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Couldn't get the data! Sorry!&quot;</span></span><span>
</span><span id="line-134"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679166627"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166627"><span class="hs-identifier hs-var">announcement</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>            </span><span class="annot"><span class="annottext">Message -&gt; Text -&gt; DiscordHandler ()
forall (m :: * -&gt; *). MonadDiscord m =&gt; Message -&gt; Text -&gt; m ()
</span><a href="Discord.Internal.Monad.html#respond"><span class="hs-identifier hs-var">respond</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166634"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler ()) -&gt; Text -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Owoifier.html#owoify"><span class="hs-identifier hs-var">owoify</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (String -&gt; Text) -&gt; String -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166633"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166632"><span class="hs-identifier hs-var">quote</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is &quot;</span></span><span>
</span><span id="line-136"></span><span>                                 </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166627"><span class="hs-identifier hs-var">announcement</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="BinancePriceFetcher.html#handleAda24h"><span class="hs-identifier hs-type">handleAda24h</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Command.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span>
</span><span id="line-139"></span><span id="handleAda24h"><span class="annot"><span class="annottext">handleAda24h :: Command DiscordHandler
</span><a href="BinancePriceFetcher.html#handleAda24h"><span class="hs-identifier hs-var hs-var">handleAda24h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Command DiscordHandler -&gt; Command DiscordHandler
forall (m :: * -&gt; *). Text -&gt; Command m -&gt; Command m
</span><a href="Command.Command.html#alias"><span class="hs-identifier hs-var">alias</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ada24h&quot;</span></span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">(Command DiscordHandler -&gt; Command DiscordHandler)
-&gt; ((Message -&gt; DiscordHandler ()) -&gt; Command DiscordHandler)
-&gt; (Message -&gt; DiscordHandler ())
-&gt; Command DiscordHandler
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Message -&gt; DiscordHandler ()) -&gt; Command DiscordHandler
forall (m :: * -&gt; *) h.
(CommandHandlerType m h, MonadDiscord m) =&gt;
Text -&gt; h -&gt; Command m
</span><a href="Command.Command.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ada&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Message -&gt; DiscordHandler ()) -&gt; Command DiscordHandler)
-&gt; (Message -&gt; DiscordHandler ()) -&gt; Command DiscordHandler
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679166624"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166624"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-comment">-- owo no indent here needed??? owo???</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679166623"><span class="annot"><span class="annottext">Either String String
</span><a href="#local-6989586621679166623"><span class="hs-identifier hs-var">adaAnnouncementM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either String String)
-&gt; ReaderT DiscordHandle IO (Either String String)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO (Either String String)
</span><a href="BinancePriceFetcher.html#fetchADADetails"><span class="hs-identifier hs-var">fetchADADetails</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either String String
</span><a href="#local-6989586621679166623"><span class="hs-identifier hs-var">adaAnnouncementM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679166622"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166622"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; DiscordHandler ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; DiscordHandler ()) -&gt; IO () -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[DEBUG] Cannot fetch ADA details from Binance: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166622"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-147"></span><span>            </span><span class="annot"><span class="annottext">Message -&gt; Text -&gt; DiscordHandler ()
forall (m :: * -&gt; *). MonadDiscord m =&gt; Message -&gt; Text -&gt; m ()
</span><a href="Discord.Internal.Monad.html#respond"><span class="hs-identifier hs-var">respond</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166624"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler ()) -&gt; Text -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Owoifier.html#owoify"><span class="hs-identifier hs-var">owoify</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Couldn't get the data! Sorry!&quot;</span></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679166621"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166621"><span class="hs-identifier hs-var">announcement</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>            </span><span class="annot"><span class="annottext">Message -&gt; Text -&gt; DiscordHandler ()
forall (m :: * -&gt; *). MonadDiscord m =&gt; Message -&gt; Text -&gt; m ()
</span><a href="Discord.Internal.Monad.html#respond"><span class="hs-identifier hs-var">respond</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166624"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler ()) -&gt; Text -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Owoifier.html#owoify"><span class="hs-identifier hs-var">owoify</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679166621"><span class="hs-identifier hs-var">announcement</span></a></span><span>
</span><span id="line-150"></span></pre></body></html>