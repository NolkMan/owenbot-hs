<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">{-|
    Module:     : Utils
    Description : A module containing all sorts of useful macros and functions. The Appendix of owenbot.
-}</span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Utils</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Utils.html#emojiToUsableText"><span class="hs-identifier">emojiToUsableText</span></a></span><span>
</span><span id="line-8"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendMessageChan"><span class="hs-identifier">sendMessageChan</span></a></span><span>
</span><span id="line-9"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendReply"><span class="hs-identifier">sendReply</span></a></span><span>
</span><span id="line-10"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendMessageChanEmbed"><span class="hs-identifier">sendMessageChanEmbed</span></a></span><span>
</span><span id="line-11"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendMessageChanPingsDisabled"><span class="hs-identifier">sendMessageChanPingsDisabled</span></a></span><span>
</span><span id="line-12"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendMessageDM"><span class="hs-identifier">sendMessageDM</span></a></span><span>
</span><span id="line-13"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendFileChan"><span class="hs-identifier">sendFileChan</span></a></span><span>
</span><span id="line-14"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#sendAssetChan"><span class="hs-identifier">sendAssetChan</span></a></span><span>
</span><span id="line-15"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#addReaction"><span class="hs-identifier">addReaction</span></a></span><span>
</span><span id="line-16"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#messageFromReaction"><span class="hs-identifier">messageFromReaction</span></a></span><span>
</span><span id="line-17"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#pingUser"><span class="hs-identifier">pingUser</span></a></span><span>
</span><span id="line-18"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#pingRole"><span class="hs-identifier">pingRole</span></a></span><span>
</span><span id="line-19"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#pingAuthorOf"><span class="hs-identifier">pingAuthorOf</span></a></span><span>
</span><span id="line-20"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#pingWithUsername"><span class="hs-identifier">pingWithUsername</span></a></span><span>
</span><span id="line-21"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#stripAllPings"><span class="hs-identifier">stripAllPings</span></a></span><span>
</span><span id="line-22"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#newCommand"><span class="hs-identifier">newCommand</span></a></span><span>
</span><span id="line-23"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#newDevCommand"><span class="hs-identifier">newDevCommand</span></a></span><span>
</span><span id="line-24"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#newModCommand"><span class="hs-identifier">newModCommand</span></a></span><span>
</span><span id="line-25"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#linkChannel"><span class="hs-identifier">linkChannel</span></a></span><span>
</span><span id="line-26"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#getMessageLink"><span class="hs-identifier">getMessageLink</span></a></span><span>
</span><span id="line-27"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#hasRoleByName"><span class="hs-identifier">hasRoleByName</span></a></span><span>
</span><span id="line-28"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#hasRoleByID"><span class="hs-identifier">hasRoleByID</span></a></span><span>
</span><span id="line-29"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#channelRequirement"><span class="hs-identifier">channelRequirement</span></a></span><span>
</span><span id="line-30"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#roleNameRequirement"><span class="hs-identifier">roleNameRequirement</span></a></span><span>
</span><span id="line-31"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#developerRequirement"><span class="hs-identifier">developerRequirement</span></a></span><span>
</span><span id="line-32"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#isMod"><span class="hs-identifier">isMod</span></a></span><span>
</span><span id="line-33"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#devIDs"><span class="hs-identifier">devIDs</span></a></span><span>
</span><span id="line-34"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#assetDir"><span class="hs-identifier">assetDir</span></a></span><span>
</span><span id="line-35"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#%3D~%3D"><span class="hs-operator">(=~=)</span></a></span><span>
</span><span id="line-36"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#getTimestampFromMessage"><span class="hs-identifier">getTimestampFromMessage</span></a></span><span>
</span><span id="line-37"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#captureCommandOutput"><span class="hs-identifier">captureCommandOutput</span></a></span><span>
</span><span id="line-38"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#update"><span class="hs-identifier">update</span></a></span><span>
</span><span id="line-39"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#snowflakeToInt"><span class="hs-identifier">snowflakeToInt</span></a></span><span>
</span><span id="line-40"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#moveChannel"><span class="hs-identifier">moveChannel</span></a></span><span>
</span><span id="line-41"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#isEmojiValid"><span class="hs-identifier">isEmojiValid</span></a></span><span>
</span><span id="line-42"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Utils.html#isRoleInGuild"><span class="hs-identifier">isRoleInGuild</span></a></span><span>
</span><span id="line-43"></span><span>             </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Discord.Requests</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Discord.Types</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Discord</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span>
</span><span id="line-49"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">IOException</span></span><span>
</span><span id="line-50"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span>
</span><span id="line-52"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">join</span></span><span>
</span><span id="line-53"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span>
</span><span id="line-54"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">on</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.Split</span></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">splitOn</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Format</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TF</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">getXdgDirectory</span></span><span>
</span><span id="line-62"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">XdgDirectory</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">XdgData</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExitCode</span></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExitSuccess</span></span><span>
</span><span id="line-65"></span><span>                                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ExitFailure</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Process</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">UnliftIO</span></span><span>               </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Regex.TDFA</span></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(=~)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Owoifier.html"><span class="hs-identifier">Owoifier</span></a></span><span>               </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Owoifier.html#owoify"><span class="hs-identifier">owoify</span></a></span><span>
</span><span id="line-73"></span><span>                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Owoifier.html#weakOwoify"><span class="hs-identifier">weakOwoify</span></a></span><span>
</span><span id="line-74"></span><span>                                        </span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="TemplateRE.html"><span class="hs-identifier">TemplateRE</span></a></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="TemplateRE.html#trailingWS"><span class="hs-identifier">trailingWS</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="CSV.html"><span class="hs-identifier">CSV</span></a></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="CSV.html#readSingleColCSV"><span class="hs-identifier">readSingleColCSV</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">isDigit</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Command.html"><span class="hs-identifier">Command</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | The `FilePath` to the configuration file listing OwenDev role IDs.</span><span>
</span><span id="line-84"></span><span class="annot"><a href="Utils.html#devIDs"><span class="hs-identifier hs-type">devIDs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-85"></span><span id="devIDs"><span class="annot"><span class="annottext">devIDs :: FilePath
</span><a href="Utils.html#devIDs"><span class="hs-identifier hs-var hs-var">devIDs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;devs.csv&quot;</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | The `FilePath` representing the repo for the bot.</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- TODO: chuck in a config file, handle not having a repo</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Utils.html#repoDir"><span class="hs-identifier hs-type">repoDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-90"></span><span id="repoDir"><span class="annot"><span class="annottext">repoDir :: FilePath
</span><a href="Utils.html#repoDir"><span class="hs-identifier hs-var hs-var">repoDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;~/owenbot-hs/&quot;</span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | The `FilePath` representing the location of the assets.</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- TODO: Move into a saner place than Utils</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Utils.html#assetDir"><span class="hs-identifier hs-type">assetDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-95"></span><span id="assetDir"><span class="annot"><span class="annottext">assetDir :: IO FilePath
</span><a href="Utils.html#assetDir"><span class="hs-identifier hs-var hs-var">assetDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; IO FilePath
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO FilePath -&gt; IO FilePath) -&gt; IO FilePath -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XdgDirectory -&gt; FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">getXdgDirectory</span></span><span> </span><span class="annot"><span class="annottext">XdgDirectory
</span><span class="hs-identifier hs-var">XdgData</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;owen/assets/&quot;</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | The `(=~=)` function matches a given `Text` again a regex. Case-less in terms of owoifying.</span><span>
</span><span id="line-98"></span><span class="annot"><a href="Utils.html#%3D~%3D"><span class="hs-operator hs-type">(=~=)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-99"></span><span id="%3D~%3D"><span class="annot"><span class="annottext">=~= :: Text -&gt; Text -&gt; Bool
</span><a href="Utils.html#%3D~%3D"><span class="hs-operator hs-var hs-var">(=~=)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall source source1 target.
(RegexMaker Regex CompOption ExecOption source,
 RegexContext Regex source1 target) =&gt;
source1 -&gt; source -&gt; target
</span><span class="hs-operator hs-var">(=~)</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; Bool) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Owoifier.html#weakOwoify"><span class="hs-identifier hs-var">weakOwoify</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | `pingUser` constructs a minimal `Text` pinging the given user.</span><span>
</span><span id="line-102"></span><span class="annot"><a href="Utils.html#pingUser"><span class="hs-identifier hs-type">pingUser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">User</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-103"></span><span id="pingUser"><span class="annot"><span class="annottext">pingUser :: User -&gt; Text
</span><a href="Utils.html#pingUser"><span class="hs-identifier hs-var hs-var">pingUser</span></a></span></span><span> </span><span id="local-6989586621679167156"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679167156"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; FilePath) -&gt; UserId -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">User -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">userId</span></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679167156"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | `pingRole` constructs a minimal `Text` pinging the given role id.</span><span>
</span><span id="line-106"></span><span class="annot"><a href="Utils.html#pingRole"><span class="hs-identifier hs-type">pingRole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RoleId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-107"></span><span id="pingRole"><span class="annot"><span class="annottext">pingRole :: UserId -&gt; Text
</span><a href="Utils.html#pingRole"><span class="hs-identifier hs-var hs-var">pingRole</span></a></span></span><span> </span><span id="local-6989586621679167151"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167151"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;@&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167151"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | `pingAuthorOf` constructs a minimal `Text` pinging the author of a given message.</span><span>
</span><span id="line-110"></span><span class="annot"><a href="Utils.html#pingAuthorOf"><span class="hs-identifier hs-type">pingAuthorOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-111"></span><span id="pingAuthorOf"><span class="annot"><span class="annottext">pingAuthorOf :: Message -&gt; Text
</span><a href="Utils.html#pingAuthorOf"><span class="hs-identifier hs-var hs-var">pingAuthorOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">User -&gt; Text
</span><a href="Utils.html#pingUser"><span class="hs-identifier hs-var">pingUser</span></a></span><span> </span><span class="annot"><span class="annottext">(User -&gt; Text) -&gt; (Message -&gt; User) -&gt; Message -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; User
</span><span class="hs-identifier hs-var hs-var">messageAuthor</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | `pingWithUsername` constructs a minimal `Text` pinging the the user with the given</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- username from the given guild. On failure, returns an empty Text. On multiple such</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- users, returns an empty Text.</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Utils.html#pingWithUsername"><span class="hs-identifier hs-type">pingWithUsername</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-117"></span><span id="pingWithUsername"><span class="annot"><span class="annottext">pingWithUsername :: Text -&gt; UserId -&gt; DiscordHandler Text
</span><a href="Utils.html#pingWithUsername"><span class="hs-identifier hs-var hs-var">pingWithUsername</span></a></span></span><span> </span><span id="local-6989586621679167147"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167147"><span class="hs-identifier hs-var">uname</span></a></span></span><span> </span><span id="local-6989586621679167146"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167146"><span class="hs-identifier hs-var">gid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167145"><span class="annot"><span class="annottext">timing :: GuildMembersTiming
</span><a href="#local-6989586621679167145"><span class="hs-identifier hs-var hs-var">timing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Maybe UserId -&gt; GuildMembersTiming
</span><span class="hs-identifier hs-var">R.GuildMembersTiming</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe UserId
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- number of users to fetch, maximum is 1000</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-comment">-- &quot;Nothing&quot; seems to default to (Just 1)</span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679167143"><span class="annot"><span class="annottext">Either RestCallErrorCode [GuildMember]
</span><a href="#local-6989586621679167143"><span class="hs-identifier hs-var">membersM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GuildRequest [GuildMember]
-&gt; DiscordHandler (Either RestCallErrorCode [GuildMember])
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(GuildRequest [GuildMember]
 -&gt; DiscordHandler (Either RestCallErrorCode [GuildMember]))
-&gt; GuildRequest [GuildMember]
-&gt; DiscordHandler (Either RestCallErrorCode [GuildMember])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; GuildMembersTiming -&gt; GuildRequest [GuildMember]
</span><span class="hs-identifier hs-var">R.ListGuildMembers</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167146"><span class="hs-identifier hs-var">gid</span></a></span><span> </span><span class="annot"><span class="annottext">GuildMembersTiming
</span><a href="#local-6989586621679167145"><span class="hs-identifier hs-var">timing</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167140"><span class="annot"><span class="annottext">members :: [GuildMember]
</span><a href="#local-6989586621679167140"><span class="hs-identifier hs-var hs-var">members</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either RestCallErrorCode [GuildMember]
</span><a href="#local-6989586621679167143"><span class="hs-identifier hs-var">membersM</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-123"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679167139"><span class="annot"><span class="annottext">[GuildMember]
</span><a href="#local-6989586621679167139"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GuildMember]
</span><a href="#local-6989586621679167139"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-124"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span class="annot"><span class="annottext">RestCallErrorCode
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167138"><span class="annot"><span class="annottext">users :: [User]
</span><a href="#local-6989586621679167138"><span class="hs-identifier hs-var hs-var">users</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GuildMember -&gt; User
</span><span class="hs-identifier hs-var hs-var">memberUser</span></span><span> </span><span class="annot"><span class="annottext">(GuildMember -&gt; User) -&gt; [GuildMember] -&gt; [User]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[GuildMember]
</span><a href="#local-6989586621679167140"><span class="hs-identifier hs-var">members</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">--_ &lt;- liftIO $ print (userName &lt;$&gt; users)</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167135"><span class="annot"><span class="annottext">usersWithUsername :: [User]
</span><a href="#local-6989586621679167135"><span class="hs-identifier hs-var hs-var">usersWithUsername</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(User -&gt; Bool) -&gt; [User] -&gt; [User]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679167134"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679167134"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">User -&gt; Text
</span><span class="hs-identifier hs-var hs-var">userName</span></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679167134"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167147"><span class="hs-identifier hs-var">uname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679167138"><span class="hs-identifier hs-var">users</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-comment">--_ &lt;- liftIO $ print usersWithUsername</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; DiscordHandler Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler Text) -&gt; Text -&gt; DiscordHandler Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[User]
</span><a href="#local-6989586621679167135"><span class="hs-identifier hs-var">usersWithUsername</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679167132"><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679167132"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">User -&gt; Text
</span><a href="Utils.html#pingUser"><span class="hs-identifier hs-var">pingUser</span></a></span><span> </span><span class="annot"><span class="annottext">User
</span><a href="#local-6989586621679167132"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">[User]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | `isUnicodeEmoji` determines whether a provided character is a unicode emoji.</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- Really weak check.</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Utils.html#isUnicodeEmoji"><span class="hs-identifier hs-type">isUnicodeEmoji</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-137"></span><span id="isUnicodeEmoji"><span class="annot"><span class="annottext">isUnicodeEmoji :: Text -&gt; Bool
</span><a href="Utils.html#isUnicodeEmoji"><span class="hs-identifier hs-var hs-var">isUnicodeEmoji</span></a></span></span><span> </span><span id="local-6989586621679167130"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167130"><span class="hs-identifier hs-var">emojiT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679167128"><span class="hs-identifier hs-var">isInEmojiBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167130"><span class="hs-identifier hs-var">emojiT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>        </span><span id="local-6989586621679167128"><span class="annot"><span class="annottext">isInEmojiBlock :: Char -&gt; Bool
</span><a href="#local-6989586621679167128"><span class="hs-identifier hs-var hs-var">isInEmojiBlock</span></a></span></span><span> </span><span id="local-6989586621679167125"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679167125"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679167125"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\x00A9'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679167125"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\x1FADF'</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | `isRoleInGuild` determines whether a role containing the given text exists</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- in the guild (case insensitive). If it does, then it returns the role's ID.</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- Otherwise, `Nothing` is returned.</span><span>
</span><span id="line-144"></span><span id="local-6989586621679167122"><span class="annot"><a href="Utils.html#isRoleInGuild"><span class="hs-identifier hs-type">isRoleInGuild</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167122"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167122"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RoleId</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-145"></span><span id="isRoleInGuild"><span class="annot"><span class="annottext">isRoleInGuild :: Text -&gt; UserId -&gt; m (Maybe UserId)
</span><a href="Utils.html#isRoleInGuild"><span class="hs-identifier hs-var hs-var">isRoleInGuild</span></a></span></span><span> </span><span id="local-6989586621679167121"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167121"><span class="hs-identifier hs-var">roleFragment</span></a></span></span><span> </span><span id="local-6989586621679167120"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167120"><span class="hs-identifier hs-var">gid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679167119"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679167119"><span class="hs-identifier hs-var">roles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; m [Role]
forall (m :: * -&gt; *). MonadDiscord m =&gt; UserId -&gt; m [Role]
</span><a href="Discord.Internal.Monad.html#getGuildRoles"><span class="hs-identifier hs-var">getGuildRoles</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167120"><span class="hs-identifier hs-var">gid</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167117"><span class="annot"><span class="annottext">matchingRoles :: [Role]
</span><a href="#local-6989586621679167117"><span class="hs-identifier hs-var hs-var">matchingRoles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Role -&gt; Bool) -&gt; [Role] -&gt; [Role]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679167116"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679167116"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toUpper</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167121"><span class="hs-identifier hs-var">roleFragment</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><span class="hs-operator hs-var">`T.isInfixOf`</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toUpper</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Role -&gt; Text
</span><span class="hs-identifier hs-var hs-var">roleName</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679167116"><span class="hs-keyword hs-var">role</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679167119"><span class="hs-identifier hs-var">roles</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="annottext">Maybe UserId -&gt; m (Maybe UserId)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe UserId -&gt; m (Maybe UserId))
-&gt; Maybe UserId -&gt; m (Maybe UserId)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679167117"><span class="hs-identifier hs-var">matchingRoles</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe UserId
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-150"></span><span>        </span><span id="local-6989586621679167112"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679167112"><span class="hs-keyword hs-var">role</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679167111"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679167111"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Maybe UserId
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Maybe UserId) -&gt; UserId -&gt; Maybe UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Role -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">roleId</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679167112"><span class="hs-keyword hs-var">role</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | `discordEmojiTextToId` takes a Text ending in a Discord &lt;::0-9&gt; formatted emoji string</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- and extracts the ID. On unsuccessful extraction, returns 0. Given Text can be trailed by</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- spaces.</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Utils.html#discordEmojiTextToId"><span class="hs-identifier hs-type">discordEmojiTextToId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EmojiId</span></span><span>
</span><span id="line-156"></span><span id="discordEmojiTextToId"><span class="annot"><span class="annottext">discordEmojiTextToId :: Text -&gt; UserId
</span><a href="Utils.html#discordEmojiTextToId"><span class="hs-identifier hs-var hs-var">discordEmojiTextToId</span></a></span></span><span> </span><span id="local-6989586621679167107"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167107"><span class="hs-identifier hs-var">emojiT</span></a></span></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FilePath) -&gt; (Text -&gt; Text) -&gt; Text -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.reverse</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.takeWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-158"></span><span>                    </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FilePath) -&gt; Text -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.reverse</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167107"><span class="hs-identifier hs-var">emojiT</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-159"></span><span>            </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UserId
</span><span class="hs-number">0</span></span><span>
</span><span id="line-160"></span><span>            </span><span id="local-6989586621679167102"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167102"><span class="hs-identifier hs-var">num</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; UserId
forall a. Read a =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167102"><span class="hs-identifier hs-var">num</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | `isEmojiValid` determines whether an emoji (provided in Discord &lt;::0-9&gt; format) exists in the</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- guild (or is a default emoji). Case insensitive.</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Utils.html#isEmojiValid"><span class="hs-identifier hs-type">isEmojiValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-165"></span><span id="isEmojiValid"><span class="annot"><span class="annottext">isEmojiValid :: Text -&gt; UserId -&gt; DiscordHandler Bool
</span><a href="Utils.html#isEmojiValid"><span class="hs-identifier hs-var hs-var">isEmojiValid</span></a></span></span><span> </span><span id="local-6989586621679167100"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167100"><span class="hs-identifier hs-var">emojiT</span></a></span></span><span> </span><span id="local-6989586621679167099"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167099"><span class="hs-identifier hs-var">gid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679167098"><span class="annot"><span class="annottext">Guild
</span><a href="#local-6989586621679167098"><span class="hs-identifier hs-var">guild</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GuildRequest Guild
-&gt; DiscordHandler (Either RestCallErrorCode Guild)
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(GuildRequest Guild
 -&gt; DiscordHandler (Either RestCallErrorCode Guild))
-&gt; GuildRequest Guild
-&gt; DiscordHandler (Either RestCallErrorCode Guild)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; GuildRequest Guild
</span><span class="hs-identifier hs-var">R.GetGuild</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167099"><span class="hs-identifier hs-var">gid</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167096"><span class="annot"><span class="annottext">emojis :: [Emoji]
</span><a href="#local-6989586621679167096"><span class="hs-identifier hs-var hs-var">emojis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Guild -&gt; [Emoji]
</span><span class="hs-identifier hs-var hs-var">guildEmojis</span></span><span> </span><span class="annot"><span class="annottext">Guild
</span><a href="#local-6989586621679167098"><span class="hs-identifier hs-var">guild</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167094"><span class="annot"><span class="annottext">emojiID :: UserId
</span><a href="#local-6989586621679167094"><span class="hs-identifier hs-var hs-var">emojiID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; UserId
</span><a href="Utils.html#discordEmojiTextToId"><span class="hs-identifier hs-var">discordEmojiTextToId</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167100"><span class="hs-identifier hs-var">emojiT</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167093"><span class="annot"><span class="annottext">matchingEmojis :: [Emoji]
</span><a href="#local-6989586621679167093"><span class="hs-identifier hs-var hs-var">matchingEmojis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Emoji -&gt; Bool) -&gt; [Emoji] -&gt; [Emoji]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167094"><span class="hs-identifier hs-var">emojiID</span></a></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Bool) -&gt; (Emoji -&gt; UserId) -&gt; Emoji -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe UserId -&gt; UserId
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe UserId -&gt; UserId)
-&gt; (Emoji -&gt; Maybe UserId) -&gt; Emoji -&gt; UserId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Emoji -&gt; Maybe UserId
</span><span class="hs-identifier hs-var hs-var">emojiId</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Emoji]
</span><a href="#local-6989586621679167096"><span class="hs-identifier hs-var">emojis</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- _ &lt;- liftIO $ print matchingEmojis</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- _ &lt;- liftIO $ print emojiTID</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167091"><span class="annot"><span class="annottext">isInvalid :: Bool
</span><a href="#local-6989586621679167091"><span class="hs-identifier hs-var hs-var">isInvalid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167100"><span class="hs-identifier hs-var">emojiT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Emoji]
</span><a href="#local-6989586621679167093"><span class="hs-identifier hs-var">matchingEmojis</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-173"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Emoji]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-174"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><a href="Utils.html#isUnicodeEmoji"><span class="hs-identifier hs-var">isUnicodeEmoji</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167100"><span class="hs-identifier hs-var">emojiT</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="annot"><span class="annottext">(Text, [Emoji])
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; DiscordHandler Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; DiscordHandler Bool)
-&gt; (Bool -&gt; Bool) -&gt; Bool -&gt; DiscordHandler Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; DiscordHandler Bool) -&gt; Bool -&gt; DiscordHandler Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679167091"><span class="hs-identifier hs-var">isInvalid</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | `converge` applies a function to a variable until the result converges.</span><span>
</span><span id="line-179"></span><span id="local-6989586621679167282"><span class="annot"><a href="Utils.html#converge"><span class="hs-identifier hs-type">converge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679167282"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679167282"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167282"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167282"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167282"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-180"></span><span id="converge"><span class="annot"><span class="annottext">converge :: (a -&gt; a) -&gt; a -&gt; a
</span><a href="Utils.html#converge"><span class="hs-identifier hs-var hs-var">converge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (a -&gt; a -&gt; Bool) -&gt; a -&gt; Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a -&gt; a) -&gt; a -&gt; Bool)
-&gt; ((a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">until</span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | `stripAllPings` removes all pings from a given `Text` message.</span><span>
</span><span id="line-183"></span><span class="annot"><a href="Utils.html#stripAllPings"><span class="hs-identifier hs-type">stripAllPings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-184"></span><span id="stripAllPings"><span class="annot"><span class="annottext">stripAllPings :: Text -&gt; Text
</span><a href="Utils.html#stripAllPings"><span class="hs-identifier hs-var hs-var">stripAllPings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; (Text -&gt; FilePath) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a. Eq a =&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Utils.html#converge"><span class="hs-identifier hs-var">converge</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679167087"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; (Text -&gt; FilePath) -&gt; Text -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="#local-6989586621679167086"><span class="hs-identifier hs-type">pingRE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679167086"><span class="annot"><span class="annottext">pingRE :: FilePath
</span><a href="#local-6989586621679167086"><span class="hs-identifier hs-var hs-var">pingRE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;^@[&amp;!]?[0-9]{8,}&gt;&quot;</span></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><a href="#local-6989586621679167087"><span class="hs-identifier hs-type">stripOnePing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-189"></span><span>        </span><span id="local-6989586621679167087"><span class="annot"><span class="annottext">stripOnePing :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679167087"><span class="hs-identifier hs-var hs-var">stripOnePing</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><a href="#local-6989586621679167087"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679167084"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679167084"><span class="hs-identifier hs-var">ch</span></a></span></span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679167084"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><a href="#local-6989586621679167087"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679167083"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167083"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167083"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall source source1 target.
(RegexMaker Regex CompOption ExecOption source,
 RegexContext Regex source1 target) =&gt;
source1 -&gt; source -&gt; target
</span><span class="hs-operator hs-var">=~</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167086"><span class="hs-identifier hs-var">pingRE</span></a></span><span>
</span><span id="line-192"></span><span>                                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath -&gt; FilePath
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167083"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-193"></span><span>                                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167083"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><a href="#local-6989586621679167087"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679167080"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679167080"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679167079"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167079"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679167080"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679167087"><span class="hs-identifier hs-var">stripOnePing</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167079"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | `linkChannel` constructs a minimal `Text` linking the channel with the provided ID.</span><span>
</span><span id="line-197"></span><span class="annot"><a href="Utils.html#linkChannel"><span class="hs-identifier hs-type">linkChannel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-198"></span><span id="linkChannel"><span class="annot"><span class="annottext">linkChannel :: UserId -&gt; Text
</span><a href="Utils.html#linkChannel"><span class="hs-identifier hs-var hs-var">linkChannel</span></a></span></span><span> </span><span id="local-6989586621679167077"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167077"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;#&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167077"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | `getMessageLink` attempts to construct the Discord URL of the given message, as a `Text`.</span><span>
</span><span id="line-201"></span><span class="annot"><a href="Utils.html#getMessageLink"><span class="hs-identifier hs-type">getMessageLink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-202"></span><span id="getMessageLink"><span class="annot"><span class="annottext">getMessageLink :: Message -&gt; DiscordHandler Text
</span><a href="Utils.html#getMessageLink"><span class="hs-identifier hs-var hs-var">getMessageLink</span></a></span></span><span> </span><span id="local-6989586621679167076"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167076"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679167075"><span class="annot"><span class="annottext">Channel
</span><a href="#local-6989586621679167075"><span class="hs-identifier hs-var">chan</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; ReaderT DiscordHandle IO Channel
forall (m :: * -&gt; *). MonadDiscord m =&gt; UserId -&gt; m Channel
</span><a href="Discord.Internal.Monad.html#getChannel"><span class="hs-identifier hs-var">getChannel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageChannel</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167076"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-comment">-- the ID of the server containing the channel, as a `Text`</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167072"><span class="annot"><span class="annottext">serverIDT :: Text
</span><a href="#local-6989586621679167072"><span class="hs-identifier hs-var hs-var">serverIDT</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; (UserId -&gt; FilePath) -&gt; UserId -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Text) -&gt; UserId -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Channel -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">channelGuild</span></span><span> </span><span class="annot"><span class="annottext">Channel
</span><a href="#local-6989586621679167075"><span class="hs-identifier hs-var">chan</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- the ID of the channel the message was sent in, as a `Text`</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167070"><span class="annot"><span class="annottext">channelIDT :: Text
</span><a href="#local-6989586621679167070"><span class="hs-identifier hs-var hs-var">channelIDT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; (UserId -&gt; FilePath) -&gt; UserId -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Text) -&gt; UserId -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageChannel</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167076"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- the messageID, as a `Text`</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167069"><span class="annot"><span class="annottext">messageIDT :: Text
</span><a href="#local-6989586621679167069"><span class="hs-identifier hs-var hs-var">messageIDT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; (UserId -&gt; FilePath) -&gt; UserId -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Text) -&gt; UserId -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageId</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167076"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; DiscordHandler Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler Text) -&gt; Text -&gt; DiscordHandler Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;https://discord.com/channels/&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>                    </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167072"><span class="hs-identifier hs-var">serverIDT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>                    </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167070"><span class="hs-identifier hs-var">channelIDT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>                    </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167069"><span class="hs-identifier hs-var">messageIDT</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | `emojiToUsableText` converts a given emoji to a text which can be used to display it in Discord.</span><span>
</span><span id="line-216"></span><span class="annot"><a href="Utils.html#emojiToUsableText"><span class="hs-identifier hs-type">emojiToUsableText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Emoji</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-217"></span><span id="emojiToUsableText"><span class="annot"><span class="annottext">emojiToUsableText :: Emoji -&gt; Text
</span><a href="Utils.html#emojiToUsableText"><span class="hs-identifier hs-var hs-var">emojiToUsableText</span></a></span></span><span> </span><span id="local-6989586621679167066"><span class="annot"><span class="annottext">Emoji
</span><a href="#local-6989586621679167066"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167065"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679167065"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Emoji -&gt; Text
</span><span class="hs-identifier hs-var hs-var">emojiName</span></span><span> </span><span class="annot"><span class="annottext">Emoji
</span><a href="#local-6989586621679167066"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Emoji -&gt; Maybe UserId
</span><span class="hs-identifier hs-var hs-var">emojiId</span></span><span> </span><span class="annot"><span class="annottext">Emoji
</span><a href="#local-6989586621679167066"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">Maybe UserId
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167065"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679167063"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167063"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&lt;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167065"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167063"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | `sendMessageChan` attempts to send the given `Text` in the channel with the given</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- `channelID`. Surpesses any error message(s), returning `()`.</span><span>
</span><span id="line-225"></span><span id="local-6989586621679167264"><span class="annot"><a href="Utils.html#sendMessageChan"><span class="hs-identifier hs-type">sendMessageChan</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167264"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167264"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-226"></span><span id="sendMessageChan"><span class="annot"><span class="annottext">sendMessageChan :: UserId -&gt; Text -&gt; m ()
</span><a href="Utils.html#sendMessageChan"><span class="hs-identifier hs-var hs-var">sendMessageChan</span></a></span></span><span> </span><span id="local-6989586621679167062"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167062"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679167061"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167061"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Message -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m Message -&gt; m ()) -&gt; m Message -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; m Message
forall (m :: * -&gt; *). MonadDiscord m =&gt; UserId -&gt; Text -&gt; m Message
</span><a href="Discord.Internal.Monad.html#createMessage"><span class="hs-identifier hs-var">createMessage</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167062"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167061"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | `sendMessageChanPingsDisabled` acts in the same way as `sendMessageChan`, but disables</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- all pings (@everyone, @user, @role) pings from the message.</span><span>
</span><span id="line-230"></span><span id="local-6989586621679167059"><span class="annot"><a href="Utils.html#sendMessageChanPingsDisabled"><span class="hs-identifier hs-type">sendMessageChanPingsDisabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167059"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167059"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-231"></span><span id="sendMessageChanPingsDisabled"><span class="annot"><span class="annottext">sendMessageChanPingsDisabled :: UserId -&gt; Text -&gt; m ()
</span><a href="Utils.html#sendMessageChanPingsDisabled"><span class="hs-identifier hs-var hs-var">sendMessageChanPingsDisabled</span></a></span></span><span> </span><span id="local-6989586621679167058"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167058"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679167057"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167057"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679167056"><span class="annot"><span class="annottext">opts :: MessageDetailedOpts
</span><a href="#local-6989586621679167056"><span class="hs-identifier hs-var hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageDetailedOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">messageDetailedContent :: Text
</span><span class="hs-identifier hs-var">R.messageDetailedContent</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167057"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-233"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">messageDetailedAllowedMentions :: Maybe AllowedMentions
</span><span class="hs-identifier hs-var">R.messageDetailedAllowedMentions</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AllowedMentions -&gt; Maybe AllowedMentions
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-234"></span><span>                        </span><span class="annot"><span class="annottext">(AllowedMentions -&gt; Maybe AllowedMentions)
-&gt; AllowedMentions -&gt; Maybe AllowedMentions
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AllowedMentions
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mentionEveryone :: Bool
</span><span class="hs-identifier hs-var">R.mentionEveryone</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-235"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mentionUsers :: Bool
</span><span class="hs-identifier hs-var">R.mentionUsers</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-236"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mentionRoles :: Bool
</span><span class="hs-identifier hs-var">R.mentionRoles</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-237"></span><span>                              </span><span class="hs-special">}</span><span>
</span><span id="line-238"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">m Message -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m Message -&gt; m ()) -&gt; m Message -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; MessageDetailedOpts -&gt; m Message
forall (m :: * -&gt; *).
MonadDiscord m =&gt;
UserId -&gt; MessageDetailedOpts -&gt; m Message
</span><a href="Discord.Internal.Monad.html#createMessageDetailed"><span class="hs-identifier hs-var">createMessageDetailed</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167058"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">MessageDetailedOpts
</span><a href="#local-6989586621679167056"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | `sendReply` attempts to send a reply to the given `Message`. Suppresses any error</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- message(s), returning `()`.</span><span>
</span><span id="line-243"></span><span id="local-6989586621679167048"><span class="annot"><a href="Utils.html#sendReply"><span class="hs-identifier hs-type">sendReply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167048"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167048"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-244"></span><span id="sendReply"><span class="annot"><span class="annottext">sendReply :: Message -&gt; Bool -&gt; Text -&gt; m ()
</span><a href="Utils.html#sendReply"><span class="hs-identifier hs-var hs-var">sendReply</span></a></span></span><span> </span><span id="local-6989586621679167047"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167047"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679167046"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679167046"><span class="hs-identifier hs-var">mention</span></a></span></span><span> </span><span id="local-6989586621679167045"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167045"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">m Message -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m Message -&gt; m ()) -&gt; m Message -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; MessageDetailedOpts -&gt; m Message
forall (m :: * -&gt; *).
MonadDiscord m =&gt;
UserId -&gt; MessageDetailedOpts -&gt; m Message
</span><a href="Discord.Internal.Monad.html#createMessageDetailed"><span class="hs-identifier hs-var">createMessageDetailed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageChannel</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167047"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">(MessageDetailedOpts -&gt; m Message)
-&gt; MessageDetailedOpts -&gt; m Message
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MessageDetailedOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">messageDetailedContent :: Text
</span><span class="hs-identifier hs-var">R.messageDetailedContent</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167045"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-247"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">messageDetailedReference :: Maybe MessageReference
</span><span class="hs-identifier hs-var">R.messageDetailedReference</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageReference -&gt; Maybe MessageReference
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-248"></span><span>                </span><span class="annot"><span class="annottext">(MessageReference -&gt; Maybe MessageReference)
-&gt; MessageReference -&gt; Maybe MessageReference
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MessageReference
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">referenceMessageId :: Maybe UserId
</span><span class="hs-identifier hs-var">referenceMessageId</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Maybe UserId
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; Maybe UserId) -&gt; UserId -&gt; Maybe UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageId</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167047"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-249"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">messageDetailedAllowedMentions :: Maybe AllowedMentions
</span><span class="hs-identifier hs-var">R.messageDetailedAllowedMentions</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AllowedMentions -&gt; Maybe AllowedMentions
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-250"></span><span>                </span><span class="annot"><span class="annottext">(AllowedMentions -&gt; Maybe AllowedMentions)
-&gt; AllowedMentions -&gt; Maybe AllowedMentions
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AllowedMentions
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mentionRepliedUser :: Bool
</span><span class="hs-identifier hs-var">R.mentionRepliedUser</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679167046"><span class="hs-identifier hs-var">mention</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-251"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | `sendMessageChanEmbed` attempts to send the given embed with the given `Text` in the</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- channel with the given `channelID`. Surpesses any error message(s), returning `()`.</span><span>
</span><span id="line-255"></span><span id="local-6989586621679167041"><span class="annot"><a href="Utils.html#sendMessageChanEmbed"><span class="hs-identifier hs-type">sendMessageChanEmbed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167041"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CreateEmbed</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167041"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-256"></span><span id="sendMessageChanEmbed"><span class="annot"><span class="annottext">sendMessageChanEmbed :: UserId -&gt; Text -&gt; CreateEmbed -&gt; m ()
</span><a href="Utils.html#sendMessageChanEmbed"><span class="hs-identifier hs-var hs-var">sendMessageChanEmbed</span></a></span></span><span> </span><span id="local-6989586621679167040"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167040"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679167039"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167039"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679167038"><span class="annot"><span class="annottext">CreateEmbed
</span><a href="#local-6989586621679167038"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Message -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m Message -&gt; m ()) -&gt; m Message -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; CreateEmbed -&gt; m Message
forall (m :: * -&gt; *).
MonadDiscord m =&gt;
UserId -&gt; Text -&gt; CreateEmbed -&gt; m Message
</span><a href="Discord.Internal.Monad.html#createMessageEmbed"><span class="hs-identifier hs-var">createMessageEmbed</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167040"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167039"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">CreateEmbed
</span><a href="#local-6989586621679167038"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | `sendMessageDM` attempts to send the given `Text` as a direct message to the user with the</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- given `UserId`. Surpresses any error message(s), returning `()`.</span><span>
</span><span id="line-260"></span><span id="local-6989586621679167036"><span class="annot"><a href="Utils.html#sendMessageDM"><span class="hs-identifier hs-type">sendMessageDM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167036"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UserId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167036"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-261"></span><span id="sendMessageDM"><span class="annot"><span class="annottext">sendMessageDM :: UserId -&gt; Text -&gt; m ()
</span><a href="Utils.html#sendMessageDM"><span class="hs-identifier hs-var hs-var">sendMessageDM</span></a></span></span><span> </span><span id="local-6989586621679167035"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167035"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679167034"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167034"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679167033"><span class="annot"><span class="annottext">Channel
</span><a href="#local-6989586621679167033"><span class="hs-identifier hs-var">chan</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; m Channel
forall (m :: * -&gt; *). MonadDiscord m =&gt; UserId -&gt; m Channel
</span><a href="Discord.Internal.Monad.html#createDM"><span class="hs-identifier hs-var">createDM</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167035"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; m ()
forall (m :: * -&gt; *). MonadDiscord m =&gt; UserId -&gt; Text -&gt; m ()
</span><a href="Utils.html#sendMessageChan"><span class="hs-identifier hs-var">sendMessageChan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Channel -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">channelId</span></span><span> </span><span class="annot"><span class="annottext">Channel
</span><a href="#local-6989586621679167033"><span class="hs-identifier hs-var">chan</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167034"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | `sendFileChan` attempts to send the file at the provided `FilePath` in the channel with the</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- provided `ChannelId`. The file attachment is annotated by the given `Text`.</span><span>
</span><span id="line-267"></span><span id="local-6989586621679167260"><span class="annot"><a href="Utils.html#sendFileChan"><span class="hs-identifier hs-type">sendFileChan</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167260"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679167260"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167260"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-268"></span><span id="sendFileChan"><span class="annot"><span class="annottext">sendFileChan :: UserId -&gt; Text -&gt; FilePath -&gt; m ()
</span><a href="Utils.html#sendFileChan"><span class="hs-identifier hs-var hs-var">sendFileChan</span></a></span></span><span> </span><span id="local-6989586621679167030"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167030"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679167029"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167029"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679167028"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167028"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679167027"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679167027"><span class="hs-identifier hs-var">fileContent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; m ByteString
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; m ByteString) -&gt; IO ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ByteString
</span><span class="hs-identifier hs-var">B.readFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167028"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><span class="annottext">m Message -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m Message -&gt; m ()) -&gt; m Message -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; ByteString -&gt; m Message
forall (m :: * -&gt; *).
MonadDiscord m =&gt;
UserId -&gt; Text -&gt; ByteString -&gt; m Message
</span><a href="Discord.Internal.Monad.html#createMessageUploadFile"><span class="hs-identifier hs-var">createMessageUploadFile</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167030"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167029"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679167027"><span class="hs-identifier hs-var">fileContent</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | `sendAssetChan` is simply a wrapper for `sendFileChan` that perpends the data storage dir</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- to the provided file path.</span><span>
</span><span id="line-274"></span><span id="local-6989586621679167024"><span class="annot"><a href="Utils.html#sendAssetChan"><span class="hs-identifier hs-type">sendAssetChan</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167024"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679167024"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167024"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-275"></span><span id="sendAssetChan"><span class="annot"><span class="annottext">sendAssetChan :: UserId -&gt; Text -&gt; FilePath -&gt; m ()
</span><a href="Utils.html#sendAssetChan"><span class="hs-identifier hs-var hs-var">sendAssetChan</span></a></span></span><span> </span><span id="local-6989586621679167023"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167023"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679167022"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167022"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679167021"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167021"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679167020"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167020"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; m FilePath
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><a href="Utils.html#assetDir"><span class="hs-identifier hs-var">assetDir</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; FilePath -&gt; m ()
forall (m :: * -&gt; *).
(MonadDiscord m, MonadIO m) =&gt;
UserId -&gt; Text -&gt; FilePath -&gt; m ()
</span><a href="Utils.html#sendFileChan"><span class="hs-identifier hs-var">sendFileChan</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167023"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167022"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167020"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679167021"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | `messageFromReaction` attempts to get the Message instance from a reaction.</span><span>
</span><span id="line-280"></span><span id="local-6989586621679167019"><span class="annot"><a href="Utils.html#messageFromReaction"><span class="hs-identifier hs-type">messageFromReaction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167019"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReactionInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167019"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span></span><span>
</span><span id="line-281"></span><span id="messageFromReaction"><span class="annot"><span class="annottext">messageFromReaction :: ReactionInfo -&gt; m Message
</span><a href="Utils.html#messageFromReaction"><span class="hs-identifier hs-var hs-var">messageFromReaction</span></a></span></span><span> </span><span id="local-6989586621679167018"><span class="annot"><span class="annottext">ReactionInfo
</span><a href="#local-6989586621679167018"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UserId, UserId) -&gt; m Message
forall (m :: * -&gt; *).
MonadDiscord m =&gt;
(UserId, UserId) -&gt; m Message
</span><a href="Discord.Internal.Monad.html#getChannelMessage"><span class="hs-identifier hs-var">getChannelMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReactionInfo -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">reactionChannelId</span></span><span> </span><span class="annot"><span class="annottext">ReactionInfo
</span><a href="#local-6989586621679167018"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReactionInfo -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">reactionMessageId</span></span><span> </span><span class="annot"><span class="annottext">ReactionInfo
</span><a href="#local-6989586621679167018"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | `addReaction` attempts to add a reaction to the given message ID. Supresses any</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- error message(s), returning `()`.</span><span>
</span><span id="line-285"></span><span class="annot"><a href="Utils.html#addReaction"><span class="hs-identifier hs-type">addReaction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MessageId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span id="addReaction"><span class="annot"><span class="annottext">addReaction :: UserId -&gt; UserId -&gt; Text -&gt; DiscordHandler ()
</span><a href="Utils.html#addReaction"><span class="hs-identifier hs-var hs-var">addReaction</span></a></span></span><span> </span><span id="local-6989586621679167013"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167013"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679167012"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167012"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679167011"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167011"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChannelRequest () -&gt; DiscordHandler (Either RestCallErrorCode ())
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UserId, UserId) -&gt; Text -&gt; ChannelRequest ()
</span><span class="hs-identifier hs-var">R.CreateReaction</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167013"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679167012"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167011"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DiscordHandler (Either RestCallErrorCode ())
-&gt; DiscordHandler () -&gt; DiscordHandler ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- | `isMod` checks whether the provided message was sent by a user with the `Moderator` role.</span><span>
</span><span id="line-289"></span><span class="annot"><a href="Utils.html#isMod"><span class="hs-identifier hs-type">isMod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-290"></span><span id="isMod"><span class="annot"><span class="annottext">isMod :: Message -&gt; DiscordHandler Bool
</span><a href="Utils.html#isMod"><span class="hs-identifier hs-var hs-var">isMod</span></a></span></span><span> </span><span id="local-6989586621679167009"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167009"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool)
-&gt; ReaderT DiscordHandle IO [Bool] -&gt; DiscordHandler Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler Bool)
-&gt; [Text] -&gt; ReaderT DiscordHandle IO [Bool]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; Text -&gt; DiscordHandler Bool
forall (m :: * -&gt; *). MonadDiscord m =&gt; Message -&gt; Text -&gt; m Bool
</span><a href="Utils.html#hasRoleByName"><span class="hs-identifier hs-var">hasRoleByName</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167009"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Mod&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Moderator&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- | `isNotMutExWith` checks whether the two given lists are not mutually exclusive. That is, if the</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- two given lists contain at least one common element (with equality being determined by their `Eq`</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- class instantiation).</span><span>
</span><span id="line-295"></span><span id="local-6989586621679167006"><span class="annot"><a href="Utils.html#isNotMutExWith"><span class="hs-identifier hs-type">isNotMutExWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679167006"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679167006"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679167006"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-296"></span><span id="isNotMutExWith"><span class="annot"><span class="annottext">isNotMutExWith :: [a] -&gt; [a] -&gt; Bool
</span><a href="Utils.html#isNotMutExWith"><span class="hs-identifier hs-var hs-var">isNotMutExWith</span></a></span></span><span> </span><span id="local-6989586621679167004"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679167004"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679167003"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679167003"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a -&gt; Bool]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679167004"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a -&gt; Bool] -&gt; [a] -&gt; [Bool]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679167003"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- the cartesian product of two lists, but constructed with pairwise `(==)` instead of `(,)`.</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | `hasRoleByName` checks whether the provided message was sent by a user that has a role matching</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- the provided `Text` exactly.</span><span>
</span><span id="line-301"></span><span id="local-6989586621679167249"><span class="annot"><a href="Utils.html#hasRoleByName"><span class="hs-identifier hs-type">hasRoleByName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167249"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167249"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-302"></span><span id="hasRoleByName"><span class="annot"><span class="annottext">hasRoleByName :: Message -&gt; Text -&gt; m Bool
</span><a href="Utils.html#hasRoleByName"><span class="hs-identifier hs-var hs-var">hasRoleByName</span></a></span></span><span> </span><span id="local-6989586621679167002"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167002"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679167001"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167001"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Maybe UserId
</span><span class="hs-identifier hs-var hs-var">messageGuild</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167002"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="annottext">Maybe UserId
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679166999"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166999"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-305"></span><span>        </span><span id="local-6989586621679166998"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679166998"><span class="hs-identifier hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserId -&gt; m [Role]
forall (m :: * -&gt; *).
MonadDiscord m =&gt;
UserId -&gt; UserId -&gt; m [Role]
</span><a href="Utils.html#getRolesOfUserInGuild"><span class="hs-identifier hs-var">getRolesOfUserInGuild</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">userId</span></span><span> </span><span class="annot"><span class="annottext">(User -&gt; UserId) -&gt; User -&gt; UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; User
</span><span class="hs-identifier hs-var hs-var">messageAuthor</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679167002"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166999"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-306"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m Bool) -&gt; Bool -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679167001"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Role -&gt; Text) -&gt; [Role] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Role -&gt; Text
</span><span class="hs-identifier hs-var hs-var">roleName</span></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679166998"><span class="hs-identifier hs-var">filtered</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | `hasRoleByID` checks whether the provided message was sent by a user that has a role matching</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- the provided `RoleId`.</span><span>
</span><span id="line-310"></span><span id="local-6989586621679167236"><span class="annot"><a href="Utils.html#hasRoleByID"><span class="hs-identifier hs-type">hasRoleByID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167236"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RoleId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167236"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-311"></span><span id="hasRoleByID"><span class="annot"><span class="annottext">hasRoleByID :: Message -&gt; UserId -&gt; m Bool
</span><a href="Utils.html#hasRoleByID"><span class="hs-identifier hs-var hs-var">hasRoleByID</span></a></span></span><span> </span><span id="local-6989586621679166995"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166995"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679166994"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166994"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Maybe UserId
</span><span class="hs-identifier hs-var hs-var">messageGuild</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166995"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="annottext">Maybe UserId
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679166993"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166993"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-314"></span><span>        </span><span id="local-6989586621679166992"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679166992"><span class="hs-identifier hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserId -&gt; m [Role]
forall (m :: * -&gt; *).
MonadDiscord m =&gt;
UserId -&gt; UserId -&gt; m [Role]
</span><a href="Utils.html#getRolesOfUserInGuild"><span class="hs-identifier hs-var">getRolesOfUserInGuild</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">userId</span></span><span> </span><span class="annot"><span class="annottext">(User -&gt; UserId) -&gt; User -&gt; UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; User
</span><span class="hs-identifier hs-var hs-var">messageAuthor</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166995"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166993"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m Bool) -&gt; Bool -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166994"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; [UserId] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">(Role -&gt; UserId) -&gt; [Role] -&gt; [UserId]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Role -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">roleId</span></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679166992"><span class="hs-identifier hs-var">filtered</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | `checkAllIDs` checks every role of the provided message's author against every role in the</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- global `devIDs` file, returning an exhaustive list of booleans as a result.</span><span>
</span><span id="line-319"></span><span id="local-6989586621679167227"><span class="annot"><a href="Utils.html#checkAllIDs"><span class="hs-identifier hs-type">checkAllIDs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167227"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679167227"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-320"></span><span id="checkAllIDs"><span class="annot"><span class="annottext">checkAllIDs :: Message -&gt; IO [m Bool]
</span><a href="Utils.html#checkAllIDs"><span class="hs-identifier hs-var hs-var">checkAllIDs</span></a></span></span><span> </span><span id="local-6989586621679166990"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166990"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679166989"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166989"><span class="hs-identifier hs-var">devFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [Text]
</span><a href="CSV.html#readSingleColCSV"><span class="hs-identifier hs-var">readSingleColCSV</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Utils.html#devIDs"><span class="hs-identifier hs-var">devIDs</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166988"><span class="annot"><span class="annottext">devRoleIDs :: [UserId]
</span><a href="#local-6989586621679166988"><span class="hs-identifier hs-var hs-var">devRoleIDs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; UserId
forall a. Read a =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; UserId) -&gt; (Text -&gt; FilePath) -&gt; Text -&gt; UserId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RoleId</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; UserId) -&gt; [Text] -&gt; [UserId]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166989"><span class="hs-identifier hs-var">devFile</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">[m Bool] -&gt; IO [m Bool]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([m Bool] -&gt; IO [m Bool]) -&gt; [m Bool] -&gt; IO [m Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(UserId -&gt; m Bool) -&gt; [UserId] -&gt; [m Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; UserId -&gt; m Bool
forall (m :: * -&gt; *). MonadDiscord m =&gt; Message -&gt; UserId -&gt; m Bool
</span><a href="Utils.html#hasRoleByID"><span class="hs-identifier hs-var">hasRoleByID</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166990"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UserId]
</span><a href="#local-6989586621679166988"><span class="hs-identifier hs-var">devRoleIDs</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | `isSenderDeveloper` checks whether the provided message's author is a developer.</span><span>
</span><span id="line-326"></span><span id="local-6989586621679167223"><span class="annot"><a href="Utils.html#isSenderDeveloper"><span class="hs-identifier hs-type">isSenderDeveloper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167223"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679167223"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167223"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-327"></span><span id="isSenderDeveloper"><span class="annot"><span class="annottext">isSenderDeveloper :: Message -&gt; m Bool
</span><a href="Utils.html#isSenderDeveloper"><span class="hs-identifier hs-var hs-var">isSenderDeveloper</span></a></span></span><span> </span><span id="local-6989586621679166986"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166986"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; m [Bool] -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">(m [Bool] -&gt; m Bool)
-&gt; (IO (m [Bool]) -&gt; m [Bool]) -&gt; IO (m [Bool]) -&gt; m Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m (m [Bool]) -&gt; m [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(m (m [Bool]) -&gt; m [Bool])
-&gt; (IO (m [Bool]) -&gt; m (m [Bool])) -&gt; IO (m [Bool]) -&gt; m [Bool]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (m [Bool]) -&gt; m (m [Bool])
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (m [Bool]) -&gt; m Bool) -&gt; IO (m [Bool]) -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[m Bool] -&gt; m [Bool]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([m Bool] -&gt; m [Bool]) -&gt; IO [m Bool] -&gt; IO (m [Bool])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; IO [m Bool]
forall (m :: * -&gt; *). MonadDiscord m =&gt; Message -&gt; IO [m Bool]
</span><a href="Utils.html#checkAllIDs"><span class="hs-identifier hs-var">checkAllIDs</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166986"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | channelRequirement is a requirement for a Command to be in a certain channel.</span><span>
</span><span id="line-330"></span><span id="local-6989586621679166984"><span class="annot"><a href="Utils.html#channelRequirement"><span class="hs-identifier hs-type">channelRequirement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679166984"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679166984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-331"></span><span id="channelRequirement"><span class="annot"><span class="annottext">channelRequirement :: FilePath -&gt; Message -&gt; m (Maybe Text)
</span><a href="Utils.html#channelRequirement"><span class="hs-identifier hs-var hs-var">channelRequirement</span></a></span></span><span> </span><span id="local-6989586621679166983"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679166983"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621679166982"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166982"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageChannel</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166982"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; UserId
forall a. Read a =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679166983"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; m (Maybe Text)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; m (Maybe Text)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; m (Maybe Text)) -&gt; Maybe Text -&gt; m (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;need to be in channel&quot;</span></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">-- | Command requirement for role names, matched with OR. For and, just compose </span><span>
</span><span id="line-336"></span><span class="hs-comment">-- multiple of this.</span><span>
</span><span id="line-337"></span><span id="local-6989586621679166981"><span class="annot"><a href="Utils.html#roleNameRequirement"><span class="hs-identifier hs-type">roleNameRequirement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679166981"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679166981"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-338"></span><span id="roleNameRequirement"><span class="annot"><span class="annottext">roleNameRequirement :: [Text] -&gt; Message -&gt; m (Maybe Text)
</span><a href="Utils.html#roleNameRequirement"><span class="hs-identifier hs-var hs-var">roleNameRequirement</span></a></span></span><span> </span><span id="local-6989586621679166980"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166980"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621679166979"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166979"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679166978"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166978"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; m [Bool] -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m Bool) -&gt; [Text] -&gt; m [Bool]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; Text -&gt; m Bool
forall (m :: * -&gt; *). MonadDiscord m =&gt; Message -&gt; Text -&gt; m Bool
</span><a href="Utils.html#hasRoleByName"><span class="hs-identifier hs-var">hasRoleByName</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166979"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166980"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text -&gt; m (Maybe Text)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; m (Maybe Text)) -&gt; Maybe Text -&gt; m (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166978"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-341"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-342"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;need to have one of: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; ([Text] -&gt; FilePath) -&gt; [Text] -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166980"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">-- | Command requirement for sender being a registered developer.</span><span>
</span><span id="line-345"></span><span id="local-6989586621679166977"><span class="annot"><a href="Utils.html#developerRequirement"><span class="hs-identifier hs-type">developerRequirement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679166977"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679166977"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679166977"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-346"></span><span id="developerRequirement"><span class="annot"><span class="annottext">developerRequirement :: Message -&gt; m (Maybe Text)
</span><a href="Utils.html#developerRequirement"><span class="hs-identifier hs-var hs-var">developerRequirement</span></a></span></span><span> </span><span id="local-6989586621679166976"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166976"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-comment">-- this will take a while, so put this here</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">UserId -&gt; m ()
forall (m :: * -&gt; *). MonadDiscord m =&gt; UserId -&gt; m ()
</span><a href="Discord.Internal.Monad.html#triggerTypingIndicator"><span class="hs-identifier hs-var">triggerTypingIndicator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">messageChannel</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166976"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>    </span><span id="local-6989586621679166974"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166974"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Message -&gt; m Bool
forall (m :: * -&gt; *).
(MonadDiscord m, MonadIO m) =&gt;
Message -&gt; m Bool
</span><a href="Utils.html#isSenderDeveloper"><span class="hs-identifier hs-var">isSenderDeveloper</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166976"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text -&gt; m (Maybe Text)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; m (Maybe Text)) -&gt; Maybe Text -&gt; m (Maybe Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166974"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-351"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-352"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;need to be a developer&quot;</span></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | `getRolesOfUserInGuild` fetches a list of roles partaining to the user with the given `UserId`</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- within the guild with the given `GuildId`.</span><span>
</span><span id="line-356"></span><span id="local-6989586621679167244"><span class="annot"><a href="Utils.html#getRolesOfUserInGuild"><span class="hs-identifier hs-type">getRolesOfUserInGuild</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Discord.Internal.Monad.html#MonadDiscord"><span class="hs-identifier hs-type">MonadDiscord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679167244"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UserId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679167244"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Role</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-357"></span><span id="getRolesOfUserInGuild"><span class="annot"><span class="annottext">getRolesOfUserInGuild :: UserId -&gt; UserId -&gt; m [Role]
</span><a href="Utils.html#getRolesOfUserInGuild"><span class="hs-identifier hs-var hs-var">getRolesOfUserInGuild</span></a></span></span><span> </span><span id="local-6989586621679166973"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166973"><span class="hs-identifier hs-var">uid</span></a></span></span><span> </span><span id="local-6989586621679166972"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166972"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621679166971"><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679166971"><span class="hs-identifier hs-var">allGuildRoles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; m [Role]
forall (m :: * -&gt; *). MonadDiscord m =&gt; UserId -&gt; m [Role]
</span><a href="Discord.Internal.Monad.html#getGuildRoles"><span class="hs-identifier hs-var">getGuildRoles</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166972"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621679166970"><span class="annot"><span class="annottext">GuildMember
</span><a href="#local-6989586621679166970"><span class="hs-identifier hs-var">user</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; UserId -&gt; m GuildMember
forall (m :: * -&gt; *).
MonadDiscord m =&gt;
UserId -&gt; UserId -&gt; m GuildMember
</span><a href="Discord.Internal.Monad.html#getGuildMember"><span class="hs-identifier hs-var">getGuildMember</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166972"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166973"><span class="hs-identifier hs-var">uid</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679166968"><span class="annot"><span class="annottext">userRolesInGuild :: [Role]
</span><a href="#local-6989586621679166968"><span class="hs-identifier hs-var hs-var">userRolesInGuild</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Role -&gt; Bool) -&gt; [Role] -&gt; [Role]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679166967"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679166967"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Role -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">roleId</span></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621679166967"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; [UserId] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">GuildMember -&gt; [UserId]
</span><span class="hs-identifier hs-var hs-var">memberRoles</span></span><span> </span><span class="annot"><span class="annottext">GuildMember
</span><a href="#local-6989586621679166970"><span class="hs-identifier hs-var">user</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679166971"><span class="hs-identifier hs-var">allGuildRoles</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><span class="annottext">[Role] -&gt; m [Role]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679166968"><span class="hs-identifier hs-var">userRolesInGuild</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | `getTimestampFromMessages` returns the given message's timestamp as `Text`, in the format</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- `yyyy-mm-dd | hh:mm:ss`.</span><span>
</span><span id="line-365"></span><span class="annot"><a href="Utils.html#getTimestampFromMessage"><span class="hs-identifier hs-type">getTimestampFromMessage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-366"></span><span id="getTimestampFromMessage"><span class="annot"><span class="annottext">getTimestampFromMessage :: Message -&gt; Text
</span><a href="Utils.html#getTimestampFromMessage"><span class="hs-identifier hs-var hs-var">getTimestampFromMessage</span></a></span></span><span> </span><span id="local-6989586621679166965"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166965"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; FilePath -&gt; UTCTime -&gt; FilePath
forall t. FormatTime t =&gt; TimeLocale -&gt; FilePath -&gt; t -&gt; FilePath
</span><span class="hs-identifier hs-var">TF.formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">TF.defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;%Y-%m-%d %H:%M:%S %Z&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Message -&gt; UTCTime
</span><span class="hs-identifier hs-var hs-var">messageTimestamp</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166965"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | `captureCommandOutput` creates a new process from the desired command provided as a `String`.</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- Then, it waits for the command to finish executing, returning its output as a `Text`.</span><span>
</span><span id="line-370"></span><span class="annot"><a href="Utils.html#captureCommandOutput"><span class="hs-identifier hs-type">captureCommandOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-371"></span><span id="captureCommandOutput"><span class="annot"><span class="annottext">captureCommandOutput :: FilePath -&gt; IO Text
</span><a href="Utils.html#captureCommandOutput"><span class="hs-identifier hs-var hs-var">captureCommandOutput</span></a></span></span><span> </span><span id="local-6989586621679166961"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679166961"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679166960"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679166960"><span class="hs-identifier hs-var">executable</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679166959"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679166959"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; [FilePath]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">splitOn</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679166961"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679166958"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679166958"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CreateProcess -&gt; FilePath -&gt; IO FilePath
</span><span class="hs-identifier hs-var">Process.readCreateProcess</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">Process.proc</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679166960"><span class="hs-identifier hs-var">executable</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679166959"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-374"></span><span>        </span><span class="annot"><span class="annottext">cwd :: Maybe FilePath
</span><span class="hs-identifier hs-var">cwd</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; IO Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO Text) -&gt; Text -&gt; IO Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679166958"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | `update` calls a shell script that updates the bot's repo</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Utils.html#update"><span class="hs-identifier hs-type">update</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-380"></span><span id="update"><span class="annot"><span class="annottext">update :: IO Bool
</span><a href="Utils.html#update"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621679166954"><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679166954"><span class="hs-identifier hs-var">process</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ProcessHandle
</span><span class="hs-identifier hs-var">Process.spawnCommand</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;cd &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Utils.html#repoDir"><span class="hs-identifier hs-var">repoDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; &amp;&amp; git reset --hard @{u} &amp;&amp; git pull &amp;&amp; stack install&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679166952"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621679166952"><span class="hs-identifier hs-var">exitcode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProcessHandle -&gt; IO ExitCode
</span><span class="hs-identifier hs-var">Process.waitForProcess</span></span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679166954"><span class="hs-identifier hs-var">process</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO Bool) -&gt; Bool -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621679166952"><span class="hs-identifier hs-var">exitcode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-384"></span><span>         </span><span class="annot"><span class="annottext">ExitCode
</span><span class="hs-identifier hs-var">ExitSuccess</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-385"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">ExitFailure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- | `newCommand` should be used in the creation of a new Owen command. Given a `T.Text` command regex</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- (lacking the `:` prefix and the trailing whitespace), along with a function that can handle the</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- regex captures, the command can be used to create `Message -&gt; DiscordHandler ()` message receivers.</span><span>
</span><span id="line-390"></span><span class="annot"><a href="Utils.html#newCommand"><span class="hs-identifier hs-type">newCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span>                               </span><span class="hs-comment">-- ^ a message that needs to be handled</span><span>
</span><span id="line-391"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>                             </span><span class="hs-comment">-- ^ the new command regex</span><span>
</span><span id="line-392"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^ a function used to handle each message portion</span><span>
</span><span id="line-393"></span><span>                                                    </span><span class="hs-comment">-- captured by the command regex</span><span>
</span><span id="line-394"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>                  </span><span class="hs-comment">-- ^ the over-all result of handling the message</span><span>
</span><span id="line-395"></span><span id="newCommand"><span class="annot"><span class="annottext">newCommand :: Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newCommand"><span class="hs-identifier hs-var hs-var">newCommand</span></a></span></span><span> </span><span id="local-6989586621679166950"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166950"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679166949"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679166949"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679166948"><span class="annot"><span class="annottext">[Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679166948"><span class="hs-identifier hs-var">funct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DiscordHandler () -&gt; DiscordHandler ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679166947"><span class="hs-identifier hs-var">shouldNotBeEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DiscordHandler () -&gt; DiscordHandler ())
-&gt; DiscordHandler () -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679166948"><span class="hs-identifier hs-var">funct</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166946"><span class="hs-identifier hs-var">captures</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><a href="#local-6989586621679166945"><span class="hs-identifier hs-type">match</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-398"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>   </span><span class="hs-comment">-- the first match of the regex against the message</span><span>
</span><span id="line-399"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-400"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- every message portion identified by the regex capture groups</span><span>
</span><span id="line-401"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679166945"><span class="annot"><span class="annottext">match :: (Text, Text, Text, [Text])
</span><a href="#local-6989586621679166945"><span class="hs-identifier hs-var">match</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679166947"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679166947"><span class="hs-identifier hs-var">shouldNotBeEmpty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679166946"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166946"><span class="hs-identifier hs-var">captures</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Message -&gt; Text
</span><span class="hs-identifier hs-var hs-var">messageText</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166950"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text, Text, [Text])
forall source source1 target.
(RegexMaker Regex CompOption ExecOption source,
 RegexContext Regex source1 target) =&gt;
source1 -&gt; source -&gt; target
</span><span class="hs-operator hs-var">=~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;^:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679166949"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="TemplateRE.html#trailingWS"><span class="hs-identifier hs-var">trailingWS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">-- | `newDevCommand` should be used in the creation of a new Owen dev command. Acts in the same way as `newCommand`,</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- with the distinction that it constructs handlers that require the message author to be a developer. If they</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- are not, the message author is messaged directly and reprimanded so harshly that they will never attempt to use a</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- dev command ever again.</span><span>
</span><span id="line-408"></span><span class="annot"><a href="Utils.html#newDevCommand"><span class="hs-identifier hs-type">newDevCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span>
</span><span id="line-409"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-410"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span id="newDevCommand"><span class="annot"><span class="annottext">newDevCommand :: Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newDevCommand"><span class="hs-identifier hs-var hs-var">newDevCommand</span></a></span></span><span> </span><span id="local-6989586621679166943"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166943"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679166942"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679166942"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679166941"><span class="annot"><span class="annottext">[Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679166941"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newCommand"><span class="hs-identifier hs-var">newCommand</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166943"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679166942"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">(([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ())
-&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679166940"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166940"><span class="hs-identifier hs-var">captures</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679166939"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166939"><span class="hs-identifier hs-var">isDev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Message -&gt; DiscordHandler Bool
forall (m :: * -&gt; *).
(MonadDiscord m, MonadIO m) =&gt;
Message -&gt; m Bool
</span><a href="Utils.html#isSenderDeveloper"><span class="hs-identifier hs-var">isSenderDeveloper</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166943"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166939"><span class="hs-identifier hs-var">isDev</span></a></span><span>
</span><span id="line-415"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679166941"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166940"><span class="hs-identifier hs-var">captures</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Message -&gt; DiscordHandler ()
</span><a href="Utils.html#sendPrivError"><span class="hs-identifier hs-var">sendPrivError</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166943"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- | Similar to newDev command, however looks up the Moderator role name instead of using ID to determine the message authors role.</span><span>
</span><span id="line-419"></span><span class="annot"><a href="Utils.html#newModCommand"><span class="hs-identifier hs-type">newModCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span>
</span><span id="line-420"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-421"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span id="newModCommand"><span class="annot"><span class="annottext">newModCommand :: Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newModCommand"><span class="hs-identifier hs-var hs-var">newModCommand</span></a></span></span><span> </span><span id="local-6989586621679166937"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166937"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679166936"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679166936"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679166935"><span class="annot"><span class="annottext">[Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679166935"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Message
-&gt; Text -&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
</span><a href="Utils.html#newCommand"><span class="hs-identifier hs-var">newCommand</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166937"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679166936"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">(([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ())
-&gt; ([Text] -&gt; DiscordHandler ()) -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679166934"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166934"><span class="hs-identifier hs-var">captures</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-424"></span><span>    </span><span id="local-6989586621679166933"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166933"><span class="hs-identifier hs-var">isMod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Message -&gt; DiscordHandler Bool
</span><a href="Utils.html#isMod"><span class="hs-identifier hs-var">isMod</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166937"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679166933"><span class="hs-identifier hs-var">isMod</span></a></span><span>
</span><span id="line-426"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; DiscordHandler ()
</span><a href="#local-6989586621679166935"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679166934"><span class="hs-identifier hs-var">captures</span></a></span><span>
</span><span id="line-427"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Message -&gt; DiscordHandler ()
</span><a href="Utils.html#sendPrivError"><span class="hs-identifier hs-var">sendPrivError</span></a></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166937"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="annot"><a href="Utils.html#sendPrivError"><span class="hs-identifier hs-type">sendPrivError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span id="sendPrivError"><span class="annot"><span class="annottext">sendPrivError :: Message -&gt; DiscordHandler ()
</span><a href="Utils.html#sendPrivError"><span class="hs-identifier hs-var hs-var">sendPrivError</span></a></span></span><span> </span><span id="local-6989586621679166932"><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166932"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserId -&gt; Text -&gt; DiscordHandler ()
forall (m :: * -&gt; *). MonadDiscord m =&gt; UserId -&gt; Text -&gt; m ()
</span><a href="Utils.html#sendMessageDM"><span class="hs-identifier hs-var">sendMessageDM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">User -&gt; UserId
</span><span class="hs-identifier hs-var hs-var">userId</span></span><span> </span><span class="annot"><span class="annottext">(User -&gt; UserId) -&gt; User -&gt; UserId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; User
</span><span class="hs-identifier hs-var hs-var">messageAuthor</span></span><span> </span><span class="annot"><span class="annottext">Message
</span><a href="#local-6989586621679166932"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; DiscordHandler ()) -&gt; Text -&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="Owoifier.html#owoify"><span class="hs-identifier hs-var">owoify</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Insufficient privileges!&quot;</span></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-comment">-- | Converts Discord-Haskells Snowflake type to an integer</span><span>
</span><span id="line-433"></span><span class="annot"><a href="Utils.html#snowflakeToInt"><span class="hs-identifier hs-type">snowflakeToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Snowflake</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-434"></span><span id="snowflakeToInt"><span class="annot"><span class="annottext">snowflakeToInt :: UserId -&gt; Integer
</span><a href="Utils.html#snowflakeToInt"><span class="hs-identifier hs-var hs-var">snowflakeToInt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Snowflake</span></span><span> </span><span id="local-6989586621679166929"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166929"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679166929"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-comment">-- | Moves channel position in guild</span><span>
</span><span id="line-437"></span><span class="annot"><a href="Utils.html#moveChannel"><span class="hs-identifier hs-type">moveChannel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GuildId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChannelId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiscordHandler</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span id="moveChannel"><span class="annot"><span class="annottext">moveChannel :: UserId -&gt; UserId -&gt; Int -&gt; DiscordHandler ()
</span><a href="Utils.html#moveChannel"><span class="hs-identifier hs-var hs-var">moveChannel</span></a></span></span><span> </span><span id="local-6989586621679166928"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166928"><span class="hs-identifier hs-var">guild</span></a></span></span><span> </span><span id="local-6989586621679166927"><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166927"><span class="hs-identifier hs-var">chan</span></a></span></span><span> </span><span id="local-6989586621679166926"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679166926"><span class="hs-identifier hs-var">location</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
-&gt; DiscordHandler ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
 -&gt; DiscordHandler ())
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
-&gt; DiscordHandler ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GuildRequest [Channel]
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
forall a (r :: * -&gt; *).
(FromJSON a, Request (r a)) =&gt;
r a -&gt; DiscordHandler (Either RestCallErrorCode a)
</span><span class="hs-identifier hs-var">restCall</span></span><span> </span><span class="annot"><span class="annottext">(GuildRequest [Channel]
 -&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel]))
-&gt; GuildRequest [Channel]
-&gt; ReaderT DiscordHandle IO (Either RestCallErrorCode [Channel])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserId -&gt; [(UserId, Int)] -&gt; GuildRequest [Channel]
</span><span class="hs-identifier hs-var">R.ModifyGuildChannelPositions</span></span><span> </span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166928"><span class="hs-identifier hs-var">guild</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserId
</span><a href="#local-6989586621679166927"><span class="hs-identifier hs-var">chan</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679166926"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-439"></span></pre></body></html>