<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_RKAqD0KLqADjQWl7xfSBe"><span id="%24maxtag_RKAqD0KLqADjQWl7xfSBe"><span id="%24tag2con_RKAqD0KLqADjQWl7xfSBe"></span></span></span><span class="hs-pragma">{-# LANGUAGE CPP, DeriveDataTypeable, FlexibleContexts, MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, StandaloneDeriving                            #-}</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Web.Authenticate.OAuth</span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Data types</span></span><span>
</span><span id="line-5"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier">OAuth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#newOAuth"><span class="hs-identifier">newOAuth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthServerName"><span class="hs-identifier">oauthServerName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthRequestUri"><span class="hs-identifier">oauthRequestUri</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthAccessTokenUri"><span class="hs-identifier">oauthAccessTokenUri</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthAuthorizeUri"><span class="hs-identifier">oauthAuthorizeUri</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthSignatureMethod"><span class="hs-identifier">oauthSignatureMethod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthConsumerKey"><span class="hs-identifier">oauthConsumerKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthConsumerSecret"><span class="hs-identifier">oauthConsumerSecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthCallback"><span class="hs-identifier">oauthCallback</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthRealm"><span class="hs-identifier">oauthRealm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#oauthVersion"><span class="hs-identifier">oauthVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuthVersion"><span class="hs-identifier">OAuthVersion</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#SignMethod"><span class="hs-identifier">SignMethod</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier">Credential</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier">OAuthException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Access token request</span></span><span>
</span><span id="line-10"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#AccessTokenRequest"><span class="hs-identifier">AccessTokenRequest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#defaultAccessTokenRequest"><span class="hs-identifier">defaultAccessTokenRequest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#accessTokenAddAuth"><span class="hs-identifier">accessTokenAddAuth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#accessTokenRequestHook"><span class="hs-identifier">accessTokenRequestHook</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#accessTokenOAuth"><span class="hs-identifier">accessTokenOAuth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#accessTokenTemporaryCredential"><span class="hs-identifier">accessTokenTemporaryCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#accessTokenManager"><span class="hs-identifier">accessTokenManager</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Operations for credentials</span></span><span>
</span><span id="line-18"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#newCredential"><span class="hs-identifier">newCredential</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#emptyCredential"><span class="hs-identifier">emptyCredential</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier">insert</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#delete"><span class="hs-identifier">delete</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#inserts"><span class="hs-identifier">inserts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#injectVerifier"><span class="hs-identifier">injectVerifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Signature</span></span><span>
</span><span id="line-20"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#signOAuth"><span class="hs-identifier">signOAuth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#genSign"><span class="hs-identifier">genSign</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#checkOAuth"><span class="hs-identifier">checkOAuth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Url &amp; operation for authentication</span></span><span>
</span><span id="line-22"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Temporary credentials</span></span><span>
</span><span id="line-23"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getTemporaryCredential"><span class="hs-identifier">getTemporaryCredential</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getTemporaryCredentialWithScope"><span class="hs-identifier">getTemporaryCredentialWithScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getTemporaryCredentialProxy"><span class="hs-identifier">getTemporaryCredentialProxy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getTemporaryCredential%27"><span class="hs-identifier">getTemporaryCredential'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Authorization URL</span></span><span>
</span><span id="line-26"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#authorizeUrl"><span class="hs-identifier">authorizeUrl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#authorizeUrl%27"><span class="hs-identifier">authorizeUrl'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Attaching auth to requests</span></span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#addAuthBody"><span class="hs-identifier">addAuthBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>      </span><span class="annot"><span class="hs-comment">-- ** Finishing authentication</span></span><span>
</span><span id="line-30"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getAccessToken"><span class="hs-identifier">getAccessToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getAccessTokenProxy"><span class="hs-identifier">getAccessTokenProxy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getTokenCredential"><span class="hs-identifier">getTokenCredential</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getTokenCredentialProxy"><span class="hs-identifier">getTokenCredentialProxy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getAccessToken%27"><span class="hs-identifier">getAccessToken'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getAccessTokenWith"><span class="hs-identifier">getAccessTokenWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Utility Methods</span></span><span>
</span><span id="line-37"></span><span>      </span><span class="annot"><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier">paramEncode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#addScope"><span class="hs-identifier">addScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#addMaybeProxy"><span class="hs-identifier">addMaybeProxy</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Blaze.ByteString.Builder</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Crypto.Types.PubKey.RSA</span></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrivateKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- , PublicKey (..)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.ByteString.Base64</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Digest.Pure.SHA</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">I</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SimpleQuery</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseSimpleQuery</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Header</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">renderSimpleQuery</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">status200</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span class="hs-cpp">
#if MIN_VERSION_base(4,7,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Data</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Crypto.RSA</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">rsassa_pkcs1_v1_5_sign</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hashSHA1</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- Data types</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Data type for OAuth client (consumer).</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- The constructor for this data type is not exposed.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- Instead, you should use the 'def' method or 'newOAuth' function to retrieve a default instance,</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- and then use the records below to make modifications.</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- This approach allows us to add configuration options without breaking backwards compatibility.</span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="OAuth"><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-var">OAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OAuth"><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-var">OAuth</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="oauthServerName"><span class="annot"><span class="annottext">OAuth -&gt; String
</span><a href="Web.Authenticate.OAuth.html#oauthServerName"><span class="hs-identifier hs-var hs-var">oauthServerName</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ Service name (default: @\&quot;\&quot;@)</span><span>
</span><span id="line-82"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="oauthRequestUri"><span class="annot"><span class="annottext">OAuth -&gt; String
</span><a href="Web.Authenticate.OAuth.html#oauthRequestUri"><span class="hs-identifier hs-var hs-var">oauthRequestUri</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-83"></span><span>                   </span><span class="hs-comment">-- ^ URI to request temporary credential (default: @\&quot;\&quot;@).</span><span>
</span><span id="line-84"></span><span>                   </span><span class="hs-comment">--   You MUST specify if you use 'getTemporaryCredential'', 'getTemporaryCredentialProxy'</span><span>
</span><span id="line-85"></span><span>                   </span><span class="hs-comment">--   or 'getTemporaryCredential'; otherwise you can just leave this empty.</span><span>
</span><span id="line-86"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="oauthAccessTokenUri"><span class="annot"><span class="annottext">OAuth -&gt; String
</span><a href="Web.Authenticate.OAuth.html#oauthAccessTokenUri"><span class="hs-identifier hs-var hs-var">oauthAccessTokenUri</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-87"></span><span>                   </span><span class="hs-comment">-- ^ Uri to obtain access token (default: @\&quot;\&quot;@).</span><span>
</span><span id="line-88"></span><span>                   </span><span class="hs-comment">--   You MUST specify if you use 'getAcessToken' or 'getAccessToken'' or 'getAccessTokenWith';</span><span>
</span><span id="line-89"></span><span>                   </span><span class="hs-comment">--   otherwise you can just leave this empty.</span><span>
</span><span id="line-90"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="oauthAuthorizeUri"><span class="annot"><span class="annottext">OAuth -&gt; String
</span><a href="Web.Authenticate.OAuth.html#oauthAuthorizeUri"><span class="hs-identifier hs-var hs-var">oauthAuthorizeUri</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-91"></span><span>                   </span><span class="hs-comment">-- ^ Uri to authorize (default: @\&quot;\&quot;@).</span><span>
</span><span id="line-92"></span><span>                   </span><span class="hs-comment">--   You MUST specify if you use 'authorizeUrl' or 'authorizeZUrl'';</span><span>
</span><span id="line-93"></span><span>                   </span><span class="hs-comment">--   otherwise you can just leave this empty.</span><span>
</span><span id="line-94"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="oauthSignatureMethod"><span class="annot"><span class="annottext">OAuth -&gt; SignMethod
</span><a href="Web.Authenticate.OAuth.html#oauthSignatureMethod"><span class="hs-identifier hs-var hs-var">oauthSignatureMethod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#SignMethod"><span class="hs-identifier hs-type">SignMethod</span></a></span><span>
</span><span id="line-95"></span><span>                   </span><span class="hs-comment">-- ^ Signature Method (default: 'HMACSHA1')</span><span>
</span><span id="line-96"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="oauthConsumerKey"><span class="annot"><span class="annottext">OAuth -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthConsumerKey"><span class="hs-identifier hs-var hs-var">oauthConsumerKey</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-97"></span><span>                   </span><span class="hs-comment">-- ^ Consumer key (You MUST specify)</span><span>
</span><span id="line-98"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="oauthConsumerSecret"><span class="annot"><span class="annottext">OAuth -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthConsumerSecret"><span class="hs-identifier hs-var hs-var">oauthConsumerSecret</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-99"></span><span>                   </span><span class="hs-comment">-- ^ Consumer Secret (You MUST specify)</span><span>
</span><span id="line-100"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="oauthCallback"><span class="annot"><span class="annottext">OAuth -&gt; Maybe ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthCallback"><span class="hs-identifier hs-var hs-var">oauthCallback</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-101"></span><span>                   </span><span class="hs-comment">-- ^ Callback uri to redirect after authentication (default: @Nothing@)</span><span>
</span><span id="line-102"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="oauthRealm"><span class="annot"><span class="annottext">OAuth -&gt; Maybe ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthRealm"><span class="hs-identifier hs-var hs-var">oauthRealm</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-103"></span><span>                   </span><span class="hs-comment">-- ^ Optional authorization realm (default: @Nothing@)</span><span>
</span><span id="line-104"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="oauthVersion"><span class="annot"><span class="annottext">OAuth -&gt; OAuthVersion
</span><a href="Web.Authenticate.OAuth.html#oauthVersion"><span class="hs-identifier hs-var hs-var">oauthVersion</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuthVersion"><span class="hs-identifier hs-type">OAuthVersion</span></a></span><span>
</span><span id="line-105"></span><span>                   </span><span class="hs-comment">-- ^ OAuth spec version (default: 'OAuth10a')</span><span>
</span><span id="line-106"></span><span>                   </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073827"><span id="local-6989586621679073829"><span id="local-6989586621679073831"><span class="annot"><span class="annottext">Int -&gt; OAuth -&gt; ShowS
[OAuth] -&gt; ShowS
OAuth -&gt; String
(Int -&gt; OAuth -&gt; ShowS)
-&gt; (OAuth -&gt; String) -&gt; ([OAuth] -&gt; ShowS) -&gt; Show OAuth
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [OAuth] -&gt; ShowS
$cshowList :: [OAuth] -&gt; ShowS
show :: OAuth -&gt; String
$cshow :: OAuth -&gt; String
showsPrec :: Int -&gt; OAuth -&gt; ShowS
$cshowsPrec :: Int -&gt; OAuth -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073822"><span id="local-6989586621679073824"><span class="annot"><span class="annottext">OAuth -&gt; OAuth -&gt; Bool
(OAuth -&gt; OAuth -&gt; Bool) -&gt; (OAuth -&gt; OAuth -&gt; Bool) -&gt; Eq OAuth
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: OAuth -&gt; OAuth -&gt; Bool
$c/= :: OAuth -&gt; OAuth -&gt; Bool
== :: OAuth -&gt; OAuth -&gt; Bool
$c== :: OAuth -&gt; OAuth -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073813"><span id="local-6989586621679073815"><span id="local-6989586621679073817"><span id="local-6989586621679073819"><span class="annot"><span class="annottext">ReadPrec [OAuth]
ReadPrec OAuth
Int -&gt; ReadS OAuth
ReadS [OAuth]
(Int -&gt; ReadS OAuth)
-&gt; ReadS [OAuth]
-&gt; ReadPrec OAuth
-&gt; ReadPrec [OAuth]
-&gt; Read OAuth
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [OAuth]
$creadListPrec :: ReadPrec [OAuth]
readPrec :: ReadPrec OAuth
$creadPrec :: ReadPrec OAuth
readList :: ReadS [OAuth]
$creadList :: ReadS [OAuth]
readsPrec :: Int -&gt; ReadS OAuth
$creadsPrec :: Int -&gt; ReadS OAuth
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="%24cOAuth"><span id="%24tOAuth"><span id="local-6989586621679073783"><span id="local-6989586621679073785"><span id="local-6989586621679073787"><span id="local-6989586621679073789"><span id="local-6989586621679073791"><span id="local-6989586621679073793"><span id="local-6989586621679073795"><span id="local-6989586621679073797"><span id="local-6989586621679073799"><span id="local-6989586621679073801"><span id="local-6989586621679073803"><span id="local-6989586621679073805"><span id="local-6989586621679073807"><span id="local-6989586621679073809"><span class="annot"><span class="annottext">Typeable OAuth
DataType
Constr
Typeable OAuth
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; OAuth -&gt; c OAuth)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuth)
-&gt; (OAuth -&gt; Constr)
-&gt; (OAuth -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuth))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c OAuth))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; OAuth -&gt; OAuth)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuth -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuth -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; OAuth -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuth -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth)
-&gt; Data OAuth
OAuth -&gt; DataType
OAuth -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; OAuth -&gt; OAuth
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuth -&gt; c OAuth
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuth
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuth -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; OAuth -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuth -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuth -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuth
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuth -&gt; c OAuth
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuth)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c OAuth)
$cOAuth :: Constr
$tOAuth :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuth -&gt; m OAuth
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuth -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuth -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; OAuth -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; OAuth -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuth -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuth -&gt; r
gmapQl :: (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuth -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuth -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; OAuth -&gt; OAuth
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; OAuth -&gt; OAuth
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c OAuth)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c OAuth)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuth)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuth)
dataTypeOf :: OAuth -&gt; DataType
$cdataTypeOf :: OAuth -&gt; DataType
toConstr :: OAuth -&gt; Constr
$ctoConstr :: OAuth -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuth
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuth
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuth -&gt; c OAuth
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuth -&gt; c OAuth
$cp1Data :: Typeable OAuth
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-keyword">data</span><span> </span><span id="OAuthVersion"><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuthVersion"><span class="hs-identifier hs-var">OAuthVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OAuth10"><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth10"><span class="hs-identifier hs-var">OAuth10</span></a></span></span><span>     </span><span class="hs-comment">-- ^ OAuth protocol ver 1.0 (no oauth_verifier; differs from RFC 5849).</span><span>
</span><span id="line-110"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="OAuth10a"><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth10a"><span class="hs-identifier hs-var">OAuth10a</span></a></span></span><span>    </span><span class="hs-comment">-- ^ OAuth protocol ver 1.0a. This corresponds to community's 1.0a spec and RFC 5849.</span><span>
</span><span id="line-111"></span><span>                    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073772"><span id="local-6989586621679073774"><span id="local-6989586621679073776"><span class="annot"><span class="annottext">Int -&gt; OAuthVersion -&gt; ShowS
[OAuthVersion] -&gt; ShowS
OAuthVersion -&gt; String
(Int -&gt; OAuthVersion -&gt; ShowS)
-&gt; (OAuthVersion -&gt; String)
-&gt; ([OAuthVersion] -&gt; ShowS)
-&gt; Show OAuthVersion
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [OAuthVersion] -&gt; ShowS
$cshowList :: [OAuthVersion] -&gt; ShowS
show :: OAuthVersion -&gt; String
$cshow :: OAuthVersion -&gt; String
showsPrec :: Int -&gt; OAuthVersion -&gt; ShowS
$cshowsPrec :: Int -&gt; OAuthVersion -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073768"><span id="local-6989586621679073770"><span class="annot"><span class="annottext">OAuthVersion -&gt; OAuthVersion -&gt; Bool
(OAuthVersion -&gt; OAuthVersion -&gt; Bool)
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; Bool) -&gt; Eq OAuthVersion
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
$c/= :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
== :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
$c== :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073752"><span id="local-6989586621679073754"><span id="local-6989586621679073756"><span id="local-6989586621679073758"><span id="local-6989586621679073760"><span id="local-6989586621679073762"><span id="local-6989586621679073764"><span id="local-6989586621679073766"><span class="annot"><span class="annottext">Int -&gt; OAuthVersion
OAuthVersion -&gt; Int
OAuthVersion -&gt; [OAuthVersion]
OAuthVersion -&gt; OAuthVersion
OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion]
OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion]
(OAuthVersion -&gt; OAuthVersion)
-&gt; (OAuthVersion -&gt; OAuthVersion)
-&gt; (Int -&gt; OAuthVersion)
-&gt; (OAuthVersion -&gt; Int)
-&gt; (OAuthVersion -&gt; [OAuthVersion])
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion])
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion])
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion])
-&gt; Enum OAuthVersion
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion]
$cenumFromThenTo :: OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion]
enumFromTo :: OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion]
$cenumFromTo :: OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion]
enumFromThen :: OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion]
$cenumFromThen :: OAuthVersion -&gt; OAuthVersion -&gt; [OAuthVersion]
enumFrom :: OAuthVersion -&gt; [OAuthVersion]
$cenumFrom :: OAuthVersion -&gt; [OAuthVersion]
fromEnum :: OAuthVersion -&gt; Int
$cfromEnum :: OAuthVersion -&gt; Int
toEnum :: Int -&gt; OAuthVersion
$ctoEnum :: Int -&gt; OAuthVersion
pred :: OAuthVersion -&gt; OAuthVersion
$cpred :: OAuthVersion -&gt; OAuthVersion
succ :: OAuthVersion -&gt; OAuthVersion
$csucc :: OAuthVersion -&gt; OAuthVersion
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073736"><span id="local-6989586621679073738"><span id="local-6989586621679073740"><span id="local-6989586621679073742"><span id="local-6989586621679073744"><span id="local-6989586621679073746"><span id="local-6989586621679073748"><span class="annot"><span class="annottext">Eq OAuthVersion
Eq OAuthVersion
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; Ordering)
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; Bool)
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; Bool)
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; Bool)
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; Bool)
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion)
-&gt; (OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion)
-&gt; Ord OAuthVersion
OAuthVersion -&gt; OAuthVersion -&gt; Bool
OAuthVersion -&gt; OAuthVersion -&gt; Ordering
OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion
$cmin :: OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion
max :: OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion
$cmax :: OAuthVersion -&gt; OAuthVersion -&gt; OAuthVersion
&gt;= :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
$c&gt;= :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
&gt; :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
$c&gt; :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
&lt;= :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
$c&lt;= :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
&lt; :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
$c&lt; :: OAuthVersion -&gt; OAuthVersion -&gt; Bool
compare :: OAuthVersion -&gt; OAuthVersion -&gt; Ordering
$ccompare :: OAuthVersion -&gt; OAuthVersion -&gt; Ordering
$cp1Ord :: Eq OAuthVersion
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="%24cOAuth10a"><span id="%24cOAuth10"><span id="%24tOAuthVersion"><span id="local-6989586621679073706"><span id="local-6989586621679073708"><span id="local-6989586621679073710"><span id="local-6989586621679073712"><span id="local-6989586621679073714"><span id="local-6989586621679073716"><span id="local-6989586621679073718"><span id="local-6989586621679073720"><span id="local-6989586621679073722"><span id="local-6989586621679073724"><span id="local-6989586621679073726"><span id="local-6989586621679073728"><span id="local-6989586621679073730"><span id="local-6989586621679073732"><span class="annot"><span class="annottext">Typeable OAuthVersion
DataType
Constr
Typeable OAuthVersion
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; OAuthVersion -&gt; c OAuthVersion)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthVersion)
-&gt; (OAuthVersion -&gt; Constr)
-&gt; (OAuthVersion -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuthVersion))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c OAuthVersion))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; OAuthVersion -&gt; OAuthVersion)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthVersion -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthVersion -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthVersion -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthVersion -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion)
-&gt; Data OAuthVersion
OAuthVersion -&gt; DataType
OAuthVersion -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; OAuthVersion -&gt; OAuthVersion
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuthVersion -&gt; c OAuthVersion
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthVersion
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthVersion -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthVersion -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthVersion -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthVersion -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthVersion
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuthVersion -&gt; c OAuthVersion
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuthVersion)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c OAuthVersion)
$cOAuth10a :: Constr
$cOAuth10 :: Constr
$tOAuthVersion :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; OAuthVersion -&gt; m OAuthVersion
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthVersion -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthVersion -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthVersion -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthVersion -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthVersion -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthVersion -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthVersion -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthVersion -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; OAuthVersion -&gt; OAuthVersion
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; OAuthVersion -&gt; OAuthVersion
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c OAuthVersion)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c OAuthVersion)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuthVersion)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuthVersion)
dataTypeOf :: OAuthVersion -&gt; DataType
$cdataTypeOf :: OAuthVersion -&gt; DataType
toConstr :: OAuthVersion -&gt; Constr
$ctoConstr :: OAuthVersion -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthVersion
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthVersion
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuthVersion -&gt; c OAuthVersion
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuthVersion -&gt; c OAuthVersion
$cp1Data :: Typeable OAuthVersion
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073695"><span id="local-6989586621679073697"><span id="local-6989586621679073699"><span id="local-6989586621679073701"><span class="annot"><span class="annottext">ReadPrec [OAuthVersion]
ReadPrec OAuthVersion
Int -&gt; ReadS OAuthVersion
ReadS [OAuthVersion]
(Int -&gt; ReadS OAuthVersion)
-&gt; ReadS [OAuthVersion]
-&gt; ReadPrec OAuthVersion
-&gt; ReadPrec [OAuthVersion]
-&gt; Read OAuthVersion
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [OAuthVersion]
$creadListPrec :: ReadPrec [OAuthVersion]
readPrec :: ReadPrec OAuthVersion
$creadPrec :: ReadPrec OAuthVersion
readList :: ReadS [OAuthVersion]
$creadList :: ReadS [OAuthVersion]
readsPrec :: Int -&gt; ReadS OAuthVersion
$creadsPrec :: Int -&gt; ReadS OAuthVersion
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | Default value for OAuth datatype.</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- You must specify at least oauthServerName, URIs and Tokens.</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#newOAuth"><span class="hs-identifier hs-type">newOAuth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>
</span><span id="line-117"></span><span id="newOAuth"><span class="annot"><span class="annottext">newOAuth :: OAuth
</span><a href="Web.Authenticate.OAuth.html#newOAuth"><span class="hs-identifier hs-var hs-var">newOAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OAuth :: String
-&gt; String
-&gt; String
-&gt; String
-&gt; SignMethod
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe ByteString
-&gt; Maybe ByteString
-&gt; OAuthVersion
-&gt; OAuth
</span><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">oauthSignatureMethod :: SignMethod
</span><a href="Web.Authenticate.OAuth.html#oauthSignatureMethod"><span class="hs-identifier hs-var">oauthSignatureMethod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SignMethod
</span><a href="Web.Authenticate.OAuth.html#HMACSHA1"><span class="hs-identifier hs-var">HMACSHA1</span></a></span><span>
</span><span id="line-118"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oauthCallback :: Maybe ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthCallback"><span class="hs-identifier hs-var">oauthCallback</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-119"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oauthRealm :: Maybe ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthRealm"><span class="hs-identifier hs-var">oauthRealm</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-120"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oauthServerName :: String
</span><a href="Web.Authenticate.OAuth.html#oauthServerName"><span class="hs-identifier hs-var">oauthServerName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-121"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oauthRequestUri :: String
</span><a href="Web.Authenticate.OAuth.html#oauthRequestUri"><span class="hs-identifier hs-var">oauthRequestUri</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-122"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oauthAccessTokenUri :: String
</span><a href="Web.Authenticate.OAuth.html#oauthAccessTokenUri"><span class="hs-identifier hs-var">oauthAccessTokenUri</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-123"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oauthAuthorizeUri :: String
</span><a href="Web.Authenticate.OAuth.html#oauthAuthorizeUri"><span class="hs-identifier hs-var">oauthAuthorizeUri</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-124"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oauthConsumerKey :: ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthConsumerKey"><span class="hs-identifier hs-var">oauthConsumerKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;You MUST specify oauthConsumerKey parameter.&quot;</span></span><span>
</span><span id="line-125"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oauthConsumerSecret :: ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthConsumerSecret"><span class="hs-identifier hs-var">oauthConsumerSecret</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;You MUST specify oauthConsumerSecret parameter.&quot;</span></span><span>
</span><span id="line-126"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">oauthVersion :: OAuthVersion
</span><a href="Web.Authenticate.OAuth.html#oauthVersion"><span class="hs-identifier hs-var">oauthVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OAuthVersion
</span><a href="Web.Authenticate.OAuth.html#OAuth10a"><span class="hs-identifier hs-var">OAuth10a</span></a></span><span>
</span><span id="line-127"></span><span>                 </span><span class="hs-special">}</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679073690"><span class="annot"><span class="annottext">def :: OAuth
</span><a href="#local-6989586621679073690"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="Web.Authenticate.OAuth.html#newOAuth"><span class="hs-identifier hs-var">newOAuth</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Data type for signature method.</span><span>
</span><span id="line-134"></span><span class="hs-keyword">data</span><span> </span><span id="SignMethod"><span class="annot"><a href="Web.Authenticate.OAuth.html#SignMethod"><span class="hs-identifier hs-var">SignMethod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PLAINTEXT"><span class="annot"><a href="Web.Authenticate.OAuth.html#PLAINTEXT"><span class="hs-identifier hs-var">PLAINTEXT</span></a></span></span><span>
</span><span id="line-135"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="HMACSHA1"><span class="annot"><a href="Web.Authenticate.OAuth.html#HMACSHA1"><span class="hs-identifier hs-var">HMACSHA1</span></a></span></span><span>
</span><span id="line-136"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="RSASHA1"><span class="annot"><a href="Web.Authenticate.OAuth.html#RSASHA1"><span class="hs-identifier hs-var">RSASHA1</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrivateKey</span></span><span>
</span><span id="line-137"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073682"><span id="local-6989586621679073684"><span id="local-6989586621679073686"><span class="annot"><span class="annottext">Int -&gt; SignMethod -&gt; ShowS
[SignMethod] -&gt; ShowS
SignMethod -&gt; String
(Int -&gt; SignMethod -&gt; ShowS)
-&gt; (SignMethod -&gt; String)
-&gt; ([SignMethod] -&gt; ShowS)
-&gt; Show SignMethod
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SignMethod] -&gt; ShowS
$cshowList :: [SignMethod] -&gt; ShowS
show :: SignMethod -&gt; String
$cshow :: SignMethod -&gt; String
showsPrec :: Int -&gt; SignMethod -&gt; ShowS
$cshowsPrec :: Int -&gt; SignMethod -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073678"><span id="local-6989586621679073680"><span class="annot"><span class="annottext">SignMethod -&gt; SignMethod -&gt; Bool
(SignMethod -&gt; SignMethod -&gt; Bool)
-&gt; (SignMethod -&gt; SignMethod -&gt; Bool) -&gt; Eq SignMethod
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SignMethod -&gt; SignMethod -&gt; Bool
$c/= :: SignMethod -&gt; SignMethod -&gt; Bool
== :: SignMethod -&gt; SignMethod -&gt; Bool
$c== :: SignMethod -&gt; SignMethod -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073670"><span id="local-6989586621679073672"><span id="local-6989586621679073674"><span id="local-6989586621679073676"><span class="annot"><span class="annottext">ReadPrec [SignMethod]
ReadPrec SignMethod
Int -&gt; ReadS SignMethod
ReadS [SignMethod]
(Int -&gt; ReadS SignMethod)
-&gt; ReadS [SignMethod]
-&gt; ReadPrec SignMethod
-&gt; ReadPrec [SignMethod]
-&gt; Read SignMethod
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [SignMethod]
$creadListPrec :: ReadPrec [SignMethod]
readPrec :: ReadPrec SignMethod
$creadPrec :: ReadPrec SignMethod
readList :: ReadS [SignMethod]
$creadList :: ReadS [SignMethod]
readsPrec :: Int -&gt; ReadS SignMethod
$creadsPrec :: Int -&gt; ReadS SignMethod
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="%24cRSASHA1"><span id="%24cHMACSHA1"><span id="%24cPLAINTEXT"><span id="%24tSignMethod"><span id="local-6989586621679073641"><span id="local-6989586621679073643"><span id="local-6989586621679073645"><span id="local-6989586621679073647"><span id="local-6989586621679073649"><span id="local-6989586621679073651"><span id="local-6989586621679073653"><span id="local-6989586621679073655"><span id="local-6989586621679073657"><span id="local-6989586621679073659"><span id="local-6989586621679073661"><span id="local-6989586621679073663"><span id="local-6989586621679073665"><span id="local-6989586621679073667"><span class="annot"><span class="annottext">Typeable SignMethod
DataType
Constr
Typeable SignMethod
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; SignMethod -&gt; c SignMethod)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c SignMethod)
-&gt; (SignMethod -&gt; Constr)
-&gt; (SignMethod -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c SignMethod))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c SignMethod))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; SignMethod -&gt; SignMethod)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; SignMethod -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; SignMethod -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; SignMethod -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; SignMethod -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod)
-&gt; Data SignMethod
SignMethod -&gt; DataType
SignMethod -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; SignMethod -&gt; SignMethod
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; SignMethod -&gt; c SignMethod
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c SignMethod
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; SignMethod -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; SignMethod -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; SignMethod -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; SignMethod -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c SignMethod
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; SignMethod -&gt; c SignMethod
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c SignMethod)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c SignMethod)
$cRSASHA1 :: Constr
$cHMACSHA1 :: Constr
$cPLAINTEXT :: Constr
$tSignMethod :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; SignMethod -&gt; m SignMethod
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; SignMethod -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; SignMethod -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; SignMethod -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; SignMethod -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; SignMethod -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; SignMethod -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; SignMethod -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; SignMethod -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; SignMethod -&gt; SignMethod
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; SignMethod -&gt; SignMethod
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c SignMethod)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c SignMethod)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c SignMethod)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c SignMethod)
dataTypeOf :: SignMethod -&gt; DataType
$cdataTypeOf :: SignMethod -&gt; DataType
toConstr :: SignMethod -&gt; Constr
$ctoConstr :: SignMethod -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c SignMethod
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c SignMethod
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; SignMethod -&gt; c SignMethod
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; SignMethod -&gt; c SignMethod
$cp1Data :: Typeable SignMethod
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">newtype</span><span> </span><span id="OAuthException"><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-var">OAuthException</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OAuthException"><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-var">OAuthException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-141"></span><span>                      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073630"><span id="local-6989586621679073632"><span id="local-6989586621679073634"><span class="annot"><span class="annottext">Int -&gt; OAuthException -&gt; ShowS
[OAuthException] -&gt; ShowS
OAuthException -&gt; String
(Int -&gt; OAuthException -&gt; ShowS)
-&gt; (OAuthException -&gt; String)
-&gt; ([OAuthException] -&gt; ShowS)
-&gt; Show OAuthException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [OAuthException] -&gt; ShowS
$cshowList :: [OAuthException] -&gt; ShowS
show :: OAuthException -&gt; String
$cshow :: OAuthException -&gt; String
showsPrec :: Int -&gt; OAuthException -&gt; ShowS
$cshowsPrec :: Int -&gt; OAuthException -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073626"><span id="local-6989586621679073628"><span class="annot"><span class="annottext">OAuthException -&gt; OAuthException -&gt; Bool
(OAuthException -&gt; OAuthException -&gt; Bool)
-&gt; (OAuthException -&gt; OAuthException -&gt; Bool) -&gt; Eq OAuthException
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: OAuthException -&gt; OAuthException -&gt; Bool
$c/= :: OAuthException -&gt; OAuthException -&gt; Bool
== :: OAuthException -&gt; OAuthException -&gt; Bool
$c== :: OAuthException -&gt; OAuthException -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="%24cOAuthException"><span id="%24tOAuthException"><span id="local-6989586621679073597"><span id="local-6989586621679073599"><span id="local-6989586621679073601"><span id="local-6989586621679073603"><span id="local-6989586621679073605"><span id="local-6989586621679073607"><span id="local-6989586621679073609"><span id="local-6989586621679073611"><span id="local-6989586621679073613"><span id="local-6989586621679073615"><span id="local-6989586621679073617"><span id="local-6989586621679073619"><span id="local-6989586621679073621"><span id="local-6989586621679073623"><span class="annot"><span class="annottext">Typeable OAuthException
DataType
Constr
Typeable OAuthException
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; OAuthException -&gt; c OAuthException)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthException)
-&gt; (OAuthException -&gt; Constr)
-&gt; (OAuthException -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuthException))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c OAuthException))
-&gt; ((forall b. Data b =&gt; b -&gt; b)
    -&gt; OAuthException -&gt; OAuthException)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthException -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthException -&gt; r)
-&gt; (forall u.
    (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthException -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthException -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; OAuthException -&gt; m OAuthException)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; OAuthException -&gt; m OAuthException)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; OAuthException -&gt; m OAuthException)
-&gt; Data OAuthException
OAuthException -&gt; DataType
OAuthException -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; OAuthException -&gt; OAuthException
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuthException -&gt; c OAuthException
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthException
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthException -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthException -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthException -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthException -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; OAuthException -&gt; m OAuthException
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; OAuthException -&gt; m OAuthException
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthException
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuthException -&gt; c OAuthException
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuthException)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c OAuthException)
$cOAuthException :: Constr
$tOAuthException :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d)
-&gt; OAuthException -&gt; m OAuthException
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; OAuthException -&gt; m OAuthException
gmapMp :: (forall d. Data d =&gt; d -&gt; m d)
-&gt; OAuthException -&gt; m OAuthException
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; OAuthException -&gt; m OAuthException
gmapM :: (forall d. Data d =&gt; d -&gt; m d)
-&gt; OAuthException -&gt; m OAuthException
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; OAuthException -&gt; m OAuthException
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthException -&gt; u
$cgmapQi :: forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthException -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthException -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; OAuthException -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthException -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthException -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthException -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; OAuthException -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; OAuthException -&gt; OAuthException
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; OAuthException -&gt; OAuthException
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c OAuthException)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c OAuthException)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuthException)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c OAuthException)
dataTypeOf :: OAuthException -&gt; DataType
$cdataTypeOf :: OAuthException -&gt; DataType
toConstr :: OAuthException -&gt; Constr
$ctoConstr :: OAuthException -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthException
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c OAuthException
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuthException -&gt; c OAuthException
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; OAuthException -&gt; c OAuthException
$cp1Data :: Typeable OAuthException
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679073587"><span id="local-6989586621679073589"><span id="local-6989586621679073591"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-type">OAuthException</span></a></span></span></span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Data type for getAccessTokenWith method.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- You can create values of this type using 'defaultAccessTokenRequest'.</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- Since 1.5.1</span><span>
</span><span id="line-151"></span><span class="hs-keyword">data</span><span> </span><span id="AccessTokenRequest"><span class="annot"><a href="Web.Authenticate.OAuth.html#AccessTokenRequest"><span class="hs-identifier hs-var">AccessTokenRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AccessTokenRequest"><span class="annot"><a href="Web.Authenticate.OAuth.html#AccessTokenRequest"><span class="hs-identifier hs-var">AccessTokenRequest</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-152"></span><span>    </span><span id="accessTokenAddAuth"><span class="annot"><span class="annottext">AccessTokenRequest
-&gt; ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#accessTokenAddAuth"><span class="hs-identifier hs-var hs-var">accessTokenAddAuth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-comment">-- ^ add auth hook.</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-comment">-- Default: addAuthHeader</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-comment">-- Since 1.5.1</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="accessTokenRequestHook"><span class="annot"><span class="annottext">AccessTokenRequest -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#accessTokenRequestHook"><span class="hs-identifier hs-var hs-var">accessTokenRequestHook</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-comment">-- ^ Request Hook.</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-comment">-- Default: @id@</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- Since 1.5.1</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="accessTokenOAuth"><span class="annot"><span class="annottext">AccessTokenRequest -&gt; OAuth
</span><a href="Web.Authenticate.OAuth.html#accessTokenOAuth"><span class="hs-identifier hs-var hs-var">accessTokenOAuth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-comment">-- Since 1.5.1</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="accessTokenTemporaryCredential"><span class="annot"><span class="annottext">AccessTokenRequest -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#accessTokenTemporaryCredential"><span class="hs-identifier hs-var hs-var">accessTokenTemporaryCredential</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-comment">-- ^ Temporary Credential (with oauth_verifier if &gt;= 1.0a)</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- Since 1.5.1</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="accessTokenManager"><span class="annot"><span class="annottext">AccessTokenRequest -&gt; Manager
</span><a href="Web.Authenticate.OAuth.html#accessTokenManager"><span class="hs-identifier hs-var hs-var">accessTokenManager</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">-- ^ Manager</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-comment">-- Since 1.5.1</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Create a value of type 'AccessTokenRequest' with default values filled in.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- Note that this is a settings type. More information on usage can be found</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- at: &lt;http://www.yesodweb.com/book/settings-types&gt;.</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- Since 1.5.1</span><span>
</span><span id="line-184"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#defaultAccessTokenRequest"><span class="hs-identifier hs-type">defaultAccessTokenRequest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#AccessTokenRequest"><span class="hs-identifier hs-type">AccessTokenRequest</span></a></span><span>
</span><span id="line-185"></span><span id="defaultAccessTokenRequest"><span class="annot"><span class="annottext">defaultAccessTokenRequest :: OAuth -&gt; Credential -&gt; Manager -&gt; AccessTokenRequest
</span><a href="Web.Authenticate.OAuth.html#defaultAccessTokenRequest"><span class="hs-identifier hs-var hs-var">defaultAccessTokenRequest</span></a></span></span><span> </span><span id="local-6989586621679073584"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073584"><span class="hs-identifier hs-var">oauth</span></a></span></span><span> </span><span id="local-6989586621679073583"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073583"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621679073582"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679073582"><span class="hs-identifier hs-var">man</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest :: (ByteString -&gt; Credential -&gt; Request -&gt; Request)
-&gt; (Request -&gt; Request)
-&gt; OAuth
-&gt; Credential
-&gt; Manager
-&gt; AccessTokenRequest
</span><a href="Web.Authenticate.OAuth.html#AccessTokenRequest"><span class="hs-identifier hs-type">AccessTokenRequest</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">accessTokenAddAuth :: ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#accessTokenAddAuth"><span class="hs-identifier hs-var">accessTokenAddAuth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addAuthHeader"><span class="hs-identifier hs-var">addAuthHeader</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">accessTokenRequestHook :: Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#accessTokenRequestHook"><span class="hs-identifier hs-var">accessTokenRequestHook</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">accessTokenOAuth :: OAuth
</span><a href="Web.Authenticate.OAuth.html#accessTokenOAuth"><span class="hs-identifier hs-var">accessTokenOAuth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073584"><span class="hs-identifier hs-var">oauth</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">accessTokenTemporaryCredential :: Credential
</span><a href="Web.Authenticate.OAuth.html#accessTokenTemporaryCredential"><span class="hs-identifier hs-var">accessTokenTemporaryCredential</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073583"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">accessTokenManager :: Manager
</span><a href="Web.Authenticate.OAuth.html#accessTokenManager"><span class="hs-identifier hs-var">accessTokenManager</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679073582"><span class="hs-identifier hs-var">man</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- Credentials</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | Data type for credential.</span><span>
</span><span id="line-198"></span><span class="hs-keyword">newtype</span><span> </span><span id="Credential"><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-var">Credential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Credential"><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-var">Credential</span></a></span></span><span> </span><span class="hs-comment">-- we can easily change it back to &quot;data&quot; later if needed, right?</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="unCredential"><span class="annot"><span class="annottext">Credential -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#unCredential"><span class="hs-identifier hs-var hs-var">unCredential</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073572"><span id="local-6989586621679073574"><span id="local-6989586621679073576"><span class="annot"><span class="annottext">Int -&gt; Credential -&gt; ShowS
[Credential] -&gt; ShowS
Credential -&gt; String
(Int -&gt; Credential -&gt; ShowS)
-&gt; (Credential -&gt; String)
-&gt; ([Credential] -&gt; ShowS)
-&gt; Show Credential
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Credential] -&gt; ShowS
$cshowList :: [Credential] -&gt; ShowS
show :: Credential -&gt; String
$cshow :: Credential -&gt; String
showsPrec :: Int -&gt; Credential -&gt; ShowS
$cshowsPrec :: Int -&gt; Credential -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073568"><span id="local-6989586621679073570"><span class="annot"><span class="annottext">Credential -&gt; Credential -&gt; Bool
(Credential -&gt; Credential -&gt; Bool)
-&gt; (Credential -&gt; Credential -&gt; Bool) -&gt; Eq Credential
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Credential -&gt; Credential -&gt; Bool
$c/= :: Credential -&gt; Credential -&gt; Bool
== :: Credential -&gt; Credential -&gt; Bool
$c== :: Credential -&gt; Credential -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073553"><span id="local-6989586621679073555"><span id="local-6989586621679073557"><span id="local-6989586621679073559"><span id="local-6989586621679073561"><span id="local-6989586621679073563"><span id="local-6989586621679073565"><span class="annot"><span class="annottext">Eq Credential
Eq Credential
-&gt; (Credential -&gt; Credential -&gt; Ordering)
-&gt; (Credential -&gt; Credential -&gt; Bool)
-&gt; (Credential -&gt; Credential -&gt; Bool)
-&gt; (Credential -&gt; Credential -&gt; Bool)
-&gt; (Credential -&gt; Credential -&gt; Bool)
-&gt; (Credential -&gt; Credential -&gt; Credential)
-&gt; (Credential -&gt; Credential -&gt; Credential)
-&gt; Ord Credential
Credential -&gt; Credential -&gt; Bool
Credential -&gt; Credential -&gt; Ordering
Credential -&gt; Credential -&gt; Credential
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Credential -&gt; Credential -&gt; Credential
$cmin :: Credential -&gt; Credential -&gt; Credential
max :: Credential -&gt; Credential -&gt; Credential
$cmax :: Credential -&gt; Credential -&gt; Credential
&gt;= :: Credential -&gt; Credential -&gt; Bool
$c&gt;= :: Credential -&gt; Credential -&gt; Bool
&gt; :: Credential -&gt; Credential -&gt; Bool
$c&gt; :: Credential -&gt; Credential -&gt; Bool
&lt;= :: Credential -&gt; Credential -&gt; Bool
$c&lt;= :: Credential -&gt; Credential -&gt; Bool
&lt; :: Credential -&gt; Credential -&gt; Bool
$c&lt; :: Credential -&gt; Credential -&gt; Bool
compare :: Credential -&gt; Credential -&gt; Ordering
$ccompare :: Credential -&gt; Credential -&gt; Ordering
$cp1Ord :: Eq Credential
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073545"><span id="local-6989586621679073547"><span id="local-6989586621679073549"><span id="local-6989586621679073551"><span class="annot"><span class="annottext">ReadPrec [Credential]
ReadPrec Credential
Int -&gt; ReadS Credential
ReadS [Credential]
(Int -&gt; ReadS Credential)
-&gt; ReadS [Credential]
-&gt; ReadPrec Credential
-&gt; ReadPrec [Credential]
-&gt; Read Credential
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Credential]
$creadListPrec :: ReadPrec [Credential]
readPrec :: ReadPrec Credential
$creadPrec :: ReadPrec Credential
readList :: ReadS [Credential]
$creadList :: ReadS [Credential]
readsPrec :: Int -&gt; ReadS Credential
$creadsPrec :: Int -&gt; ReadS Credential
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="%24cCredential"><span id="%24tCredential"><span id="local-6989586621679073516"><span id="local-6989586621679073518"><span id="local-6989586621679073520"><span id="local-6989586621679073522"><span id="local-6989586621679073524"><span id="local-6989586621679073526"><span id="local-6989586621679073528"><span id="local-6989586621679073530"><span id="local-6989586621679073532"><span id="local-6989586621679073534"><span id="local-6989586621679073536"><span id="local-6989586621679073538"><span id="local-6989586621679073540"><span id="local-6989586621679073542"><span class="annot"><span class="annottext">Typeable Credential
DataType
Constr
Typeable Credential
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; Credential -&gt; c Credential)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Credential)
-&gt; (Credential -&gt; Constr)
-&gt; (Credential -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Credential))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c Credential))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; Credential -&gt; Credential)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Credential -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Credential -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Credential -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Credential -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential)
-&gt; Data Credential
Credential -&gt; DataType
Credential -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Credential -&gt; Credential
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Credential -&gt; c Credential
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Credential
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Credential -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Credential -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Credential -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Credential -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Credential
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Credential -&gt; c Credential
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Credential)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Credential)
$cCredential :: Constr
$tCredential :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Credential -&gt; m Credential
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Credential -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Credential -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; Credential -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Credential -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Credential -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Credential -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Credential -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Credential -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Credential -&gt; Credential
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Credential -&gt; Credential
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Credential)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Credential)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Credential)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Credential)
dataTypeOf :: Credential -&gt; DataType
$cdataTypeOf :: Credential -&gt; DataType
toConstr :: Credential -&gt; Constr
$ctoConstr :: Credential -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Credential
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Credential
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Credential -&gt; c Credential
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Credential -&gt; c Credential
$cp1Data :: Typeable Credential
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Convenient function to create 'Credential' with OAuth Token and Token Secret.</span><span>
</span><span id="line-204"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#newCredential"><span class="hs-identifier hs-type">newCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-comment">-- ^ value for oauth_token</span><span>
</span><span id="line-205"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-comment">-- ^ value for oauth_token_secret</span><span>
</span><span id="line-206"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-207"></span><span id="newCredential"><span class="annot"><span class="annottext">newCredential :: ByteString -&gt; ByteString -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#newCredential"><span class="hs-identifier hs-var hs-var">newCredential</span></a></span></span><span> </span><span id="local-6989586621679073513"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073513"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span id="local-6989586621679073512"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073512"><span class="hs-identifier hs-var">sec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-var">Credential</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_token&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073513"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_token_secret&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073512"><span class="hs-identifier hs-var">sec</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Empty credential.</span><span>
</span><span id="line-211"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#emptyCredential"><span class="hs-identifier hs-type">emptyCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-212"></span><span id="emptyCredential"><span class="annot"><span class="annottext">emptyCredential :: Credential
</span><a href="Web.Authenticate.OAuth.html#emptyCredential"><span class="hs-identifier hs-var hs-var">emptyCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-var">Credential</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Insert an oauth parameter into given 'Credential'.</span><span>
</span><span id="line-216"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-comment">-- ^ Parameter Name</span><span>
</span><span id="line-217"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-comment">-- ^ Value</span><span>
</span><span id="line-218"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>    </span><span class="hs-comment">-- ^ Credential</span><span>
</span><span id="line-219"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>    </span><span class="hs-comment">-- ^ Result</span><span>
</span><span id="line-220"></span><span id="insert"><span class="annot"><span class="annottext">insert :: ByteString -&gt; ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679073511"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073511"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679073510"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073510"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-var">Credential</span></a></span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; Credential)
-&gt; (Credential -&gt; [(ByteString, ByteString)])
-&gt; Credential
-&gt; Credential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; ByteString
-&gt; [(ByteString, ByteString)]
-&gt; [(ByteString, ByteString)]
forall a b. Eq a =&gt; a -&gt; b -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Authenticate.OAuth.html#insertMap"><span class="hs-identifier hs-var">insertMap</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073511"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073510"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; [(ByteString, ByteString)])
-&gt; (Credential -&gt; [(ByteString, ByteString)])
-&gt; Credential
-&gt; [(ByteString, ByteString)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#unCredential"><span class="hs-identifier hs-var hs-var">unCredential</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Convenient method for inserting multiple parameters into credential.</span><span>
</span><span id="line-224"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#inserts"><span class="hs-identifier hs-type">inserts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-225"></span><span id="inserts"><span class="annot"><span class="annottext">inserts :: [(ByteString, ByteString)] -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#inserts"><span class="hs-identifier hs-var hs-var">inserts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; [(ByteString, ByteString)] -&gt; Credential)
-&gt; [(ByteString, ByteString)] -&gt; Credential -&gt; Credential
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Credential -&gt; [(ByteString, ByteString)] -&gt; Credential)
 -&gt; [(ByteString, ByteString)] -&gt; Credential -&gt; Credential)
-&gt; (Credential -&gt; [(ByteString, ByteString)] -&gt; Credential)
-&gt; [(ByteString, ByteString)]
-&gt; Credential
-&gt; Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; Credential -&gt; Credential)
-&gt; Credential -&gt; [(ByteString, ByteString)] -&gt; Credential
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString -&gt; Credential -&gt; Credential)
-&gt; (ByteString, ByteString) -&gt; Credential -&gt; Credential
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Remove an oauth parameter for key from given 'Credential'.</span><span>
</span><span id="line-229"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#delete"><span class="hs-identifier hs-type">delete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-comment">-- ^ Parameter name</span><span>
</span><span id="line-230"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>    </span><span class="hs-comment">-- ^ Credential</span><span>
</span><span id="line-231"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>    </span><span class="hs-comment">-- ^ Result</span><span>
</span><span id="line-232"></span><span id="delete"><span class="annot"><span class="annottext">delete :: ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#delete"><span class="hs-identifier hs-var hs-var">delete</span></a></span></span><span> </span><span id="local-6989586621679073504"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073504"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-var">Credential</span></a></span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; Credential)
-&gt; (Credential -&gt; [(ByteString, ByteString)])
-&gt; Credential
-&gt; Credential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Authenticate.OAuth.html#deleteMap"><span class="hs-identifier hs-var">deleteMap</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073504"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; [(ByteString, ByteString)])
-&gt; (Credential -&gt; [(ByteString, ByteString)])
-&gt; Credential
-&gt; [(ByteString, ByteString)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#unCredential"><span class="hs-identifier hs-var hs-var">unCredential</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Insert @oauth-verifier@ on a 'Credential'.</span><span>
</span><span id="line-236"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#injectVerifier"><span class="hs-identifier hs-type">injectVerifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-237"></span><span id="injectVerifier"><span class="annot"><span class="annottext">injectVerifier :: ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#injectVerifier"><span class="hs-identifier hs-var hs-var">injectVerifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_verifier&quot;</span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- Signature</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Add OAuth headers &amp; sign to 'Request'.</span><span>
</span><span id="line-244"></span><span id="local-6989586621679073502"><span class="annot"><a href="Web.Authenticate.OAuth.html#signOAuth"><span class="hs-identifier hs-type">signOAuth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073502"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-245"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>              </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-246"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>         </span><span class="hs-comment">-- ^ Credential</span><span>
</span><span id="line-247"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span>            </span><span class="hs-comment">-- ^ Original Request</span><span>
</span><span id="line-248"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073502"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span>          </span><span class="hs-comment">-- ^ Signed OAuth Request</span></span><span>
</span><span id="line-249"></span><span id="signOAuth"><span class="annot"><span class="annottext">signOAuth :: OAuth -&gt; Credential -&gt; Request -&gt; m Request
</span><a href="Web.Authenticate.OAuth.html#signOAuth"><span class="hs-identifier hs-var hs-var">signOAuth</span></a></span></span><span> </span><span id="local-6989586621679073501"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073501"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span id="local-6989586621679073500"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073500"><span class="hs-identifier hs-var">crd</span></a></span></span><span> </span><span id="local-6989586621679073499"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073499"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OAuth
-&gt; Credential
-&gt; Bool
-&gt; (ByteString -&gt; Credential -&gt; Request -&gt; Request)
-&gt; Request
-&gt; m Request
forall (m :: * -&gt; *).
MonadIO m =&gt;
OAuth
-&gt; Credential
-&gt; Bool
-&gt; (ByteString -&gt; Credential -&gt; Request -&gt; Request)
-&gt; Request
-&gt; m Request
</span><a href="Web.Authenticate.OAuth.html#signOAuth%27"><span class="hs-identifier hs-var">signOAuth'</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073501"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073500"><span class="hs-identifier hs-var">crd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addAuthHeader"><span class="hs-identifier hs-var">addAuthHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073499"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | More flexible signOAuth</span><span>
</span><span id="line-252"></span><span id="local-6989586621679074021"><span class="annot"><a href="Web.Authenticate.OAuth.html#signOAuth%27"><span class="hs-identifier hs-type">signOAuth'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679074021"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>              </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-254"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>         </span><span class="hs-comment">-- ^ Credential</span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>               </span><span class="hs-comment">-- ^ whether to insert oauth_body_hash or not</span><span>
</span><span id="line-256"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ signature style</span><span>
</span><span id="line-257"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span>            </span><span class="hs-comment">-- ^ Original Request</span><span>
</span><span id="line-258"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074021"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span>          </span><span class="hs-comment">-- ^ Signed OAuth Request</span></span><span>
</span><span id="line-259"></span><span id="signOAuth%27"><span class="annot"><span class="annottext">signOAuth' :: OAuth
-&gt; Credential
-&gt; Bool
-&gt; (ByteString -&gt; Credential -&gt; Request -&gt; Request)
-&gt; Request
-&gt; m Request
</span><a href="Web.Authenticate.OAuth.html#signOAuth%27"><span class="hs-identifier hs-var hs-var">signOAuth'</span></a></span></span><span> </span><span id="local-6989586621679073497"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073497"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span id="local-6989586621679073496"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073496"><span class="hs-identifier hs-var">crd</span></a></span></span><span> </span><span id="local-6989586621679073495"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073495"><span class="hs-identifier hs-var">withHash</span></a></span></span><span> </span><span id="local-6989586621679073494"><span class="annot"><span class="annottext">ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="#local-6989586621679073494"><span class="hs-identifier hs-var">add_auth</span></a></span></span><span> </span><span id="local-6989586621679073493"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073493"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679073492"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073492"><span class="hs-identifier hs-var">crd'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; m Credential
forall (m :: * -&gt; *). MonadIO m =&gt; Credential -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#addTimeStamp"><span class="hs-identifier hs-var">addTimeStamp</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; m Credential) -&gt; m Credential -&gt; m Credential
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Credential -&gt; m Credential
forall (m :: * -&gt; *). MonadIO m =&gt; Credential -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#addNonce"><span class="hs-identifier hs-var">addNonce</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073496"><span class="hs-identifier hs-var">crd</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679073488"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679073488"><span class="hs-identifier hs-var">mhash</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Maybe ByteString)
</span><a href="#local-6989586621679073487"><span class="hs-identifier hs-var">moauth_body_hash</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073486"><span class="annot"><span class="annottext">tok :: Credential
</span><a href="#local-6989586621679073486"><span class="hs-identifier hs-var hs-var">tok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Credential -&gt; Credential
</span><a href="#local-6989586621679073485"><span class="hs-identifier hs-var">addHashToCred</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679073488"><span class="hs-identifier hs-var">mhash</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; Credential) -&gt; Credential -&gt; Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#injectOAuthToCred"><span class="hs-identifier hs-var">injectOAuthToCred</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073497"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073492"><span class="hs-identifier hs-var">crd'</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679073483"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073483"><span class="hs-identifier hs-var">sign</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; Credential -&gt; Request -&gt; m ByteString
forall (m :: * -&gt; *).
MonadIO m =&gt;
OAuth -&gt; Credential -&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#genSign"><span class="hs-identifier hs-var">genSign</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073497"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073486"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073493"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073482"><span class="annot"><span class="annottext">prefix :: ByteString
</span><a href="#local-6989586621679073482"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; Maybe ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthRealm"><span class="hs-identifier hs-var hs-var">oauthRealm</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073497"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;OAuth &quot;</span></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073481"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073481"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;OAuth realm=\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-operator hs-var">`BS.append`</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073481"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-operator hs-var">`BS.append`</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\&quot;,&quot;</span></span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="annottext">Request -&gt; m Request
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; m Request) -&gt; Request -&gt; m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="#local-6989586621679073494"><span class="hs-identifier hs-var">add_auth</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073482"><span class="hs-identifier hs-var">prefix</span></a></span><span>
</span><span id="line-268"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_signature&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073483"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073486"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>                    </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073493"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- adding extension https://oauth.googlecode.com/svn/spec/ext/body_hash/1.0/oauth-bodyhash.html</span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679073487"><span class="annot"><span class="annottext">moauth_body_hash :: m (Maybe ByteString)
</span><a href="#local-6989586621679073487"><span class="hs-identifier hs-var hs-var">moauth_body_hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073495"><span class="hs-identifier hs-var">withHash</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[Header] -&gt; Bool
</span><a href="Web.Authenticate.OAuth.html#isBodyFormEncoded"><span class="hs-identifier hs-var">isBodyFormEncoded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var hs-var">requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073493"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; m (Maybe ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-273"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-274"></span><span>             </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span>
</span><span id="line-275"></span><span>             </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.toStrict</span></span><span>
</span><span id="line-276"></span><span>             </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Digest SHA1State -&gt; ByteString
forall t. Digest t -&gt; ByteString
</span><span class="hs-identifier hs-var">bytestringDigest</span></span><span>
</span><span id="line-277"></span><span>             </span><span class="annot"><span class="annottext">(Digest SHA1State -&gt; ByteString)
-&gt; (ByteString -&gt; Digest SHA1State) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA1State
</span><span class="hs-identifier hs-var">sha1</span></span><span>
</span><span id="line-278"></span><span>             </span><span class="annot"><span class="annottext">(ByteString -&gt; Digest SHA1State)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; Digest SHA1State
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.fromStrict</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; m ByteString -&gt; m (Maybe ByteString)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; m ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#loadBodyBS"><span class="hs-identifier hs-var">loadBodyBS</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073493"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-comment">-- encodeHash (Just h) = &quot;oauth_body_hash=\&quot;&quot; `BS.append` paramEncode h `BS.append` &quot;\&quot;,&quot;</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-comment">-- encodeHash Nothing  = &quot;&quot;</span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679073485"><span class="annot"><span class="annottext">addHashToCred :: Maybe ByteString -&gt; Credential -&gt; Credential
</span><a href="#local-6989586621679073485"><span class="hs-identifier hs-var hs-var">addHashToCred</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073468"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073468"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_body_hash&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073468"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="#local-6989586621679073485"><span class="hs-identifier hs-var">addHashToCred</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; Credential
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | Generate OAuth signature.  Used by 'signOAuth'.</span><span>
</span><span id="line-286"></span><span id="local-6989586621679074014"><span class="annot"><a href="Web.Authenticate.OAuth.html#genSign"><span class="hs-identifier hs-type">genSign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679074014"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074014"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span></span><span>
</span><span id="line-287"></span><span id="genSign"><span class="annot"><span class="annottext">genSign :: OAuth -&gt; Credential -&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#genSign"><span class="hs-identifier hs-var hs-var">genSign</span></a></span></span><span> </span><span id="local-6989586621679073467"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073467"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span id="local-6989586621679073466"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073466"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span id="local-6989586621679073465"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073465"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; SignMethod
</span><a href="Web.Authenticate.OAuth.html#oauthSignatureMethod"><span class="hs-identifier hs-var hs-var">oauthSignatureMethod</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073467"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">SignMethod
</span><a href="Web.Authenticate.OAuth.html#HMACSHA1"><span class="hs-identifier hs-var">HMACSHA1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>      </span><span id="local-6989586621679073464"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073464"><span class="hs-identifier hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; Request -&gt; m ByteString
forall (m :: * -&gt; *).
MonadIO m =&gt;
Credential -&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#getBaseString"><span class="hs-identifier hs-var">getBaseString</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073466"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073465"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073462"><span class="annot"><span class="annottext">key :: ByteString
</span><a href="#local-6989586621679073462"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.intercalate</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString) -&gt; [ByteString] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; [ByteString] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OAuth -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthConsumerSecret"><span class="hs-identifier hs-var hs-var">oauthConsumerSecret</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073467"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#tokenSecret"><span class="hs-identifier hs-var">tokenSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073466"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="annottext">ByteString -&gt; m ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m ByteString) -&gt; ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#toStrict"><span class="hs-identifier hs-var">toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Digest SHA1State -&gt; ByteString
forall t. Digest t -&gt; ByteString
</span><span class="hs-identifier hs-var">bytestringDigest</span></span><span> </span><span class="annot"><span class="annottext">(Digest SHA1State -&gt; ByteString) -&gt; Digest SHA1State -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Digest SHA1State
</span><span class="hs-identifier hs-var">hmacSha1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#fromStrict"><span class="hs-identifier hs-var">fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073462"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073464"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="annottext">SignMethod
</span><a href="Web.Authenticate.OAuth.html#PLAINTEXT"><span class="hs-identifier hs-var">PLAINTEXT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="annottext">ByteString -&gt; m ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m ByteString) -&gt; ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.intercalate</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString) -&gt; [ByteString] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; [ByteString] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OAuth -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthConsumerSecret"><span class="hs-identifier hs-var hs-var">oauthConsumerSecret</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073467"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#tokenSecret"><span class="hs-identifier hs-var">tokenSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073466"><span class="hs-identifier hs-var">tok</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="Web.Authenticate.OAuth.html#RSASHA1"><span class="hs-identifier hs-type">RSASHA1</span></a></span><span> </span><span id="local-6989586621679073456"><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679073456"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; m ByteString -&gt; m ByteString
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#toStrict"><span class="hs-identifier hs-var">toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HashInfo -&gt; PrivateKey -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">rsassa_pkcs1_v1_5_sign</span></span><span> </span><span class="annot"><span class="annottext">HashInfo
</span><span class="hs-identifier hs-var">hashSHA1</span></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><a href="#local-6989586621679073456"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; Request -&gt; m ByteString
forall (m :: * -&gt; *).
MonadIO m =&gt;
Credential -&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#getBaseString"><span class="hs-identifier hs-var">getBaseString</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073466"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073465"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | Test existing OAuth signature.</span><span>
</span><span id="line-299"></span><span class="hs-comment">--   Since 1.5.2</span><span>
</span><span id="line-300"></span><span id="local-6989586621679073455"><span class="annot"><a href="Web.Authenticate.OAuth.html#checkOAuth"><span class="hs-identifier hs-type">checkOAuth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073455"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-301"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span>
</span><span id="line-302"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-type">OAuthException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073455"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span></span><span>
</span><span id="line-303"></span><span id="checkOAuth"><span class="annot"><span class="annottext">checkOAuth :: OAuth -&gt; Credential -&gt; Request -&gt; ExceptT OAuthException m Request
</span><a href="Web.Authenticate.OAuth.html#checkOAuth"><span class="hs-identifier hs-var hs-var">checkOAuth</span></a></span></span><span> </span><span id="local-6989586621679073454"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073454"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span id="local-6989586621679073453"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073453"><span class="hs-identifier hs-var">crd</span></a></span></span><span> </span><span id="local-6989586621679073452"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073452"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Header] -&gt; Bool
</span><a href="Web.Authenticate.OAuth.html#isBodyFormEncoded"><span class="hs-identifier hs-var">isBodyFormEncoded</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621679073451"><span class="hs-identifier hs-var">origHeaders</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; Credential -&gt; Request -&gt; ExceptT OAuthException m Request
forall (m :: * -&gt; *).
MonadIO m =&gt;
OAuth -&gt; Credential -&gt; Request -&gt; ExceptT OAuthException m Request
</span><a href="Web.Authenticate.OAuth.html#checkOAuthB"><span class="hs-identifier hs-var">checkOAuthB</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073454"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073453"><span class="hs-identifier hs-var">crd</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073452"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679073449"><span class="hs-identifier hs-var">mosig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OAuthException -&gt; ExceptT OAuthException m Request
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">(OAuthException -&gt; ExceptT OAuthException m Request)
-&gt; OAuthException -&gt; ExceptT OAuthException m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; OAuthException
</span><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-var">OAuthException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;oauth_signature parameter not found&quot;</span></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073447"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073447"><span class="hs-identifier hs-var">osig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>      </span><span id="local-6989586621679073446"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679073446"><span class="hs-identifier hs-var">mhash</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExceptT OAuthException m (Maybe ByteString)
</span><a href="#local-6989586621679073445"><span class="hs-identifier hs-var">moauth_body_hash</span></a></span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679073444"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073444"><span class="hs-identifier hs-var">oh</span></a></span></span><span> </span><span id="local-6989586621679073443"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073443"><span class="hs-identifier hs-var">nh</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073444"><span class="hs-identifier hs-var">oh</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073443"><span class="hs-identifier hs-var">nh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString -&gt; Bool)
-&gt; Maybe ByteString -&gt; Maybe (ByteString -&gt; Bool)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679073442"><span class="hs-identifier hs-var">moauth_body_hash_orig</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ByteString -&gt; Bool) -&gt; Maybe ByteString -&gt; Maybe Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">`ap`</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679073446"><span class="hs-identifier hs-var">mhash</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OAuthException -&gt; ExceptT OAuthException m Request
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">(OAuthException -&gt; ExceptT OAuthException m Request)
-&gt; OAuthException -&gt; ExceptT OAuthException m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; OAuthException
</span><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-var">OAuthException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed test of oauth_body_hash&quot;</span></span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">Maybe Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073440"><span class="annot"><span class="annottext">tok :: Credential
</span><a href="#local-6989586621679073440"><span class="hs-identifier hs-var hs-var">tok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Credential -&gt; Credential
</span><a href="#local-6989586621679073439"><span class="hs-identifier hs-var">addHashToCred</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679073446"><span class="hs-identifier hs-var">mhash</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; Credential)
-&gt; (Credential -&gt; Credential) -&gt; Credential -&gt; Credential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#injectOAuthToCred"><span class="hs-identifier hs-var">injectOAuthToCred</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073454"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; Credential) -&gt; Credential -&gt; Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#inserts"><span class="hs-identifier hs-var">inserts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall b. Maybe [(ByteString, b)] -&gt; [(ByteString, b)]
</span><a href="#local-6989586621679073438"><span class="hs-identifier hs-var">remParams</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [(ByteString, ByteString)]
</span><a href="#local-6989586621679073437"><span class="hs-identifier hs-var">authParams</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073453"><span class="hs-identifier hs-var">crd</span></a></span><span>
</span><span id="line-311"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OAuth
-&gt; Credential -&gt; Request -&gt; ExceptT OAuthException m ByteString
forall (m :: * -&gt; *).
MonadIO m =&gt;
OAuth -&gt; Credential -&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#genSign"><span class="hs-identifier hs-var">genSign</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073454"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073440"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073452"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-312"></span><span>                  </span><span class="hs-special">{</span><span class="annot"><span class="annottext">requestHeaders :: [Header]
</span><span class="hs-identifier hs-var">requestHeaders</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe Header] -&gt; [Header]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Header
</span><a href="#local-6989586621679073435"><span class="hs-identifier hs-var">mtypeHeader</span></a></span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-313"></span><span>                </span><span class="annot"><span class="annottext">ExceptT OAuthException m ByteString
-&gt; (ByteString -&gt; ExceptT OAuthException m Request)
-&gt; ExceptT OAuthException m Request
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679073434"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073434"><span class="hs-identifier hs-var">nsig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073447"><span class="hs-identifier hs-var">osig</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073434"><span class="hs-identifier hs-var">nsig</span></a></span><span>
</span><span id="line-314"></span><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ExceptT OAuthException m Request
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073452"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-315"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">OAuthException -&gt; ExceptT OAuthException m Request
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">(OAuthException -&gt; ExceptT OAuthException m Request)
-&gt; OAuthException -&gt; ExceptT OAuthException m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; OAuthException
</span><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-var">OAuthException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed test of oauth_signature&quot;</span></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679073451"><span class="annot"><span class="annottext">origHeaders :: [Header]
</span><a href="#local-6989586621679073451"><span class="hs-identifier hs-var hs-var">origHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var hs-var">requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073452"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679073433"><span class="annot"><span class="annottext">mauthHeader :: Maybe Header
</span><a href="#local-6989586621679073433"><span class="hs-identifier hs-var hs-var">mauthHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Header -&gt; Bool) -&gt; [Header] -&gt; Maybe Header
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">List.find</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Authorization&quot;</span></span><span> </span><span class="annot"><span class="annottext">HeaderName -&gt; HeaderName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HeaderName -&gt; Bool) -&gt; (Header -&gt; HeaderName) -&gt; Header -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Header -&gt; HeaderName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Header] -&gt; Maybe Header) -&gt; [Header] -&gt; Maybe Header
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621679073451"><span class="hs-identifier hs-var">origHeaders</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679073435"><span class="annot"><span class="annottext">mtypeHeader :: Maybe Header
</span><a href="#local-6989586621679073435"><span class="hs-identifier hs-var hs-var">mtypeHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Header -&gt; Bool) -&gt; [Header] -&gt; Maybe Header
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">List.find</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span> </span><span class="annot"><span class="annottext">HeaderName -&gt; HeaderName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HeaderName -&gt; Bool) -&gt; (Header -&gt; HeaderName) -&gt; Header -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Header -&gt; HeaderName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Header] -&gt; Maybe Header) -&gt; [Header] -&gt; Maybe Header
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621679073451"><span class="hs-identifier hs-var">origHeaders</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679073437"><span class="annot"><span class="annottext">authParams :: Maybe [(ByteString, ByteString)]
</span><a href="#local-6989586621679073437"><span class="hs-identifier hs-var hs-var">authParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ByteString -&gt; (ByteString, ByteString))
-&gt; [ByteString] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679073432"><span class="hs-identifier hs-var">parseParam</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [(ByteString, ByteString)])
-&gt; (Header -&gt; [ByteString]) -&gt; Header -&gt; [(ByteString, ByteString)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">BS.split</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [ByteString])
-&gt; (Header -&gt; ByteString) -&gt; Header -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Header -&gt; ByteString) -&gt; Header -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Header -&gt; ByteString
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Header -&gt; [(ByteString, ByteString)])
-&gt; Maybe Header -&gt; Maybe [(ByteString, ByteString)]
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">Maybe Header
</span><a href="#local-6989586621679073433"><span class="hs-identifier hs-var">mauthHeader</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679073438"><span class="annot"><span class="annottext">remParams :: Maybe [(ByteString, b)] -&gt; [(ByteString, b)]
</span><a href="#local-6989586621679073438"><span class="hs-identifier hs-var hs-var">remParams</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe [(ByteString, b)]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="#local-6989586621679073438"><span class="hs-identifier hs-var">remParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073429"><span class="annot"><span class="annottext">[(ByteString, b)]
</span><a href="#local-6989586621679073429"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ByteString, b) -&gt; Bool) -&gt; [(ByteString, b)] -&gt; [(ByteString, b)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ((ByteString, b) -&gt; Bool) -&gt; (ByteString, b) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [ByteString] -&gt; Bool)
-&gt; [ByteString] -&gt; ByteString -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span>
</span><span id="line-323"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;realm&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_signature&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; ByteString)
-&gt; [(ByteString, ByteString)] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#unCredential"><span class="hs-identifier hs-var hs-var">unCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073453"><span class="hs-identifier hs-var">crd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                                       </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool)
-&gt; ((ByteString, b) -&gt; ByteString) -&gt; (ByteString, b) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, b) -&gt; ByteString
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ByteString, b)]
</span><a href="#local-6989586621679073429"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679073449"><span class="annot"><span class="annottext">mosig :: Maybe ByteString
</span><a href="#local-6989586621679073449"><span class="hs-identifier hs-var hs-var">mosig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; ByteString)
-&gt; Maybe (ByteString, ByteString) -&gt; Maybe ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ByteString, ByteString) -&gt; Maybe ByteString)
-&gt; (Maybe (Maybe (ByteString, ByteString))
    -&gt; Maybe (ByteString, ByteString))
-&gt; Maybe (Maybe (ByteString, ByteString))
-&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe (ByteString, ByteString))
-&gt; Maybe (ByteString, ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Maybe (ByteString, ByteString)) -&gt; Maybe ByteString)
-&gt; Maybe (Maybe (ByteString, ByteString)) -&gt; Maybe ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; Bool)
-&gt; [(ByteString, ByteString)] -&gt; Maybe (ByteString, ByteString)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">List.find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_signature&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool)
-&gt; ((ByteString, ByteString) -&gt; ByteString)
-&gt; (ByteString, ByteString)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; Maybe (ByteString, ByteString))
-&gt; Maybe [(ByteString, ByteString)]
-&gt; Maybe (Maybe (ByteString, ByteString))
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(ByteString, ByteString)]
</span><a href="#local-6989586621679073437"><span class="hs-identifier hs-var">authParams</span></a></span><span>
</span><span id="line-326"></span><span>    </span><span id="local-6989586621679073432"><span class="annot"><span class="annottext">parseParam :: ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679073432"><span class="hs-identifier hs-var hs-var">parseParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString, ByteString) -&gt; (ByteString, ByteString)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>               </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; (ByteString, ByteString))
-&gt; (ByteString -&gt; (ByteString, ByteString))
-&gt; ByteString
-&gt; (ByteString, ByteString)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679073424"><span class="hs-identifier hs-var">splitEq</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (ByteString, ByteString))
-&gt; (ByteString -&gt; ByteString)
-&gt; ByteString
-&gt; (ByteString, ByteString)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621679073424"><span class="annot"><span class="annottext">splitEq :: ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679073424"><span class="hs-identifier hs-var hs-var">splitEq</span></a></span></span><span> </span><span id="local-6989586621679073423"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073423"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; Maybe Int
</span><span class="hs-identifier hs-var">BS.elemIndex</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073423"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-329"></span><span>                  </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073423"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073421"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679073421"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">BS.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679073421"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073423"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679073442"><span class="annot"><span class="annottext">moauth_body_hash_orig :: Maybe ByteString
</span><a href="#local-6989586621679073442"><span class="hs-identifier hs-var hs-var">moauth_body_hash_orig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe ByteString) -&gt; Maybe ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Maybe ByteString) -&gt; Maybe ByteString)
-&gt; Maybe (Maybe ByteString) -&gt; Maybe ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; ByteString)
-&gt; Maybe (ByteString, ByteString) -&gt; Maybe ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ByteString, ByteString) -&gt; Maybe ByteString)
-&gt; ([(ByteString, ByteString)] -&gt; Maybe (ByteString, ByteString))
-&gt; [(ByteString, ByteString)]
-&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; Bool)
-&gt; [(ByteString, ByteString)] -&gt; Maybe (ByteString, ByteString)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">List.find</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_body_hash&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool)
-&gt; ((ByteString, ByteString) -&gt; ByteString)
-&gt; (ByteString, ByteString)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; Maybe ByteString)
-&gt; Maybe [(ByteString, ByteString)] -&gt; Maybe (Maybe ByteString)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(ByteString, ByteString)]
</span><a href="#local-6989586621679073437"><span class="hs-identifier hs-var">authParams</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679073445"><span class="annot"><span class="annottext">moauth_body_hash :: ExceptT OAuthException m (Maybe ByteString)
</span><a href="#local-6989586621679073445"><span class="hs-identifier hs-var hs-var">moauth_body_hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679073442"><span class="hs-identifier hs-var">moauth_body_hash_orig</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; Maybe ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-333"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; ExceptT OAuthException m (Maybe ByteString)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-334"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-335"></span><span>             </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span>
</span><span id="line-336"></span><span>             </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.toStrict</span></span><span>
</span><span id="line-337"></span><span>             </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Digest SHA1State -&gt; ByteString
forall t. Digest t -&gt; ByteString
</span><span class="hs-identifier hs-var">bytestringDigest</span></span><span>
</span><span id="line-338"></span><span>             </span><span class="annot"><span class="annottext">(Digest SHA1State -&gt; ByteString)
-&gt; (ByteString -&gt; Digest SHA1State) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Digest SHA1State
</span><span class="hs-identifier hs-var">sha1</span></span><span>
</span><span id="line-339"></span><span>             </span><span class="annot"><span class="annottext">(ByteString -&gt; Digest SHA1State)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; Digest SHA1State
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.fromStrict</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; ExceptT OAuthException m ByteString
-&gt; ExceptT OAuthException m (Maybe ByteString)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ExceptT OAuthException m ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#loadBodyBS"><span class="hs-identifier hs-var">loadBodyBS</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073452"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679073439"><span class="annot"><span class="annottext">addHashToCred :: Maybe ByteString -&gt; Credential -&gt; Credential
</span><a href="#local-6989586621679073439"><span class="hs-identifier hs-var hs-var">addHashToCred</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073419"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073419"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_body_hash&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073419"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="#local-6989586621679073439"><span class="hs-identifier hs-var">addHashToCred</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; Credential
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span id="local-6989586621679073994"><span class="annot"><a href="Web.Authenticate.OAuth.html#checkOAuthB"><span class="hs-identifier hs-type">checkOAuthB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073994"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-344"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span>
</span><span id="line-345"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-type">OAuthException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span></span><span>
</span><span id="line-346"></span><span id="checkOAuthB"><span class="annot"><span class="annottext">checkOAuthB :: OAuth -&gt; Credential -&gt; Request -&gt; ExceptT OAuthException m Request
</span><a href="Web.Authenticate.OAuth.html#checkOAuthB"><span class="hs-identifier hs-var hs-var">checkOAuthB</span></a></span></span><span> </span><span id="local-6989586621679073418"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073418"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span id="local-6989586621679073417"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073417"><span class="hs-identifier hs-var">crd</span></a></span></span><span> </span><span id="local-6989586621679073416"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073416"><span class="hs-identifier hs-var">req0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679073415"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073415"><span class="hs-identifier hs-var">mosig</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073414"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073414"><span class="hs-identifier hs-var">reqBody</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679073413"><span class="hs-identifier hs-var">getSig</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (ByteString, ByteString))
-&gt; ExceptT OAuthException m ByteString
-&gt; ExceptT OAuthException m (ByteString, ByteString)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ExceptT OAuthException m ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#loadBodyBS"><span class="hs-identifier hs-var">loadBodyBS</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073416"><span class="hs-identifier hs-var">req0</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073412"><span class="annot"><span class="annottext">req :: Request
</span><a href="#local-6989586621679073412"><span class="hs-identifier hs-var hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073416"><span class="hs-identifier hs-var">req0</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">requestBody :: RequestBody
</span><span class="hs-identifier hs-var">requestBody</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><span class="hs-identifier hs-var">RequestBodyBS</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073414"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073415"><span class="hs-identifier hs-var">mosig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OAuthException -&gt; ExceptT OAuthException m Request
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">(OAuthException -&gt; ExceptT OAuthException m Request)
-&gt; OAuthException -&gt; ExceptT OAuthException m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; OAuthException
</span><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-var">OAuthException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;oauth_signature parameter not found&quot;</span></span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621679073409"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073409"><span class="hs-identifier hs-var">osig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>          </span><span id="local-6989586621679073408"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073408"><span class="hs-identifier hs-var">nsig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OAuth
-&gt; Credential -&gt; Request -&gt; ExceptT OAuthException m ByteString
forall (m :: * -&gt; *).
MonadIO m =&gt;
OAuth -&gt; Credential -&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#genSign"><span class="hs-identifier hs-var">genSign</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073418"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073417"><span class="hs-identifier hs-var">crd</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073412"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-353"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073409"><span class="hs-identifier hs-var">osig</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073408"><span class="hs-identifier hs-var">nsig</span></a></span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ExceptT OAuthException m Request
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073416"><span class="hs-identifier hs-var">req0</span></a></span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">OAuthException -&gt; ExceptT OAuthException m Request
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">(OAuthException -&gt; ExceptT OAuthException m Request)
-&gt; OAuthException -&gt; ExceptT OAuthException m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; OAuthException
</span><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-var">OAuthException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed test of oauth_signature&quot;</span></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621679073413"><span class="annot"><span class="annottext">getSig :: ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679073413"><span class="hs-identifier hs-var hs-var">getSig</span></a></span></span><span> </span><span id="local-6989586621679073407"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073407"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073406"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073406"><span class="hs-identifier hs-var">h1</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073405"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073405"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">BS.breakSubstring</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&amp;oauth_signature=&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073407"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-358"></span><span>                   </span><span class="hs-special">(</span><span id="local-6989586621679073403"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073403"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679073402"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073402"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; (ByteString, ByteString)
</span><span class="hs-identifier hs-var">BS.breakSubstring</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (ByteString, ByteString))
-&gt; ByteString -&gt; (ByteString, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">17</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073405"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-359"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073403"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073406"><span class="hs-identifier hs-var">h1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-operator hs-var">`BS.append`</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073402"><span class="hs-identifier hs-var">h2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- Temporary credentails</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | Get temporary credential for requesting acces token.</span><span>
</span><span id="line-368"></span><span id="local-6989586621679073401"><span class="annot"><a href="Web.Authenticate.OAuth.html#getTemporaryCredential"><span class="hs-identifier hs-type">getTemporaryCredential</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073401"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-369"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>         </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-370"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span>
</span><span id="line-371"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073401"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-comment">-- ^ Temporary Credential (Request Token &amp; Secret).</span></span><span>
</span><span id="line-372"></span><span id="getTemporaryCredential"><span class="annot"><span class="annottext">getTemporaryCredential :: OAuth -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getTemporaryCredential"><span class="hs-identifier hs-var hs-var">getTemporaryCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; OAuth -&gt; Manager -&gt; m Credential
forall (m :: * -&gt; *).
MonadIO m =&gt;
(Request -&gt; Request) -&gt; OAuth -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getTemporaryCredential%27"><span class="hs-identifier hs-var">getTemporaryCredential'</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- | Get temporary credential for requesting access token with Scope parameter.</span><span>
</span><span id="line-376"></span><span id="local-6989586621679073400"><span class="annot"><a href="Web.Authenticate.OAuth.html#getTemporaryCredentialWithScope"><span class="hs-identifier hs-type">getTemporaryCredentialWithScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073400"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-377"></span><span>                                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-comment">-- ^ Scope parameter string</span><span>
</span><span id="line-378"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>         </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-379"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span>
</span><span id="line-380"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073400"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-comment">-- ^ Temporay Credential (Request Token &amp; Secret).</span></span><span>
</span><span id="line-381"></span><span id="getTemporaryCredentialWithScope"><span class="annot"><span class="annottext">getTemporaryCredentialWithScope :: ByteString -&gt; OAuth -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getTemporaryCredentialWithScope"><span class="hs-identifier hs-var hs-var">getTemporaryCredentialWithScope</span></a></span></span><span> </span><span id="local-6989586621679073399"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073399"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; OAuth -&gt; Manager -&gt; m Credential
forall (m :: * -&gt; *).
MonadIO m =&gt;
(Request -&gt; Request) -&gt; OAuth -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getTemporaryCredential%27"><span class="hs-identifier hs-var">getTemporaryCredential'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addScope"><span class="hs-identifier hs-var">addScope</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073399"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- | Get temporary credential for requesting access token via the proxy.</span><span>
</span><span id="line-385"></span><span id="local-6989586621679073398"><span class="annot"><a href="Web.Authenticate.OAuth.html#getTemporaryCredentialProxy"><span class="hs-identifier hs-type">getTemporaryCredentialProxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073398"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-386"></span><span>                            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span>   </span><span class="hs-comment">-- ^ Proxy</span><span>
</span><span id="line-387"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>         </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-388"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span>
</span><span id="line-389"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073398"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-comment">-- ^ Temporary Credential (Request Token &amp; Secret).</span></span><span>
</span><span id="line-390"></span><span id="getTemporaryCredentialProxy"><span class="annot"><span class="annottext">getTemporaryCredentialProxy :: Maybe Proxy -&gt; OAuth -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getTemporaryCredentialProxy"><span class="hs-identifier hs-var hs-var">getTemporaryCredentialProxy</span></a></span></span><span> </span><span id="local-6989586621679073397"><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679073397"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679073396"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073396"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span id="local-6989586621679073395"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679073395"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request) -&gt; OAuth -&gt; Manager -&gt; m Credential
forall (m :: * -&gt; *).
MonadIO m =&gt;
(Request -&gt; Request) -&gt; OAuth -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getTemporaryCredential%27"><span class="hs-identifier hs-var">getTemporaryCredential'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Proxy -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addMaybeProxy"><span class="hs-identifier hs-var">addMaybeProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679073397"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073396"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679073395"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span id="local-6989586621679073961"><span class="annot"><a href="Web.Authenticate.OAuth.html#getTemporaryCredential%27"><span class="hs-identifier hs-type">getTemporaryCredential'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073961"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-394"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- ^ Request Hook</span><span>
</span><span id="line-395"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>                      </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-396"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span>
</span><span id="line-397"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073961"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>    </span><span class="hs-comment">-- ^ Temporary Credential (Request Token &amp; Secret).</span></span><span>
</span><span id="line-398"></span><span id="getTemporaryCredential%27"><span class="annot"><span class="annottext">getTemporaryCredential' :: (Request -&gt; Request) -&gt; OAuth -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getTemporaryCredential%27"><span class="hs-identifier hs-var hs-var">getTemporaryCredential'</span></a></span></span><span> </span><span id="local-6989586621679073394"><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679073394"><span class="hs-identifier hs-var">hook</span></a></span></span><span> </span><span id="local-6989586621679073393"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073393"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span id="local-6989586621679073392"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679073392"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073391"><span class="annot"><span class="annottext">req :: Request
</span><a href="#local-6989586621679073391"><span class="hs-identifier hs-var hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Request -&gt; Request
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Request -&gt; Request) -&gt; Maybe Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Request
forall (m :: * -&gt; *). MonadThrow m =&gt; String -&gt; m Request
</span><span class="hs-identifier hs-var">parseUrl</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Request) -&gt; String -&gt; Maybe Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; String
</span><a href="Web.Authenticate.OAuth.html#oauthRequestUri"><span class="hs-identifier hs-var hs-var">oauthRequestUri</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073393"><span class="hs-identifier hs-var">oa</span></a></span><span>
</span><span id="line-400"></span><span>      </span><span id="local-6989586621679073388"><span class="annot"><span class="annottext">crd :: Credential
</span><a href="#local-6989586621679073388"><span class="hs-identifier hs-var hs-var">crd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; Credential)
-&gt; (ByteString -&gt; Credential -&gt; Credential)
-&gt; Maybe ByteString
-&gt; Credential
-&gt; Credential
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Credential -&gt; Credential
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_callback&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OAuth -&gt; Maybe ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthCallback"><span class="hs-identifier hs-var hs-var">oauthCallback</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073393"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; Credential) -&gt; Credential -&gt; Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Web.Authenticate.OAuth.html#emptyCredential"><span class="hs-identifier hs-var">emptyCredential</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span id="local-6989586621679073386"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073386"><span class="hs-identifier hs-var">req'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OAuth
-&gt; Credential
-&gt; Bool
-&gt; (ByteString -&gt; Credential -&gt; Request -&gt; Request)
-&gt; Request
-&gt; m Request
forall (m :: * -&gt; *).
MonadIO m =&gt;
OAuth
-&gt; Credential
-&gt; Bool
-&gt; (ByteString -&gt; Credential -&gt; Request -&gt; Request)
-&gt; Request
-&gt; m Request
</span><a href="Web.Authenticate.OAuth.html#signOAuth%27"><span class="hs-identifier hs-var">signOAuth'</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073393"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073388"><span class="hs-identifier hs-var">crd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addAuthHeader"><span class="hs-identifier hs-var">addAuthHeader</span></a></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; m Request) -&gt; Request -&gt; m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679073394"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073391"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621679073384"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073384"><span class="hs-identifier hs-var">rsp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Response ByteString) -&gt; m (Response ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Response ByteString) -&gt; m (Response ByteString))
-&gt; IO (Response ByteString) -&gt; m (Response ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; IO (Response ByteString)
</span><span class="hs-identifier hs-var">httpLbs</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073386"><span class="hs-identifier hs-var">req'</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679073392"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073384"><span class="hs-identifier hs-var">rsp</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status200</span></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073381"><span class="annot"><span class="annottext">dic :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679073381"><span class="hs-identifier hs-var hs-var">dic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)]
</span><span class="hs-identifier hs-var">parseSimpleQuery</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [(ByteString, ByteString)])
-&gt; (Response ByteString -&gt; ByteString)
-&gt; Response ByteString
-&gt; [(ByteString, ByteString)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#toStrict"><span class="hs-identifier hs-var">toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Response ByteString -&gt; ByteString)
-&gt; Response ByteString
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">(Response ByteString -&gt; [(ByteString, ByteString)])
-&gt; Response ByteString -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073384"><span class="hs-identifier hs-var">rsp</span></a></span><span>
</span><span id="line-406"></span><span>      </span><span class="annot"><span class="annottext">Credential -&gt; m Credential
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; m Credential) -&gt; Credential -&gt; m Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-var">Credential</span></a></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073381"><span class="hs-identifier hs-var">dic</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IO Credential -&gt; m Credential
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Credential -&gt; m Credential)
-&gt; (String -&gt; IO Credential) -&gt; String -&gt; m Credential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OAuthException -&gt; IO Credential
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(OAuthException -&gt; IO Credential)
-&gt; (String -&gt; OAuthException) -&gt; String -&gt; IO Credential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; OAuthException
</span><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-var">OAuthException</span></a></span><span>
</span><span id="line-408"></span><span>            </span><span class="annot"><span class="annottext">(String -&gt; m Credential) -&gt; String -&gt; m Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Gaining OAuth Temporary Credential Failed: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">BSL.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073384"><span class="hs-identifier hs-var">rsp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- Authorization URL</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- | URL to obtain OAuth verifier.</span><span>
</span><span id="line-416"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#authorizeUrl"><span class="hs-identifier hs-type">authorizeUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>           </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-417"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>      </span><span class="hs-comment">-- ^ Temporary Credential (Request Token &amp; Secret)</span><span>
</span><span id="line-418"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>          </span><span class="hs-comment">-- ^ URL to authorize</span><span>
</span><span id="line-419"></span><span id="authorizeUrl"><span class="annot"><span class="annottext">authorizeUrl :: OAuth -&gt; Credential -&gt; String
</span><a href="Web.Authenticate.OAuth.html#authorizeUrl"><span class="hs-identifier hs-var hs-var">authorizeUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(OAuth -&gt; Credential -&gt; [(ByteString, ByteString)])
-&gt; OAuth -&gt; Credential -&gt; String
</span><a href="Web.Authenticate.OAuth.html#authorizeUrl%27"><span class="hs-identifier hs-var">authorizeUrl'</span></a></span><span> </span><span class="annot"><span class="annottext">((OAuth -&gt; Credential -&gt; [(ByteString, ByteString)])
 -&gt; OAuth -&gt; Credential -&gt; String)
-&gt; (OAuth -&gt; Credential -&gt; [(ByteString, ByteString)])
-&gt; OAuth
-&gt; Credential
-&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679073377"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073377"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
-&gt; Credential -&gt; [(ByteString, ByteString)]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_consumer_key&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthConsumerKey"><span class="hs-identifier hs-var hs-var">oauthConsumerKey</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073377"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- | Convert OAuth and Credential to URL to authorize.</span><span>
</span><span id="line-423"></span><span class="hs-comment">--   This takes function to choice parameter to pass to the server other than</span><span>
</span><span id="line-424"></span><span class="hs-comment">--   /oauth_callback/ or /oauth_token/.</span><span>
</span><span id="line-425"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#authorizeUrl%27"><span class="hs-identifier hs-type">authorizeUrl'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SimpleQuery</span></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>           </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-427"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>      </span><span class="hs-comment">-- ^ Temporary Credential (Request Token &amp; Secret)</span><span>
</span><span id="line-428"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>          </span><span class="hs-comment">-- ^ URL to authorize</span><span>
</span><span id="line-429"></span><span id="authorizeUrl%27"><span class="annot"><span class="annottext">authorizeUrl' :: (OAuth -&gt; Credential -&gt; [(ByteString, ByteString)])
-&gt; OAuth -&gt; Credential -&gt; String
</span><a href="Web.Authenticate.OAuth.html#authorizeUrl%27"><span class="hs-identifier hs-var hs-var">authorizeUrl'</span></a></span></span><span> </span><span id="local-6989586621679073375"><span class="annot"><span class="annottext">OAuth -&gt; Credential -&gt; [(ByteString, ByteString)]
</span><a href="#local-6989586621679073375"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679073374"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073374"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span id="local-6989586621679073373"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073373"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; String
</span><a href="Web.Authenticate.OAuth.html#oauthAuthorizeUri"><span class="hs-identifier hs-var hs-var">oauthAuthorizeUri</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073374"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">BS.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; [(ByteString, ByteString)] -&gt; ByteString
</span><span class="hs-identifier hs-var">renderSimpleQuery</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073371"><span class="hs-identifier hs-var">queries</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679073370"><span class="annot"><span class="annottext">fixed :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679073370"><span class="hs-identifier hs-var hs-var">fixed</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_token&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#token"><span class="hs-identifier hs-var">token</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073373"><span class="hs-identifier hs-var">cr</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(ByteString, ByteString)
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">OAuth -&gt; Credential -&gt; [(ByteString, ByteString)]
</span><a href="#local-6989586621679073375"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073374"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073373"><span class="hs-identifier hs-var">cr</span></a></span><span>
</span><span id="line-431"></span><span>        </span><span id="local-6989586621679073371"><span class="annot"><span class="annottext">queries :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679073371"><span class="hs-identifier hs-var hs-var">queries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-432"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; Maybe ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthCallback"><span class="hs-identifier hs-var hs-var">oauthCallback</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073374"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-433"></span><span>            </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073370"><span class="hs-identifier hs-var">fixed</span></a></span><span>
</span><span id="line-434"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073368"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073368"><span class="hs-identifier hs-var">callback</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_callback&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073368"><span class="hs-identifier hs-var">callback</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(ByteString, ByteString)
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073370"><span class="hs-identifier hs-var">fixed</span></a></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- Finishing authentication</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">-- | Get Access token.</span><span>
</span><span id="line-442"></span><span id="local-6989586621679073931"><span class="annot"><a href="Web.Authenticate.OAuth.html#getAccessToken"><span class="hs-identifier hs-type">getAccessToken</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getTokenCredential"><span class="hs-identifier hs-type">getTokenCredential</span></a></span><span>
</span><span id="line-443"></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073931"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-444"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>         </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-445"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>    </span><span class="hs-comment">-- ^ Temporary Credential (with oauth_verifier if &gt;= 1.0a)</span><span>
</span><span id="line-446"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span>
</span><span id="line-447"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073931"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-comment">-- ^ Token Credential (Access Token &amp; Secret)</span></span><span>
</span><span id="line-448"></span><span id="getAccessToken"><span class="annot"><span class="annottext">getAccessToken :: OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getAccessToken"><span class="hs-identifier hs-var hs-var">getAccessToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request)
-&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
forall (m :: * -&gt; *).
MonadIO m =&gt;
(Request -&gt; Request)
-&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getAccessToken%27"><span class="hs-identifier hs-var">getAccessToken'</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="hs-comment">-- | Get Access token via the proxy.</span><span>
</span><span id="line-452"></span><span id="local-6989586621679073929"><span class="annot"><a href="Web.Authenticate.OAuth.html#getAccessTokenProxy"><span class="hs-identifier hs-type">getAccessTokenProxy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#getTokenCredentialProxy"><span class="hs-identifier hs-type">getTokenCredentialProxy</span></a></span><span>
</span><span id="line-453"></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073929"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-454"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span>   </span><span class="hs-comment">-- ^ Proxy</span><span>
</span><span id="line-455"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>         </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-456"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>    </span><span class="hs-comment">-- ^ Temporary Credential (with oauth_verifier if &gt;= 1.0a)</span><span>
</span><span id="line-457"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span>
</span><span id="line-458"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073929"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-comment">-- ^ Token Credential (Access Token &amp; Secret)</span></span><span>
</span><span id="line-459"></span><span id="getAccessTokenProxy"><span class="annot"><span class="annottext">getAccessTokenProxy :: Maybe Proxy -&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getAccessTokenProxy"><span class="hs-identifier hs-var hs-var">getAccessTokenProxy</span></a></span></span><span> </span><span id="local-6989586621679073367"><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679073367"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Request)
-&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
forall (m :: * -&gt; *).
MonadIO m =&gt;
(Request -&gt; Request)
-&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getAccessToken%27"><span class="hs-identifier hs-var">getAccessToken'</span></a></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; Request)
 -&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential)
-&gt; (Request -&gt; Request)
-&gt; OAuth
-&gt; Credential
-&gt; Manager
-&gt; m Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Proxy -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addMaybeProxy"><span class="hs-identifier hs-var">addMaybeProxy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679073367"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span id="local-6989586621679073939"><span class="annot"><a href="Web.Authenticate.OAuth.html#getAccessToken%27"><span class="hs-identifier hs-type">getAccessToken'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073939"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-462"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- ^ Request Hook</span><span>
</span><span id="line-463"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span>                      </span><span class="hs-comment">-- ^ OAuth Application</span><span>
</span><span id="line-464"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>                 </span><span class="hs-comment">-- ^ Temporary Credential (with oauth_verifier if &gt;= 1.0a)</span><span>
</span><span id="line-465"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Manager</span></span><span>
</span><span id="line-466"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073939"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>     </span><span class="hs-comment">-- ^ Token Credential (Access Token &amp; Secret)</span></span><span>
</span><span id="line-467"></span><span id="getAccessToken%27"><span class="annot"><span class="annottext">getAccessToken' :: (Request -&gt; Request)
-&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getAccessToken%27"><span class="hs-identifier hs-var hs-var">getAccessToken'</span></a></span></span><span> </span><span id="local-6989586621679073366"><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679073366"><span class="hs-identifier hs-var">hook</span></a></span></span><span> </span><span id="local-6989586621679073365"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073365"><span class="hs-identifier hs-var">oauth</span></a></span></span><span> </span><span id="local-6989586621679073364"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073364"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span id="local-6989586621679073363"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679073363"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>    </span><span id="local-6989586621679073362"><span class="annot"><span class="annottext">Either (Response ByteString) Credential
</span><a href="#local-6989586621679073362"><span class="hs-identifier hs-var">maybe_access_token</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest -&gt; m (Either (Response ByteString) Credential)
forall (m :: * -&gt; *).
MonadIO m =&gt;
AccessTokenRequest -&gt; m (Either (Response ByteString) Credential)
</span><a href="Web.Authenticate.OAuth.html#getAccessTokenWith"><span class="hs-identifier hs-var">getAccessTokenWith</span></a></span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest :: (ByteString -&gt; Credential -&gt; Request -&gt; Request)
-&gt; (Request -&gt; Request)
-&gt; OAuth
-&gt; Credential
-&gt; Manager
-&gt; AccessTokenRequest
</span><a href="Web.Authenticate.OAuth.html#AccessTokenRequest"><span class="hs-identifier hs-type">AccessTokenRequest</span></a></span><span>
</span><span id="line-469"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">accessTokenAddAuth :: ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#accessTokenAddAuth"><span class="hs-identifier hs-var">accessTokenAddAuth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addAuthHeader"><span class="hs-identifier hs-var">addAuthHeader</span></a></span><span>
</span><span id="line-470"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">accessTokenRequestHook :: Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#accessTokenRequestHook"><span class="hs-identifier hs-var">accessTokenRequestHook</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679073366"><span class="hs-identifier hs-var">hook</span></a></span><span>
</span><span id="line-471"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">accessTokenOAuth :: OAuth
</span><a href="Web.Authenticate.OAuth.html#accessTokenOAuth"><span class="hs-identifier hs-var">accessTokenOAuth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073365"><span class="hs-identifier hs-var">oauth</span></a></span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">accessTokenTemporaryCredential :: Credential
</span><a href="Web.Authenticate.OAuth.html#accessTokenTemporaryCredential"><span class="hs-identifier hs-var">accessTokenTemporaryCredential</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073364"><span class="hs-identifier hs-var">cr</span></a></span><span>
</span><span id="line-473"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">accessTokenManager :: Manager
</span><a href="Web.Authenticate.OAuth.html#accessTokenManager"><span class="hs-identifier hs-var">accessTokenManager</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679073363"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-474"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either (Response ByteString) Credential
</span><a href="#local-6989586621679073362"><span class="hs-identifier hs-var">maybe_access_token</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-476"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679073361"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073361"><span class="hs-identifier hs-var">error_response</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Credential -&gt; m Credential
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Credential -&gt; m Credential)
-&gt; (String -&gt; IO Credential) -&gt; String -&gt; m Credential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OAuthException -&gt; IO Credential
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(OAuthException -&gt; IO Credential)
-&gt; (String -&gt; OAuthException) -&gt; String -&gt; IO Credential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; OAuthException
</span><a href="Web.Authenticate.OAuth.html#OAuthException"><span class="hs-identifier hs-var">OAuthException</span></a></span><span>
</span><span id="line-477"></span><span>                            </span><span class="annot"><span class="annottext">(String -&gt; m Credential) -&gt; String -&gt; m Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Gaining OAuth Token Credential Failed: &quot;</span></span><span>
</span><span id="line-478"></span><span>                                    </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><span class="hs-identifier hs-var">BSL.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073361"><span class="hs-identifier hs-var">error_response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679073360"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073360"><span class="hs-identifier hs-var">access_token</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; m Credential
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073360"><span class="hs-identifier hs-var">access_token</span></a></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span id="local-6989586621679073936"><span class="annot"><a href="Web.Authenticate.OAuth.html#getAccessTokenWith"><span class="hs-identifier hs-type">getAccessTokenWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073936"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-482"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#AccessTokenRequest"><span class="hs-identifier hs-type">AccessTokenRequest</span></a></span><span> </span><span class="hs-comment">-- ^ extensible parameters</span><span>
</span><span id="line-483"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073936"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Response</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BSL.ByteString</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-484"></span><span>                     </span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Token Credential (Access Token &amp; Secret) or the conduit response on failures</span></span><span>
</span><span id="line-485"></span><span id="getAccessTokenWith"><span class="annot"><span class="annottext">getAccessTokenWith :: AccessTokenRequest -&gt; m (Either (Response ByteString) Credential)
</span><a href="Web.Authenticate.OAuth.html#getAccessTokenWith"><span class="hs-identifier hs-var hs-var">getAccessTokenWith</span></a></span></span><span> </span><span id="local-6989586621679073359"><span class="annot"><span class="annottext">AccessTokenRequest
</span><a href="#local-6989586621679073359"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073358"><span class="annot"><span class="annottext">req :: Request
</span><a href="#local-6989586621679073358"><span class="hs-identifier hs-var hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="#local-6989586621679073357"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Request -&gt; Request
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Request -&gt; Request) -&gt; Maybe Request -&gt; Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Request
forall (m :: * -&gt; *). MonadThrow m =&gt; String -&gt; m Request
</span><span class="hs-identifier hs-var">parseUrl</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe Request) -&gt; String -&gt; Maybe Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; String
</span><a href="Web.Authenticate.OAuth.html#oauthAccessTokenUri"><span class="hs-identifier hs-var hs-var">oauthAccessTokenUri</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073356"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><span class="hs-identifier hs-var">method</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-487"></span><span>      </span><span id="local-6989586621679073355"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073355"><span class="hs-identifier hs-var">rsp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Response ByteString) -&gt; m (Response ByteString)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Response ByteString) -&gt; m (Response ByteString))
-&gt; IO (Response ByteString) -&gt; m (Response ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; Manager -&gt; IO (Response ByteString))
-&gt; Manager -&gt; Request -&gt; IO (Response ByteString)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; IO (Response ByteString)
</span><span class="hs-identifier hs-var">httpLbs</span></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621679073354"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-488"></span><span>                    </span><span class="annot"><span class="annottext">(Request -&gt; IO (Response ByteString))
-&gt; IO Request -&gt; IO (Response ByteString)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">OAuth
-&gt; Credential
-&gt; Bool
-&gt; (ByteString -&gt; Credential -&gt; Request -&gt; Request)
-&gt; Request
-&gt; IO Request
forall (m :: * -&gt; *).
MonadIO m =&gt;
OAuth
-&gt; Credential
-&gt; Bool
-&gt; (ByteString -&gt; Credential -&gt; Request -&gt; Request)
-&gt; Request
-&gt; m Request
</span><a href="Web.Authenticate.OAuth.html#signOAuth%27"><span class="hs-identifier hs-var">signOAuth'</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073356"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; OAuthVersion
</span><a href="Web.Authenticate.OAuth.html#oauthVersion"><span class="hs-identifier hs-var hs-var">oauthVersion</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073356"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">OAuthVersion -&gt; OAuthVersion -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OAuthVersion
</span><a href="Web.Authenticate.OAuth.html#OAuth10"><span class="hs-identifier hs-var">OAuth10</span></a></span><span>
</span><span id="line-489"></span><span>                                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_verifier&quot;</span></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073353"><span class="hs-identifier hs-var">cr</span></a></span><span>
</span><span id="line-490"></span><span>                                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073353"><span class="hs-identifier hs-var">cr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="#local-6989586621679073352"><span class="hs-identifier hs-var">add_auth</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073358"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-491"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; Status
forall body. Response body -&gt; Status
</span><span class="hs-identifier hs-var hs-var">responseStatus</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073355"><span class="hs-identifier hs-var">rsp</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">status200</span></span><span>
</span><span id="line-492"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-493"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073351"><span class="annot"><span class="annottext">dic :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679073351"><span class="hs-identifier hs-var hs-var">dic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)]
</span><span class="hs-identifier hs-var">parseSimpleQuery</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [(ByteString, ByteString)])
-&gt; (Response ByteString -&gt; ByteString)
-&gt; Response ByteString
-&gt; [(ByteString, ByteString)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#toStrict"><span class="hs-identifier hs-var">toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Response ByteString -&gt; ByteString)
-&gt; Response ByteString
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; ByteString
forall body. Response body -&gt; body
</span><span class="hs-identifier hs-var hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">(Response ByteString -&gt; [(ByteString, ByteString)])
-&gt; Response ByteString -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073355"><span class="hs-identifier hs-var">rsp</span></a></span><span>
</span><span id="line-494"></span><span>          </span><span class="annot"><span class="annottext">Either (Response ByteString) Credential
-&gt; m (Either (Response ByteString) Credential)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (Response ByteString) Credential
 -&gt; m (Either (Response ByteString) Credential))
-&gt; Either (Response ByteString) Credential
-&gt; m (Either (Response ByteString) Credential)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Credential -&gt; Either (Response ByteString) Credential
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; Either (Response ByteString) Credential)
-&gt; Credential -&gt; Either (Response ByteString) Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-var">Credential</span></a></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073351"><span class="hs-identifier hs-var">dic</span></a></span><span>
</span><span id="line-495"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-496"></span><span>          </span><span class="annot"><span class="annottext">Either (Response ByteString) Credential
-&gt; m (Either (Response ByteString) Credential)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (Response ByteString) Credential
 -&gt; m (Either (Response ByteString) Credential))
-&gt; Either (Response ByteString) Credential
-&gt; m (Either (Response ByteString) Credential)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString -&gt; Either (Response ByteString) Credential
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621679073355"><span class="hs-identifier hs-var">rsp</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-498"></span><span>      </span><span id="local-6989586621679073352"><span class="annot"><span class="annottext">add_auth :: ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="#local-6989586621679073352"><span class="hs-identifier hs-var hs-var">add_auth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest
-&gt; ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#accessTokenAddAuth"><span class="hs-identifier hs-var hs-var">accessTokenAddAuth</span></a></span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest
</span><a href="#local-6989586621679073359"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-499"></span><span>      </span><span id="local-6989586621679073357"><span class="annot"><span class="annottext">hook :: Request -&gt; Request
</span><a href="#local-6989586621679073357"><span class="hs-identifier hs-var hs-var">hook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#accessTokenRequestHook"><span class="hs-identifier hs-var hs-var">accessTokenRequestHook</span></a></span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest
</span><a href="#local-6989586621679073359"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-500"></span><span>      </span><span id="local-6989586621679073356"><span class="annot"><span class="annottext">oa :: OAuth
</span><a href="#local-6989586621679073356"><span class="hs-identifier hs-var hs-var">oa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest -&gt; OAuth
</span><a href="Web.Authenticate.OAuth.html#accessTokenOAuth"><span class="hs-identifier hs-var hs-var">accessTokenOAuth</span></a></span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest
</span><a href="#local-6989586621679073359"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-501"></span><span>      </span><span id="local-6989586621679073353"><span class="annot"><span class="annottext">cr :: Credential
</span><a href="#local-6989586621679073353"><span class="hs-identifier hs-var hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#accessTokenTemporaryCredential"><span class="hs-identifier hs-var hs-var">accessTokenTemporaryCredential</span></a></span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest
</span><a href="#local-6989586621679073359"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-502"></span><span>      </span><span id="local-6989586621679073354"><span class="annot"><span class="annottext">manager :: Manager
</span><a href="#local-6989586621679073354"><span class="hs-identifier hs-var hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest -&gt; Manager
</span><a href="Web.Authenticate.OAuth.html#accessTokenManager"><span class="hs-identifier hs-var hs-var">accessTokenManager</span></a></span><span> </span><span class="annot"><span class="annottext">AccessTokenRequest
</span><a href="#local-6989586621679073359"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span id="getTokenCredential"><span class="annot"><span class="annottext">getTokenCredential :: OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getTokenCredential"><span class="hs-identifier hs-var hs-var">getTokenCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
forall (m :: * -&gt; *).
MonadIO m =&gt;
OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getAccessToken"><span class="hs-identifier hs-var">getAccessToken</span></a></span><span>
</span><span id="line-505"></span><span id="getTokenCredentialProxy"><span class="annot"><span class="annottext">getTokenCredentialProxy :: Maybe Proxy -&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getTokenCredentialProxy"><span class="hs-identifier hs-var hs-var">getTokenCredentialProxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Proxy -&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
forall (m :: * -&gt; *).
MonadIO m =&gt;
Maybe Proxy -&gt; OAuth -&gt; Credential -&gt; Manager -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#getAccessTokenProxy"><span class="hs-identifier hs-var">getAccessTokenProxy</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#baseTime"><span class="hs-identifier hs-type">baseTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-509"></span><span id="baseTime"><span class="annot"><span class="annottext">baseTime :: UTCTime
</span><a href="Web.Authenticate.OAuth.html#baseTime"><span class="hs-identifier hs-var hs-var">baseTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Day -&gt; DiffTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">UTCTime</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679073348"><span class="hs-identifier hs-var">day</span></a></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">0</span></span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-511"></span><span>    </span><span id="local-6989586621679073348"><span class="annot"><span class="annottext">day :: Day
</span><a href="#local-6989586621679073348"><span class="hs-identifier hs-var hs-var">day</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Day
</span><span class="hs-identifier hs-var">ModifiedJulianDay</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">40587</span></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#showSigMtd"><span class="hs-identifier hs-type">showSigMtd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#SignMethod"><span class="hs-identifier hs-type">SignMethod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-514"></span><span id="showSigMtd"><span class="annot"><span class="annottext">showSigMtd :: SignMethod -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#showSigMtd"><span class="hs-identifier hs-var hs-var">showSigMtd</span></a></span></span><span> </span><span class="annot"><span class="annottext">SignMethod
</span><a href="Web.Authenticate.OAuth.html#PLAINTEXT"><span class="hs-identifier hs-var">PLAINTEXT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;PLAINTEXT&quot;</span></span><span>
</span><span id="line-515"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#showSigMtd"><span class="hs-identifier hs-var">showSigMtd</span></a></span><span> </span><span class="annot"><span class="annottext">SignMethod
</span><a href="Web.Authenticate.OAuth.html#HMACSHA1"><span class="hs-identifier hs-var">HMACSHA1</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;HMAC-SHA1&quot;</span></span><span>
</span><span id="line-516"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#showSigMtd"><span class="hs-identifier hs-var">showSigMtd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Authenticate.OAuth.html#RSASHA1"><span class="hs-identifier hs-type">RSASHA1</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;RSA-SHA1&quot;</span></span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span id="local-6989586621679073345"><span class="annot"><a href="Web.Authenticate.OAuth.html#addNonce"><span class="hs-identifier hs-type">addNonce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073345"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073345"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span></span><span>
</span><span id="line-519"></span><span id="addNonce"><span class="annot"><span class="annottext">addNonce :: Credential -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#addNonce"><span class="hs-identifier hs-var hs-var">addNonce</span></a></span></span><span> </span><span id="local-6989586621679073344"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073344"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-520"></span><span>  </span><span id="local-6989586621679073343"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679073343"><span class="hs-identifier hs-var">nonce</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; m String
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO String -&gt; m String) -&gt; IO String -&gt; m String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO Char -&gt; IO String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char, Char) -&gt; IO Char
forall a. Random a =&gt; (a, a) -&gt; IO a
</span><span class="hs-identifier hs-var">randomRIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- FIXME very inefficient</span><span>
</span><span id="line-521"></span><span>  </span><span class="annot"><span class="annottext">Credential -&gt; m Credential
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; m Credential) -&gt; Credential -&gt; m Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_nonce&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679073343"><span class="hs-identifier hs-var">nonce</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073344"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span id="local-6989586621679074018"><span class="annot"><a href="Web.Authenticate.OAuth.html#addTimeStamp"><span class="hs-identifier hs-type">addTimeStamp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679074018"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074018"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span></span><span>
</span><span id="line-524"></span><span id="addTimeStamp"><span class="annot"><span class="annottext">addTimeStamp :: Credential -&gt; m Credential
</span><a href="Web.Authenticate.OAuth.html#addTimeStamp"><span class="hs-identifier hs-var hs-var">addTimeStamp</span></a></span></span><span> </span><span id="local-6989586621679073339"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073339"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-525"></span><span>  </span><span id="local-6989586621679073338"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679073338"><span class="hs-identifier hs-var">stamp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">(NominalDiffTime -&gt; Integer)
-&gt; (UTCTime -&gt; NominalDiffTime) -&gt; UTCTime -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><span class="hs-operator hs-var">`diffUTCTime`</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="Web.Authenticate.OAuth.html#baseTime"><span class="hs-identifier hs-var">baseTime</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; Integer) -&gt; m UTCTime -&gt; m Integer
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-operator hs-var">`liftM`</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; m UTCTime
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-526"></span><span>  </span><span class="annot"><span class="annottext">Credential -&gt; m Credential
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; m Credential) -&gt; Credential -&gt; m Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_timestamp&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679073338"><span class="hs-identifier hs-var">stamp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073339"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#injectOAuthToCred"><span class="hs-identifier hs-type">injectOAuthToCred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#OAuth"><span class="hs-identifier hs-type">OAuth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-529"></span><span id="injectOAuthToCred"><span class="annot"><span class="annottext">injectOAuthToCred :: OAuth -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#injectOAuthToCred"><span class="hs-identifier hs-var hs-var">injectOAuthToCred</span></a></span></span><span> </span><span id="local-6989586621679073333"><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073333"><span class="hs-identifier hs-var">oa</span></a></span></span><span> </span><span id="local-6989586621679073332"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073332"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Credential -&gt; Credential
</span><a href="Web.Authenticate.OAuth.html#inserts"><span class="hs-identifier hs-var">inserts</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_signature_method&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SignMethod -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#showSigMtd"><span class="hs-identifier hs-var">showSigMtd</span></a></span><span> </span><span class="annot"><span class="annottext">(SignMethod -&gt; ByteString) -&gt; SignMethod -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; SignMethod
</span><a href="Web.Authenticate.OAuth.html#oauthSignatureMethod"><span class="hs-identifier hs-var hs-var">oauthSignatureMethod</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073333"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_consumer_key&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OAuth -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#oauthConsumerKey"><span class="hs-identifier hs-var hs-var">oauthConsumerKey</span></a></span><span> </span><span class="annot"><span class="annottext">OAuth
</span><a href="#local-6989586621679073333"><span class="hs-identifier hs-var">oa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_version&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;1.0&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>            </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073332"><span class="hs-identifier hs-var">cred</span></a></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-comment">-- | Place the authentication information in a URL encoded body instead of the Authorization header.</span><span>
</span><span id="line-537"></span><span class="hs-comment">--</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- Note that the first parameter is used for realm in addAuthHeader, and this</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- function needs the same type. The parameter, however, is unused.</span><span>
</span><span id="line-540"></span><span class="hs-comment">--</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- Since 1.5.1</span><span>
</span><span id="line-542"></span><span id="local-6989586621679073331"><span class="annot"><a href="Web.Authenticate.OAuth.html#addAuthBody"><span class="hs-identifier hs-type">addAuthBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679073331"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span></span><span>
</span><span id="line-543"></span><span id="addAuthBody"><span class="annot"><span class="annottext">addAuthBody :: a -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addAuthBody"><span class="hs-identifier hs-var hs-var">addAuthBody</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span id="local-6989586621679073330"><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073330"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679073329"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073329"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Request -&gt; Request
</span><span class="hs-identifier hs-var">urlEncodedBody</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#filterCreds"><span class="hs-identifier hs-var">filterCreds</span></a></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073330"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073329"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#addAuthHeader"><span class="hs-identifier hs-type">addAuthHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span>
</span><span id="line-546"></span><span id="addAuthHeader"><span class="annot"><span class="annottext">addAuthHeader :: ByteString -&gt; Credential -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addAuthHeader"><span class="hs-identifier hs-var hs-var">addAuthHeader</span></a></span></span><span> </span><span id="local-6989586621679073326"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073326"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span id="local-6989586621679073325"><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073325"><span class="hs-identifier hs-var">cred</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679073324"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073324"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-547"></span><span>  </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073324"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">requestHeaders :: [Header]
</span><span class="hs-identifier hs-var">requestHeaders</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HeaderName -&gt; ByteString -&gt; [Header] -&gt; [Header]
forall a b. Eq a =&gt; a -&gt; b -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Authenticate.OAuth.html#insertMap"><span class="hs-identifier hs-var">insertMap</span></a></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Authorization&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#renderAuthHeader"><span class="hs-identifier hs-var">renderAuthHeader</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073326"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073325"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Header] -&gt; [Header]) -&gt; [Header] -&gt; [Header]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var hs-var">requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073324"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#renderAuthHeader"><span class="hs-identifier hs-type">renderAuthHeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-550"></span><span id="renderAuthHeader"><span class="annot"><span class="annottext">renderAuthHeader :: ByteString -&gt; [(ByteString, ByteString)] -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#renderAuthHeader"><span class="hs-identifier hs-var hs-var">renderAuthHeader</span></a></span></span><span> </span><span id="local-6989586621679073322"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073322"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073322"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-operator hs-var">`BS.append`</span></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>                        </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; ([(ByteString, ByteString)] -&gt; ByteString)
-&gt; [(ByteString, ByteString)]
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.intercalate</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;,&quot;</span></span><span>
</span><span id="line-552"></span><span>                        </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; ([(ByteString, ByteString)] -&gt; [ByteString])
-&gt; [(ByteString, ByteString)]
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; ByteString)
-&gt; [(ByteString, ByteString)] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679073321"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073321"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073320"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073320"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073321"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;=\&quot;&quot;</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073320"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>                        </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; [ByteString])
-&gt; ([(ByteString, ByteString)] -&gt; [(ByteString, ByteString)])
-&gt; [(ByteString, ByteString)]
-&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#filterCreds"><span class="hs-identifier hs-var">filterCreds</span></a></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#filterCreds"><span class="hs-identifier hs-type">filterCreds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- as per http://oauth.net/core/1.0a  -- 9.1.1.  Normalize Request Parameters</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- everything except &quot;realm&quot; parameter should be encoded</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- 6.1.1, 6.1.2, 6.2.1,  6.3.2 and 7 allow encoding anything in the authorization parameters</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- 6.2.3 is only limited to oauth_token and oauth_verifier (although query params are allowed)</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- 6.3.1 does not allow specifing other params, so no need to filter them (it is an error anyway)</span><span>
</span><span id="line-561"></span><span id="filterCreds"><span class="annot"><span class="annottext">filterCreds :: [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#filterCreds"><span class="hs-identifier hs-var hs-var">filterCreds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; Bool)
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ((ByteString, ByteString) -&gt; Bool)
-&gt; (ByteString, ByteString)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [ByteString] -&gt; Bool)
-&gt; [ByteString] -&gt; ByteString -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;realm&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_token_secret&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool)
-&gt; ((ByteString, ByteString) -&gt; ByteString)
-&gt; (ByteString, ByteString)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span class="hs-comment">--filterCreds = filter ((`elem` [ &quot;oauth_consumer_key&quot;</span><span>
</span><span id="line-563"></span><span class="hs-comment">--                              , &quot;oauth_token&quot;</span><span>
</span><span id="line-564"></span><span class="hs-comment">--                              , &quot;oauth_signature&quot;</span><span>
</span><span id="line-565"></span><span class="hs-comment">--                              , &quot;oauth_signature_method&quot;</span><span>
</span><span id="line-566"></span><span class="hs-comment">--                              , &quot;oauth_timestamp&quot;</span><span>
</span><span id="line-567"></span><span class="hs-comment">--                              , &quot;oauth_nonce&quot;</span><span>
</span><span id="line-568"></span><span class="hs-comment">--                              , &quot;oauth_verifier&quot;</span><span>
</span><span id="line-569"></span><span class="hs-comment">--                              , &quot;oauth_version&quot;</span><span>
</span><span id="line-570"></span><span class="hs-comment">--                              , &quot;oauth_callback&quot;</span><span>
</span><span id="line-571"></span><span class="hs-comment">--                              ] ) . fst )</span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span id="local-6989586621679074001"><span class="annot"><a href="Web.Authenticate.OAuth.html#getBaseString"><span class="hs-identifier hs-type">getBaseString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679074001"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074001"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BSL.ByteString</span></span></span><span>
</span><span id="line-575"></span><span id="getBaseString"><span class="annot"><span class="annottext">getBaseString :: Credential -&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#getBaseString"><span class="hs-identifier hs-var hs-var">getBaseString</span></a></span></span><span> </span><span id="local-6989586621679073318"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073318"><span class="hs-identifier hs-var">tok</span></a></span></span><span> </span><span id="local-6989586621679073317"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073316"><span class="annot"><span class="annottext">bsMtd :: ByteString
</span><a href="#local-6989586621679073316"><span class="hs-identifier hs-var hs-var">bsMtd</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toUpper</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">method</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-577"></span><span>      </span><span id="local-6989586621679073313"><span class="annot"><span class="annottext">isHttps :: Bool
</span><a href="#local-6989586621679073313"><span class="hs-identifier hs-var hs-var">isHttps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; Bool
</span><span class="hs-identifier hs-var hs-var">secure</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-578"></span><span>      </span><span id="local-6989586621679073311"><span class="annot"><span class="annottext">scheme :: ByteString
</span><a href="#local-6989586621679073311"><span class="hs-identifier hs-var hs-var">scheme</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073313"><span class="hs-identifier hs-var">isHttps</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;https&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;http&quot;</span></span><span>
</span><span id="line-579"></span><span>      </span><span id="local-6989586621679073310"><span class="annot"><span class="annottext">bsPort :: ByteString
</span><a href="#local-6989586621679073310"><span class="hs-identifier hs-var hs-var">bsPort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073313"><span class="hs-identifier hs-var">isHttps</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Int
</span><span class="hs-identifier hs-var hs-var">port</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">443</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073313"><span class="hs-identifier hs-var">isHttps</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Int
</span><span class="hs-identifier hs-var hs-var">port</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">80</span></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; ByteString
</span><span class="hs-operator hs-var">`BS.cons`</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Int
</span><span class="hs-identifier hs-var hs-var">port</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-581"></span><span>      </span><span id="local-6989586621679073306"><span class="annot"><span class="annottext">bsURI :: ByteString
</span><a href="#local-6989586621679073306"><span class="hs-identifier hs-var hs-var">bsURI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073311"><span class="hs-identifier hs-var">scheme</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;://&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">host</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073310"><span class="hs-identifier hs-var">bsPort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">path</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-582"></span><span>      </span><span id="local-6989586621679073303"><span class="annot"><span class="annottext">bsQuery :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679073303"><span class="hs-identifier hs-var hs-var">bsQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)]
</span><span class="hs-identifier hs-var">parseSimpleQuery</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [(ByteString, ByteString)])
-&gt; ByteString -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">queryString</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-583"></span><span>  </span><span id="local-6989586621679073301"><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073301"><span class="hs-identifier hs-var">bsBodyQ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Header] -&gt; Bool
</span><a href="Web.Authenticate.OAuth.html#isBodyFormEncoded"><span class="hs-identifier hs-var">isBodyFormEncoded</span></a></span><span> </span><span class="annot"><span class="annottext">([Header] -&gt; Bool) -&gt; [Header] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; [Header]
</span><span class="hs-identifier hs-var hs-var">requestHeaders</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-584"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [(ByteString, ByteString)])
-&gt; m ByteString -&gt; m [(ByteString, ByteString)]
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)]
</span><span class="hs-identifier hs-var">parseSimpleQuery</span></span><span> </span><span class="annot"><span class="annottext">(m ByteString -&gt; m [(ByteString, ByteString)])
-&gt; m ByteString -&gt; m [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; m ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#loadBodyBS"><span class="hs-identifier hs-var">loadBodyBS</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073317"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-585"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; m [(ByteString, ByteString)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073300"><span class="annot"><span class="annottext">bsAuthParams :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679073300"><span class="hs-identifier hs-var hs-var">bsAuthParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#filterCreds"><span class="hs-identifier hs-var">filterCreds</span></a></span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; [(ByteString, ByteString)])
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Credential -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#unCredential"><span class="hs-identifier hs-var hs-var">unCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679073318"><span class="hs-identifier hs-var">tok</span></a></span><span>
</span><span id="line-587"></span><span>      </span><span id="local-6989586621679073299"><span class="annot"><span class="annottext">allParams :: [(ByteString, ByteString)]
</span><a href="#local-6989586621679073299"><span class="hs-identifier hs-var hs-var">allParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073303"><span class="hs-identifier hs-var">bsQuery</span></a></span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073301"><span class="hs-identifier hs-var">bsBodyQ</span></a></span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073300"><span class="hs-identifier hs-var">bsAuthParams</span></a></span><span>
</span><span id="line-588"></span><span>      </span><span id="local-6989586621679073298"><span class="annot"><span class="annottext">bsParams :: ByteString
</span><a href="#local-6989586621679073298"><span class="hs-identifier hs-var hs-var">bsParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.intercalate</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString) -&gt; [ByteString] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; ByteString)
-&gt; [(ByteString, ByteString)] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679073297"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073297"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073296"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073296"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.concat</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073297"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;=&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073296"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; [ByteString])
-&gt; [(ByteString, ByteString)] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span>
</span><span id="line-589"></span><span>                   </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; [(ByteString, ByteString)])
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; (ByteString, ByteString))
-&gt; [(ByteString, ByteString)] -&gt; [(ByteString, ByteString)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679073295"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073295"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073294"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073294"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073295"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073294"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)]
</span><a href="#local-6989586621679073299"><span class="hs-identifier hs-var">allParams</span></a></span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-comment">-- parameter encoding method in OAuth is slight different from ordinary one.</span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-comment">-- So this is OK.</span><span>
</span><span id="line-592"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; m ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; m ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m ByteString) -&gt; ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.intercalate</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&amp;&quot;</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString) -&gt; [ByteString] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; [ByteString] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var">paramEncode</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073316"><span class="hs-identifier hs-var">bsMtd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073306"><span class="hs-identifier hs-var">bsURI</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073298"><span class="hs-identifier hs-var">bsParams</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- Utilities</span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span class="hs-comment">-- | Encode a string using the percent encoding method for OAuth.</span><span>
</span><span id="line-599"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-type">paramEncode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-600"></span><span id="paramEncode"><span class="annot"><span class="annottext">paramEncode :: ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#paramEncode"><span class="hs-identifier hs-var hs-var">paramEncode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; ByteString) -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.concatMap</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString
</span><a href="#local-6989586621679073292"><span class="hs-identifier hs-var">escape</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-602"></span><span>    </span><span id="local-6989586621679073292"><span class="annot"><span class="annottext">escape :: Char -&gt; ByteString
</span><a href="#local-6989586621679073292"><span class="hs-identifier hs-var hs-var">escape</span></a></span></span><span> </span><span id="local-6989586621679073291"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679073291"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAscii</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679073291"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679073291"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679073291"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679073291"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-._~&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679073291"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-603"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679073286"><span class="annot"><span class="annottext">num :: String
</span><a href="#local-6989586621679073286"><span class="hs-identifier hs-var hs-var">num</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toUpper</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. (Integral a, Show a) =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showHex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679073291"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-604"></span><span>                               </span><span id="local-6989586621679073283"><span class="annot"><span class="annottext">oct :: String
</span><a href="#local-6989586621679073283"><span class="hs-identifier hs-var hs-var">oct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'%'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679073286"><span class="hs-identifier hs-var">num</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679073286"><span class="hs-identifier hs-var">num</span></a></span><span>
</span><span id="line-605"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679073283"><span class="hs-identifier hs-var">oct</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#addScope"><span class="hs-identifier hs-type">addScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span>
</span><span id="line-609"></span><span id="addScope"><span class="annot"><span class="annottext">addScope :: ByteString -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addScope"><span class="hs-identifier hs-var hs-var">addScope</span></a></span></span><span> </span><span id="local-6989586621679073280"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073280"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span id="local-6989586621679073279"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073279"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073280"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073279"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-610"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, ByteString)] -&gt; Request -&gt; Request
</span><span class="hs-identifier hs-var">urlEncodedBody</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;scope&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073280"><span class="hs-identifier hs-var">scope</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073279"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#token"><span class="hs-identifier hs-type">token</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#tokenSecret"><span class="hs-identifier hs-type">tokenSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Web.Authenticate.OAuth.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-614"></span><span id="token"><span class="annot"><span class="annottext">token :: Credential -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#token"><span class="hs-identifier hs-var hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString -&gt; ByteString
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; ByteString)
-&gt; (Credential -&gt; Maybe ByteString) -&gt; Credential -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_token&quot;</span></span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; Maybe ByteString)
-&gt; (Credential -&gt; [(ByteString, ByteString)])
-&gt; Credential
-&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#unCredential"><span class="hs-identifier hs-var hs-var">unCredential</span></a></span><span>
</span><span id="line-615"></span><span id="tokenSecret"><span class="annot"><span class="annottext">tokenSecret :: Credential -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#tokenSecret"><span class="hs-identifier hs-var hs-var">tokenSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString -&gt; ByteString
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; ByteString)
-&gt; (Credential -&gt; Maybe ByteString) -&gt; Credential -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [(ByteString, ByteString)] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;oauth_token_secret&quot;</span></span><span> </span><span class="annot"><span class="annottext">([(ByteString, ByteString)] -&gt; Maybe ByteString)
-&gt; (Credential -&gt; [(ByteString, ByteString)])
-&gt; Credential
-&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Credential -&gt; [(ByteString, ByteString)]
</span><a href="Web.Authenticate.OAuth.html#unCredential"><span class="hs-identifier hs-var hs-var">unCredential</span></a></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#addMaybeProxy"><span class="hs-identifier hs-type">addMaybeProxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span>
</span><span id="line-619"></span><span id="addMaybeProxy"><span class="annot"><span class="annottext">addMaybeProxy :: Maybe Proxy -&gt; Request -&gt; Request
</span><a href="Web.Authenticate.OAuth.html#addMaybeProxy"><span class="hs-identifier hs-var hs-var">addMaybeProxy</span></a></span></span><span> </span><span id="local-6989586621679073275"><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679073275"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679073274"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073274"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621679073274"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">proxy :: Maybe Proxy
</span><span class="hs-identifier hs-var">proxy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Proxy
</span><a href="#local-6989586621679073275"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span id="local-6989586621679074037"><span id="local-6989586621679074038"><span class="annot"><a href="Web.Authenticate.OAuth.html#insertMap"><span class="hs-identifier hs-type">insertMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074037"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074038"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679074037"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074038"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679074037"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-623"></span><span id="insertMap"><span class="annot"><span class="annottext">insertMap :: a -&gt; b -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Authenticate.OAuth.html#insertMap"><span class="hs-identifier hs-var hs-var">insertMap</span></a></span></span><span> </span><span id="local-6989586621679073272"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679073272"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679073271"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679073271"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679073272"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679073271"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(a, b)] -&gt; [(a, b)])
-&gt; ([(a, b)] -&gt; [(a, b)]) -&gt; [(a, b)] -&gt; [(a, b)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; Bool) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679073272"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; ((a, b) -&gt; a) -&gt; (a, b) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(a, b) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span id="local-6989586621679074023"><span id="local-6989586621679074024"><span class="annot"><a href="Web.Authenticate.OAuth.html#deleteMap"><span class="hs-identifier hs-type">deleteMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679074024"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074024"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074024"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679074023"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074024"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679074023"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-626"></span><span id="deleteMap"><span class="annot"><span class="annottext">deleteMap :: a -&gt; [(a, b)] -&gt; [(a, b)]
</span><a href="Web.Authenticate.OAuth.html#deleteMap"><span class="hs-identifier hs-var hs-var">deleteMap</span></a></span></span><span> </span><span id="local-6989586621679073270"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679073270"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; Bool) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679073270"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; ((a, b) -&gt; a) -&gt; (a, b) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(a, b) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#toStrict"><span class="hs-identifier hs-type">toStrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BSL.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span>
</span><span id="line-630"></span><span id="toStrict"><span class="annot"><span class="annottext">toStrict :: ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#toStrict"><span class="hs-identifier hs-var hs-var">toStrict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.concat</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; (ByteString -&gt; [ByteString]) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><span class="hs-identifier hs-var">BSL.toChunks</span></span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#fromStrict"><span class="hs-identifier hs-type">fromStrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BSL.ByteString</span></span><span>
</span><span id="line-633"></span><span id="fromStrict"><span class="annot"><span class="annottext">fromStrict :: ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#fromStrict"><span class="hs-identifier hs-var hs-var">fromStrict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BSL.fromChunks</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; (ByteString -&gt; [ByteString]) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span id="local-6989586621679074003"><span class="annot"><a href="Web.Authenticate.OAuth.html#loadBodyBS"><span class="hs-identifier hs-type">loadBodyBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679074003"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074003"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span></span><span>
</span><span id="line-637"></span><span id="loadBodyBS"><span class="annot"><span class="annottext">loadBodyBS :: Request -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#loadBodyBS"><span class="hs-identifier hs-var hs-var">loadBodyBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; m ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; RequestBody -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#toBS"><span class="hs-identifier hs-var">toBS</span></a></span><span> </span><span class="annot"><span class="annottext">(RequestBody -&gt; m ByteString)
-&gt; (Request -&gt; RequestBody) -&gt; Request -&gt; m ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; RequestBody
</span><span class="hs-identifier hs-var hs-var">requestBody</span></span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span id="local-6989586621679073901"><span class="annot"><a href="Web.Authenticate.OAuth.html#toBS"><span class="hs-identifier hs-type">toBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073901"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RequestBody</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073901"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span></span><span>
</span><span id="line-640"></span><span id="toBS"><span class="annot"><span class="annottext">toBS :: RequestBody -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#toBS"><span class="hs-identifier hs-var hs-var">toBS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RequestBodyLBS</span></span><span> </span><span id="local-6989586621679073265"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073265"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m ByteString) -&gt; ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Web.Authenticate.OAuth.html#toStrict"><span class="hs-identifier hs-var">toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073265"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-641"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#toBS"><span class="hs-identifier hs-var">toBS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RequestBodyBS</span></span><span> </span><span id="local-6989586621679073264"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073264"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073264"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-642"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#toBS"><span class="hs-identifier hs-var">toBS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RequestBodyBuilder</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679073262"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679073262"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m ByteString
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m ByteString) -&gt; ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><span class="hs-identifier hs-var">toByteString</span></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679073262"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-643"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#toBS"><span class="hs-identifier hs-var">toBS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RequestBodyStream</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679073260"><span class="annot"><span class="annottext">GivesPopper ()
</span><a href="#local-6989586621679073260"><span class="hs-identifier hs-var">givesPopper</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GivesPopper () -&gt; m ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; GivesPopper () -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#toBS%27"><span class="hs-identifier hs-var">toBS'</span></a></span><span> </span><span class="annot"><span class="annottext">GivesPopper ()
</span><a href="#local-6989586621679073260"><span class="hs-identifier hs-var">givesPopper</span></a></span><span>
</span><span id="line-644"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#toBS"><span class="hs-identifier hs-var">toBS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RequestBodyStreamChunked</span></span><span> </span><span id="local-6989586621679073257"><span class="annot"><span class="annottext">GivesPopper ()
</span><a href="#local-6989586621679073257"><span class="hs-identifier hs-var">givesPopper</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GivesPopper () -&gt; m ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; GivesPopper () -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#toBS%27"><span class="hs-identifier hs-var">toBS'</span></a></span><span> </span><span class="annot"><span class="annottext">GivesPopper ()
</span><a href="#local-6989586621679073257"><span class="hs-identifier hs-var">givesPopper</span></a></span><span class="hs-cpp">
#if MIN_VERSION_http_client(0, 4, 28)
</span><span class="annot"><a href="Web.Authenticate.OAuth.html#toBS"><span class="hs-identifier hs-var">toBS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RequestBodyIO</span></span><span> </span><span id="local-6989586621679073255"><span class="annot"><span class="annottext">IO RequestBody
</span><a href="#local-6989586621679073255"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO RequestBody -&gt; m RequestBody
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO RequestBody
</span><a href="#local-6989586621679073255"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">m RequestBody -&gt; (RequestBody -&gt; m ByteString) -&gt; m ByteString
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">RequestBody -&gt; m ByteString
forall (m :: * -&gt; *). MonadIO m =&gt; RequestBody -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#toBS"><span class="hs-identifier hs-var">toBS</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-650"></span><span id="local-6989586621679073897"><span class="annot"><a href="Web.Authenticate.OAuth.html#toBS%27"><span class="hs-identifier hs-type">toBS'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679073897"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GivesPopper</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073897"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">BS.ByteString</span></span></span><span>
</span><span id="line-651"></span><span id="toBS%27"><span class="annot"><span class="annottext">toBS' :: GivesPopper () -&gt; m ByteString
</span><a href="Web.Authenticate.OAuth.html#toBS%27"><span class="hs-identifier hs-var hs-var">toBS'</span></a></span></span><span> </span><span id="local-6989586621679073254"><span class="annot"><span class="annottext">GivesPopper ()
</span><a href="#local-6989586621679073254"><span class="hs-identifier hs-var">gp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; m ByteString
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; m ByteString) -&gt; IO ByteString -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-652"></span><span>    </span><span id="local-6989586621679073253"><span class="annot"><span class="annottext">IORef ByteString
</span><a href="#local-6989586621679073253"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO (IORef ByteString)
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">I.newIORef</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier hs-var">BS.empty</span></span><span>
</span><span id="line-653"></span><span>    </span><span class="annot"><span class="annottext">GivesPopper ()
</span><a href="#local-6989586621679073254"><span class="hs-identifier hs-var">gp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IORef ByteString -&gt; IO ByteString -&gt; IO ()
</span><a href="#local-6989586621679073250"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IORef ByteString
</span><a href="#local-6989586621679073253"><span class="hs-identifier hs-var">ref</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>    </span><span class="annot"><span class="annottext">IORef ByteString -&gt; IO ByteString
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">I.readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef ByteString
</span><a href="#local-6989586621679073253"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-656"></span><span>    </span><span id="local-6989586621679073250"><span class="annot"><span class="annottext">go :: IORef ByteString -&gt; IO ByteString -&gt; IO ()
</span><a href="#local-6989586621679073250"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679073248"><span class="annot"><span class="annottext">IORef ByteString
</span><a href="#local-6989586621679073248"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span id="local-6989586621679073247"><span class="annot"><span class="annottext">IO ByteString
</span><a href="#local-6989586621679073247"><span class="hs-identifier hs-var">popper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-657"></span><span>        </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString]) -&gt; IO ()
</span><a href="#local-6989586621679073246"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-658"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-659"></span><span>        </span><span id="local-6989586621679073246"><span class="annot"><span class="annottext">loop :: ([ByteString] -&gt; [ByteString]) -&gt; IO ()
</span><a href="#local-6989586621679073246"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679073245"><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679073245"><span class="hs-identifier hs-var">front</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-660"></span><span>            </span><span id="local-6989586621679073244"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073244"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString
</span><a href="#local-6989586621679073247"><span class="hs-identifier hs-var">popper</span></a></span><span>
</span><span id="line-661"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">BS.null</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073244"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-662"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IORef ByteString -&gt; ByteString -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">I.writeIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef ByteString
</span><a href="#local-6989586621679073248"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ()) -&gt; ByteString -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var">BS.concat</span></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString) -&gt; [ByteString] -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679073245"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-663"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString]) -&gt; IO ()
</span><a href="#local-6989586621679073246"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
</span><a href="#local-6989586621679073245"><span class="hs-identifier hs-var">front</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [ByteString]) -&gt; [ByteString] -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679073244"><span class="hs-identifier hs-var">bs</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="annot"><a href="Web.Authenticate.OAuth.html#isBodyFormEncoded"><span class="hs-identifier hs-type">isBodyFormEncoded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Header</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-667"></span><span id="isBodyFormEncoded"><span class="annot"><span class="annottext">isBodyFormEncoded :: [Header] -&gt; Bool
</span><a href="Web.Authenticate.OAuth.html#isBodyFormEncoded"><span class="hs-identifier hs-var hs-var">isBodyFormEncoded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (ByteString -&gt; Bool) -&gt; Maybe ByteString -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/x-www-form-urlencoded&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; Bool)
-&gt; ([Header] -&gt; Maybe ByteString) -&gt; [Header] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HeaderName -&gt; [Header] -&gt; Maybe ByteString
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-Type&quot;</span></span><span>
</span><span id="line-668"></span></pre></body></html>